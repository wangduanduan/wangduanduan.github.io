<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>opensips管理命令 | 洞香春</title><meta name=keywords content><meta name=description content="可以使用一下命令查找opensips的相关文件夹
find / -name opensips -type d 一般来说，重要的是opensips.cfg文件，这个文件一般位于/usr/local/etc/opensips/或者/usr/etc/opensips中。主要还是要看安装时选择的默认路径。
其中1.x版本的配置文件一般位于/usr/etc/opensips目录中，2.x版本的配置一般位于/usr/local/etc/opensips目录中。
下面主要讲解几个命令。
配置文件校验 校验opensips.cfg脚本是否合法, 如果有问题，会提示那行代码有问题，但是报错位置好像一直不准确。很多时候可能是忘记写分好了。
opensips -C opensips.cfg 启动关闭与重启 使用opensipsctl命令做数据库操作前，需要先配置opensipsctlrc文件
opensips start|stop|restart opensipsctl start|stop|restart 资源创建 opensipsdbctl create # 创建数据库 opensipsctl domain add abc.cc #创建域名 opensipsctl add 1001@test.cc 12346 # 新增用户 opensipsctl rm 1001@test.cc # 删除用户 opensipsctl passwdd 1001@test.cc 09879 # 修改密码 opensipsctl -h 显示所有可用命令
/usr/local/sbin/opensipsctl $Revision: 4448 $ Existing commands: -- command 'start|stop|restart|trap' trap ............................... trap with gdb OpenSIPS processes restart ............................ restart OpenSIPS start ."><meta name=author content="Eddie Wang"><link rel=canonical href=https://wdd.js.org/opensips/ch3/opensipsctl/><link crossorigin=anonymous href=/assets/css/stylesheet.6d3944e058d85363bbe8a792a9b5f40002bca80be859dc19c466dd8de223973e.css integrity="sha256-bTlE4FjYU2O76KeSqbX0AAK8qAvoWdwZxGbdjeIjlz4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wdd.js.org/cowboy.ico><link rel=icon type=image/png sizes=16x16 href=https://wdd.js.org/cowboy.ico><link rel=icon type=image/png sizes=32x32 href=https://wdd.js.org/cowboy.ico><link rel=apple-touch-icon href=https://wdd.js.org/cowboy.ico><link rel=mask-icon href=https://wdd.js.org/cowboy.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="opensips管理命令"><meta property="og:description" content="可以使用一下命令查找opensips的相关文件夹
find / -name opensips -type d 一般来说，重要的是opensips.cfg文件，这个文件一般位于/usr/local/etc/opensips/或者/usr/etc/opensips中。主要还是要看安装时选择的默认路径。
其中1.x版本的配置文件一般位于/usr/etc/opensips目录中，2.x版本的配置一般位于/usr/local/etc/opensips目录中。
下面主要讲解几个命令。
配置文件校验 校验opensips.cfg脚本是否合法, 如果有问题，会提示那行代码有问题，但是报错位置好像一直不准确。很多时候可能是忘记写分好了。
opensips -C opensips.cfg 启动关闭与重启 使用opensipsctl命令做数据库操作前，需要先配置opensipsctlrc文件
opensips start|stop|restart opensipsctl start|stop|restart 资源创建 opensipsdbctl create # 创建数据库 opensipsctl domain add abc.cc #创建域名 opensipsctl add 1001@test.cc 12346 # 新增用户 opensipsctl rm 1001@test.cc # 删除用户 opensipsctl passwdd 1001@test.cc 09879 # 修改密码 opensipsctl -h 显示所有可用命令
/usr/local/sbin/opensipsctl $Revision: 4448 $ Existing commands: -- command 'start|stop|restart|trap' trap ............................... trap with gdb OpenSIPS processes restart ............................ restart OpenSIPS start ."><meta property="og:type" content="article"><meta property="og:url" content="https://wdd.js.org/opensips/ch3/opensipsctl/"><meta property="og:image" content="https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="opensips"><meta property="article:published_time" content="2019-06-13T22:03:19+08:00"><meta property="article:modified_time" content="2019-06-13T22:03:19+08:00"><meta property="og:site_name" content="洞香春"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="opensips管理命令"><meta name=twitter:description content="可以使用一下命令查找opensips的相关文件夹
find / -name opensips -type d 一般来说，重要的是opensips.cfg文件，这个文件一般位于/usr/local/etc/opensips/或者/usr/etc/opensips中。主要还是要看安装时选择的默认路径。
其中1.x版本的配置文件一般位于/usr/etc/opensips目录中，2.x版本的配置一般位于/usr/local/etc/opensips目录中。
下面主要讲解几个命令。
配置文件校验 校验opensips.cfg脚本是否合法, 如果有问题，会提示那行代码有问题，但是报错位置好像一直不准确。很多时候可能是忘记写分好了。
opensips -C opensips.cfg 启动关闭与重启 使用opensipsctl命令做数据库操作前，需要先配置opensipsctlrc文件
opensips start|stop|restart opensipsctl start|stop|restart 资源创建 opensipsdbctl create # 创建数据库 opensipsctl domain add abc.cc #创建域名 opensipsctl add 1001@test.cc 12346 # 新增用户 opensipsctl rm 1001@test.cc # 删除用户 opensipsctl passwdd 1001@test.cc 09879 # 修改密码 opensipsctl -h 显示所有可用命令
/usr/local/sbin/opensipsctl $Revision: 4448 $ Existing commands: -- command 'start|stop|restart|trap' trap ............................... trap with gdb OpenSIPS processes restart ............................ restart OpenSIPS start ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"OpenSIPS2.4.X 中文实战系列","item":"https://wdd.js.org/opensips/"},{"@type":"ListItem","position":3,"name":"opensips管理命令","item":"https://wdd.js.org/opensips/ch3/opensipsctl/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"opensips管理命令","name":"opensips管理命令","description":"可以使用一下命令查找opensips的相关文件夹\nfind / -name opensips -type d 一般来说，重要的是opensips.cfg文件，这个文件一般位于/usr/local/etc/opensips/或者/usr/etc/opensips中。主要还是要看安装时选择的默认路径。\n其中1.x版本的配置文件一般位于/usr/etc/opensips目录中，2.x版本的配置一般位于/usr/local/etc/opensips目录中。\n下面主要讲解几个命令。\n配置文件校验 校验opensips.cfg脚本是否合法, 如果有问题，会提示那行代码有问题，但是报错位置好像一直不准确。很多时候可能是忘记写分好了。\nopensips -C opensips.cfg 启动关闭与重启 使用opensipsctl命令做数据库操作前，需要先配置opensipsctlrc文件\nopensips start|stop|restart opensipsctl start|stop|restart 资源创建 opensipsdbctl create # 创建数据库 opensipsctl domain add abc.cc #创建域名 opensipsctl add 1001@test.cc 12346 # 新增用户 opensipsctl rm 1001@test.cc # 删除用户 opensipsctl passwdd 1001@test.cc 09879 # 修改密码 opensipsctl -h 显示所有可用命令\n/usr/local/sbin/opensipsctl $Revision: 4448 $ Existing commands: -- command \u0026#39;start|stop|restart|trap\u0026#39; trap ............................... trap with gdb OpenSIPS processes restart ............................ restart OpenSIPS start .","keywords":[],"articleBody":"可以使用一下命令查找opensips的相关文件夹\nfind / -name opensips -type d 一般来说，重要的是opensips.cfg文件，这个文件一般位于/usr/local/etc/opensips/或者/usr/etc/opensips中。主要还是要看安装时选择的默认路径。\n其中1.x版本的配置文件一般位于/usr/etc/opensips目录中，2.x版本的配置一般位于/usr/local/etc/opensips目录中。\n下面主要讲解几个命令。\n配置文件校验 校验opensips.cfg脚本是否合法, 如果有问题，会提示那行代码有问题，但是报错位置好像一直不准确。很多时候可能是忘记写分好了。\nopensips -C opensips.cfg 启动关闭与重启 使用opensipsctl命令做数据库操作前，需要先配置opensipsctlrc文件\nopensips start|stop|restart opensipsctl start|stop|restart 资源创建 opensipsdbctl create # 创建数据库 opensipsctl domain add abc.cc #创建域名 opensipsctl add 1001@test.cc 12346 # 新增用户 opensipsctl rm 1001@test.cc # 删除用户 opensipsctl passwdd 1001@test.cc 09879 # 修改密码 opensipsctl -h 显示所有可用命令\n/usr/local/sbin/opensipsctl $Revision: 4448 $ Existing commands: -- command 'start|stop|restart|trap' trap ............................... trap with gdb OpenSIPS processes restart ............................ restart OpenSIPS start .............................. start OpenSIPS stop ............................... stop OpenSIPS -- command 'acl' - manage access control lists (acl) acl show [] .............. show user membership acl grant ....... grant user membership (*) acl revoke [] .... grant user membership(s) (*) -- command 'cr' - manage carrierroute tables cr show ....................................................... show tables cr reload ..................................................... reload tables cr dump ....................................................... show in memory tables cr addrt ..................... add a tree cr rmrt ....................................... rm a tree cr addcarrier ................ ............... .........................add a carrier (prob, strip, rewrite_prefix, rewrite_suffix,................... flags, mask and comment are optional arguments) ............... cr rmcarrier ................ rm a carrier -- command 'rpid' - manage Remote-Party-ID (RPID) rpid add ......... add rpid for a user (*) rpid rm ................. set rpid to NULL for a user (*) rpid show ............... show rpid of a user -- command 'add|passwd|rm' - manage subscribers add .......... add a new subscriber (*) passwd ......... change user's password (*) rm ...................... delete a user (*) -- command 'add|dump|reload|rm|show' - manage address address show ...................... show db content address dump ...................... show cache content address reload .................... reload db table into cache address add [] [] ....................... add a new entry ....................... (from_pattern and tag are optional arguments) address rm ............... remove all entries ....................... for the given grp ip mask port -- command 'dr' - manage dynamic routing * Examples: dr addgw '1' 10 '192.168.2.2' 0 '' 'GW001' 0 'first_gw' * dr addgw '2' 20 '192.168.2.3' 0 '' 'GW002' 0 'second_gw' * dr rmgw 2 * dr addgrp 'alice' 'example.com' 10 'first group' * dr rmgrp 1 * dr addcr 'cr_1' '10' 0 'CARRIER_1' 'first_carrier' * dr rmcr 1 * dr addrule '10,20' '+1' '20040101T083000' 0 0 '1,2' 'NA_RULE' 'NA routing' * dr rmrule 1 dr show ............................ show dr tables dr addgw ................................. add gateway dr rmgw ....................... delete gateway dr addgrp ................................. add gateway group dr rmgrp ...................... delete gateway group dr addcr ........................... add carrier dr rmcr ....................... delete carrier dr addrule ................................. add rule dr rmrule ................. delete rule dr reload .......................... reload dr tables dr gw_status ....................... show gateway status dr carrier_status .................. show carrier status -- command 'dispatcher' - manage dispatcher * Examples: dispatcher addgw 1 sip:1.2.3.1:5050 '' 0 50 'og1' 'Outbound Gateway1' * dispatcher addgw 2 sip:1.2.3.4:5050 '' 0 50 'og2' 'Outbound Gateway2' * dispatcher rmgw 4 dispatcher show ..................... show dispatcher gateways dispatcher reload ................... reload dispatcher gateways dispatcher dump ..................... show in memory dispatcher gateways dispatcher addgw [description] .......................... add gateway dispatcher rmgw ................ delete gateway -- command 'registrant' - manage registrants * Examples: registrant add sip:opensips.org '' sip:user@opensips.org '' user password sip:user@localhost '' 3600 '' registrant show ......................... show registrant table registrant dump ......................... show registrant status registrant add . add a registrant registrant rm ........................... removes the entire registrant table registrant rmaor ................... removes the gived aor id -- command 'db' - database operations db exec ..................... execute SQL query db roexec ................. execute read-only SQL query db run ......................... execute SQL query from $id variable db rorun ....................... execute read-only SQL query from $id variable db show ..................... display table content -- command 'speeddial' - manage speed dials (short numbers) speeddial show ....... show speeddial details speeddial list ............. list speeddial for uri speeddial add [] ... ........................... add a speedial (*) speeddial rm ....... remove a speeddial (*) speeddial help ...................... help message - , must be an AoR (username@domain) - must be an AoR (username@domain) - must be a SIP AoR (sip:username@domain) - a description for speeddial -- command 'avp' - manage AVPs avp list [-T table] [-u ] [-a attribute] [-v value] [-t type] ... list AVPs avp add [-T table] ............ add AVP (*) avp rm [-T table] [-u ] [-a attribute] [-v value] [-t type] ... remove AVP (*) avp help .................................. help message - -T - table name - -u - SIP id or unique id - -a - AVP name - -v - AVP value - -t - AVP name and type (0 (str:str), 1 (str:int), 2 (int:str), 3 (int:int)) - must be an AoR (username@domain) - must be a string but not AoR -- command 'alias_db' - manage database aliases alias_db show .............. show alias details alias_db list ............. list aliases for uri alias_db add ...... add an alias (*) alias_db rm ................ remove an alias (*) alias_db help ...................... help message - must be an AoR (username@domain)\" - must be an AoR (username@domain)\" -- command 'domain' - manage local domains domain reload ....................... reload domains from disk domain show ......................... show current domains in memory domain showdb ....................... show domains in the database domain add ................. add the domain to the database domain rm .................. delete the domain from the database -- command 'cisco_restart' - restart CISCO phone (NOTIFY) cisco_restart ................ restart phone configured for -- command 'online' - dump online users from memory online ............................. display online users -- command 'monitor' - show internal status monitor ............................ show server's internal status -- command 'ping' - ping a SIP URI (OPTIONS) ping ......................... ping with SIP OPTIONS -- command 'ul' - manage user location records ul show []................ show in-RAM online users ul show --brief..................... show in-RAM online users in short format ul rm [].... delete user's usrloc entries ul add ............ introduce a permanent usrloc entry ul add .. introduce a temporary usrloc entry -- command 'fifo' fifo ............................... send raw FIFO command ➜ ~ opopensipsctl ul /bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8) ERROR: usrloc - too few parameters -- command 'ul' - manage user location records ul show []................ show in-RAM online users ul show --brief..................... show in-RAM online users in short format ul rm [].... delete user's usrloc entries ul add ............ introduce a permanent usrloc entry ul add .. introduce a temporary usrloc entry opensips命令 opensips -h\n有时候，你用opensipsctl start 启动opensips时，你可能会想，opensips是从哪个目录读取opensips.cfg文件的，那你可以输入opensips -h。输出的结果，第一行就包括了默认的配置文件的位置。\n-f file Configuration file (default /usr/local//etc/opensips/opensips.cfg) -c Check configuration file for errors -C Similar to '-c' but in addition checks the flags of exported functions from included route blocks -l address Listen on the specified address/interface (multiple -l mean listening on more addresses). The address format is [proto:]addr[:port], where proto=udp|tcp and addr= host|ip_address|interface_name. E.g: -l locahost, -l udp:127.0.0.1:5080, -l eth0:5062 The default behavior is to listen on all the interfaces. -n processes Number of worker processes to fork per UDP interface (default: 8) -r Use dns to check if is necessary to add a \"received=\" field to a via -R Same as `-r` but use reverse dns; (to use both use `-rR`) -v Turn on \"via:\" host checking when forwarding replies -d Debugging mode (multiple -d increase the level) -D Run in debug mode -F Daemon mode, but leave main process foreground -E Log to stderr -N processes Number of TCP worker processes (default: equal to `-n`) -W method poll method -V Version number -h This help message -b nr Maximum receive buffer size which will not be exceeded by auto-probing procedure even if OS allows -m nr Size of shared memory allocated in Megabytes 默认32MB -M nr Size of pkg memory allocated in Megabytes 默认2MB -w dir Change the working directory to \"dir\" (default \"/\") -t dir Chroot to \"dir\" -u uid Change uid -g gid Change gid -P file Create a pid file -G file Create a pgid file ","wordCount":"1420","inLanguage":"en","datePublished":"2019-06-13T22:03:19+08:00","dateModified":"2019-06-13T22:03:19+08:00","author":{"@type":"Person","name":"Eddie Wang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wdd.js.org/opensips/ch3/opensipsctl/"},"publisher":{"@type":"Organization","name":"洞香春","logo":{"@type":"ImageObject","url":"https://wdd.js.org/cowboy.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wdd.js.org accesskey=h title="洞香春 (Alt + H)"><img src=https://wdd.js.org/cowboy.ico alt aria-label=logo height=35>洞香春</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wdd.js.org/freeswitch/ title=FreeSWITCH><span>FreeSWITCH</span></a></li><li><a href=https://wdd.js.org/fe/ title=Frontend><span>Frontend</span></a></li><li><a href=https://wdd.js.org/golang/ title=Golang><span>Golang</span></a></li><li><a href=https://wdd.js.org/container/ title=k8s/docker><span>k8s/docker</span></a></li><li><a href=https://wdd.js.org/network/ title=Network><span>Network</span></a></li><li><a href=https://wdd.js.org/opensips/ title=OpenSIPS><span>OpenSIPS</span></a></li><li><a href=https://wdd.js.org/shell/ title=Shell><span>Shell</span></a></li><li><a href=https://wdd.js.org/vim/ title=VIM><span>VIM</span></a></li><li><a href=https://wdd.js.org/categories/ title=分类><span>分类</span></a></li><li><a href=https://wdd.js.org/search/ title=搜索><span>搜索</span></a></li><li><a href=https://wdd.js.org/tags/ title=标签><span>标签</span></a></li><li><a href=https://wdd.js.org/archives/ title=归档><span>归档</span></a></li><li><a href=https://wdd.js.org/about/ title=我><span>我</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wdd.js.org>Home</a>&nbsp;»&nbsp;<a href=https://wdd.js.org/opensips/>OpenSIPS2.4.X 中文实战系列</a></div><h1 class=post-title>opensips管理命令</h1><div class=post-meta><span title='2019-06-13 22:03:19 +0800 CST'>2019-06-13 22:03:19</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Eddie Wang&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/opensips/ch3/opensipsctl/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e6%a0%a1%e9%aa%8c aria-label=配置文件校验>配置文件校验</a></li><li><a href=#%e5%90%af%e5%8a%a8%e5%85%b3%e9%97%ad%e4%b8%8e%e9%87%8d%e5%90%af aria-label=启动关闭与重启>启动关闭与重启</a></li><li><a href=#%e8%b5%84%e6%ba%90%e5%88%9b%e5%bb%ba aria-label=资源创建>资源创建</a></li><li><a href=#opensips%e5%91%bd%e4%bb%a4 aria-label=opensips命令>opensips命令</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>可以使用一下命令查找opensips的相关文件夹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -name opensips -type d
</span></span></code></pre></div><p>一般来说，重要的是opensips.cfg文件，这个文件一般位于<code>/usr/local/etc/opensips/</code>或者<code>/usr/etc/opensips</code>中。主要还是要看安装时选择的默认路径。</p><p>其中1.x版本的配置文件一般位于<code>/usr/etc/opensips</code>目录中，2.x版本的配置一般位于<code>/usr/local/etc/opensips</code>目录中。</p><p>下面主要讲解几个命令。</p><h1 id=配置文件校验>配置文件校验<a hidden class=anchor aria-hidden=true href=#配置文件校验>#</a></h1><p>校验opensips.cfg脚本是否合法, 如果有问题，会提示那行代码有问题，但是报错位置好像一直不准确。很多时候可能是忘记写分好了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>opensips -C opensips.cfg
</span></span></code></pre></div><h1 id=启动关闭与重启>启动关闭与重启<a hidden class=anchor aria-hidden=true href=#启动关闭与重启>#</a></h1><p>使用opensipsctl命令做数据库操作前，需要先配置opensipsctlrc文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>opensips start|stop|restart
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>opensipsctl start|stop|restart
</span></span></code></pre></div><h1 id=资源创建>资源创建<a hidden class=anchor aria-hidden=true href=#资源创建>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>opensipsdbctl create <span style=color:#75715e># 创建数据库</span>
</span></span><span style=display:flex><span>opensipsctl domain add abc.cc <span style=color:#75715e>#创建域名</span>
</span></span><span style=display:flex><span>opensipsctl add 1001@test.cc <span style=color:#ae81ff>12346</span> <span style=color:#75715e># 新增用户</span>
</span></span><span style=display:flex><span>opensipsctl rm 1001@test.cc <span style=color:#75715e># 删除用户</span>
</span></span><span style=display:flex><span>opensipsctl passwdd 1001@test.cc <span style=color:#ae81ff>09879</span> <span style=color:#75715e># 修改密码</span>
</span></span></code></pre></div><p>opensipsctl -h 显示所有可用命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/local/sbin/opensipsctl $Revision: <span style=color:#ae81ff>4448</span> $
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Existing commands:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;start|stop|restart|trap&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> trap ............................... trap with gdb OpenSIPS processes
</span></span><span style=display:flex><span> restart ............................ restart OpenSIPS
</span></span><span style=display:flex><span> start .............................. start OpenSIPS
</span></span><span style=display:flex><span> stop ............................... stop OpenSIPS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;acl&#39;</span> - manage access control lists <span style=color:#f92672>(</span>acl<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> acl show <span style=color:#f92672>[</span>&lt;username&gt;<span style=color:#f92672>]</span> .............. show user membership
</span></span><span style=display:flex><span> acl grant &lt;username&gt; &lt;group&gt; ....... grant user membership <span style=color:#f92672>(</span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> acl revoke &lt;username&gt; <span style=color:#f92672>[</span>&lt;group&gt;<span style=color:#f92672>]</span> .... grant user membership<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;cr&#39;</span> - manage carrierroute tables
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> cr show ....................................................... show tables
</span></span><span style=display:flex><span> cr reload ..................................................... reload tables
</span></span><span style=display:flex><span> cr dump ....................................................... show in memory tables
</span></span><span style=display:flex><span> cr addrt &lt;routing_tree_id&gt; &lt;routing_tree&gt; ..................... add a tree
</span></span><span style=display:flex><span> cr rmrt  &lt;routing_tree&gt; ....................................... rm a tree
</span></span><span style=display:flex><span> cr addcarrier &lt;carrier&gt; &lt;scan_prefix&gt; &lt;domain&gt; &lt;rewrite_host&gt; ................
</span></span><span style=display:flex><span>               &lt;prob&gt; &lt;strip&gt; &lt;rewrite_prefix&gt; &lt;rewrite_suffix&gt; ...............
</span></span><span style=display:flex><span>               &lt;flags&gt; &lt;mask&gt; &lt;comment&gt; .........................add a carrier
</span></span><span style=display:flex><span>               <span style=color:#f92672>(</span>prob, strip, rewrite_prefix, rewrite_suffix,...................
</span></span><span style=display:flex><span>                flags, mask and comment are optional arguments<span style=color:#f92672>)</span> ...............
</span></span><span style=display:flex><span> cr rmcarrier  &lt;carrier&gt; &lt;scan_prefix&gt; &lt;domain&gt; ................ rm a carrier
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;rpid&#39;</span> - manage Remote-Party-ID <span style=color:#f92672>(</span>RPID<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> rpid add &lt;username&gt; &lt;rpid&gt; ......... add rpid <span style=color:#66d9ef>for</span> a user <span style=color:#f92672>(</span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> rpid rm &lt;username&gt; ................. set rpid to NULL <span style=color:#66d9ef>for</span> a user <span style=color:#f92672>(</span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> rpid show &lt;username&gt; ............... show rpid of a user
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;add|passwd|rm&#39;</span> - manage subscribers
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> add &lt;username&gt; &lt;password&gt; .......... add a new subscriber <span style=color:#f92672>(</span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> passwd &lt;username&gt; &lt;passwd&gt; ......... change user<span style=color:#e6db74>&#39;s password (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> rm &lt;username&gt; ...................... delete a user (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>add|dump|reload|rm|show<span style=color:#e6db74>&#39; - manage address
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> address show ...................... show db content
</span></span></span><span style=display:flex><span><span style=color:#e6db74> address dump ...................... show cache content
</span></span></span><span style=display:flex><span><span style=color:#e6db74> address reload .................... reload db table into cache
</span></span></span><span style=display:flex><span><span style=color:#e6db74> address add &lt;grp&gt; &lt;ip&gt; &lt;mask&gt; &lt;port&gt; &lt;proto&gt; [&lt;context_info&gt;] [&lt;pattern&gt;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>             ....................... add a new entry
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	     ....................... (from_pattern and tag are optional arguments)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> address rm &lt;grp&gt; &lt;ip&gt; &lt;mask&gt; &lt;port&gt; ............... remove all entries
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	     ....................... for the given grp ip mask port
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>dr<span style=color:#e6db74>&#39; - manage dynamic routing
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   * Examples: dr addgw &#39;</span>1<span style=color:#e6db74>&#39; 10 &#39;</span>192.168.2.2<span style=color:#e6db74>&#39; 0 &#39;&#39; &#39;</span>GW001<span style=color:#e6db74>&#39; 0 &#39;</span>first_gw<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr addgw &#39;</span>2<span style=color:#e6db74>&#39; 20 &#39;</span>192.168.2.3<span style=color:#e6db74>&#39; 0 &#39;&#39; &#39;</span>GW002<span style=color:#e6db74>&#39; 0 &#39;</span>second_gw<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr rmgw 2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr addgrp &#39;</span>alice<span style=color:#e6db74>&#39; &#39;</span>example.com<span style=color:#e6db74>&#39; 10 &#39;</span>first group<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr rmgrp 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr addcr &#39;</span>cr_1<span style=color:#e6db74>&#39; &#39;</span>10<span style=color:#e6db74>&#39; 0 &#39;</span>CARRIER_1<span style=color:#e6db74>&#39; &#39;</span>first_carrier<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr rmcr 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr addrule &#39;</span>10,20<span style=color:#e6db74>&#39; &#39;</span>+1<span style=color:#e6db74>&#39; &#39;</span>20040101T083000<span style=color:#e6db74>&#39; 0 0 &#39;</span>1,2<span style=color:#e6db74>&#39; &#39;</span>NA_RULE<span style=color:#e6db74>&#39; &#39;</span>NA routing<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *           dr rmrule 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr show ............................ show dr tables
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr addgw &lt;gwid&gt; &lt;type&gt; &lt;address&gt; &lt;strip&gt; &lt;pri_prefix&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          &lt;attrs&gt; &lt;probe_mode&gt; &lt;description&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ................................. add gateway
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr rmgw &lt;id&gt; ....................... delete gateway
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr addgrp &lt;username&gt; &lt;domain&gt; &lt;groupid&gt; &lt;description&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ................................. add gateway group
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr rmgrp &lt;id&gt; ...................... delete gateway group
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr addcr &lt;carrierid&gt; &lt;gwlist&gt; &lt;flags&gt; &lt;attrs&gt; &lt;description&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ........................... add carrier
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr rmcr &lt;id&gt; ....................... delete carrier
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr addrule &lt;groupid&gt; &lt;prefix&gt; &lt;timerec&gt; &lt;priority&gt; &lt;routeid&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;gwlist&gt; &lt;attrs&gt; &lt;description&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ................................. add rule
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr rmrule &lt;ruleid&gt; ................. delete rule
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr reload .......................... reload dr tables
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr gw_status ....................... show gateway status
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dr carrier_status .................. show carrier status
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>dispatcher<span style=color:#e6db74>&#39; - manage dispatcher
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   * Examples:  dispatcher addgw 1 sip:1.2.3.1:5050 &#39;&#39; 0 50 &#39;</span>og1<span style=color:#e6db74>&#39; &#39;</span>Outbound Gateway1<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *            dispatcher addgw 2 sip:1.2.3.4:5050 &#39;&#39; 0 50 &#39;</span>og2<span style=color:#e6db74>&#39; &#39;</span>Outbound Gateway2<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   *            dispatcher rmgw 4
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dispatcher show ..................... show dispatcher gateways
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dispatcher reload ................... reload dispatcher gateways
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dispatcher dump ..................... show in memory dispatcher gateways
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dispatcher addgw &lt;setid&gt; &lt;destination&gt; &lt;socket&gt; &lt;state&gt; &lt;weight&gt; &lt;attrs&gt; [description]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            .......................... add gateway
</span></span></span><span style=display:flex><span><span style=color:#e6db74> dispatcher rmgw &lt;id&gt; ................ delete gateway
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>registrant<span style=color:#e6db74>&#39; - manage registrants
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   * Examples:  registrant add sip:opensips.org &#39;&#39; sip:user@opensips.org &#39;&#39; user password sip:user@localhost &#39;&#39; 3600 &#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74> registrant show ......................... show registrant table
</span></span></span><span style=display:flex><span><span style=color:#e6db74> registrant dump ......................... show registrant status
</span></span></span><span style=display:flex><span><span style=color:#e6db74> registrant add &lt;registrar&gt; &lt;proxy&gt; &lt;aor&gt; &lt;third_party_registrant&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &lt;username&gt; &lt;password&gt; &lt;binding_URI&gt; &lt;binding_params&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &lt;expiry&gt; &lt;forced_socket&gt; . add a registrant
</span></span></span><span style=display:flex><span><span style=color:#e6db74> registrant rm ........................... removes the entire registrant table
</span></span></span><span style=display:flex><span><span style=color:#e6db74> registrant rmaor &lt;id&gt; ................... removes the gived aor id
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>db<span style=color:#e6db74>&#39; - database operations
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> db exec &lt;query&gt; ..................... execute SQL query
</span></span></span><span style=display:flex><span><span style=color:#e6db74> db roexec &lt;roquery&gt; ................. execute read-only SQL query
</span></span></span><span style=display:flex><span><span style=color:#e6db74> db run &lt;id&gt; ......................... execute SQL query from $id variable
</span></span></span><span style=display:flex><span><span style=color:#e6db74> db rorun &lt;id&gt; ....................... execute read-only SQL query from
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                       $id variable
</span></span></span><span style=display:flex><span><span style=color:#e6db74> db show &lt;table&gt; ..................... display table content
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>speeddial<span style=color:#e6db74>&#39; - manage speed dials (short numbers)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> speeddial show &lt;speeddial-id&gt; ....... show speeddial details
</span></span></span><span style=display:flex><span><span style=color:#e6db74> speeddial list &lt;sip-id&gt; ............. list speeddial for uri
</span></span></span><span style=display:flex><span><span style=color:#e6db74> speeddial add &lt;sip-id&gt; &lt;sd-id&gt; &lt;new-uri&gt; [&lt;desc&gt;] ...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           ........................... add a speedial (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> speeddial rm &lt;sip-id&gt; &lt;sd-id&gt; ....... remove a speeddial (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> speeddial help ...................... help message
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;speeddial-id&gt;, &lt;sd-id&gt; must be an AoR (username@domain)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;sip-id&gt; must be an AoR (username@domain)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;new-uri&gt; must be a SIP AoR (sip:username@domain)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;desc&gt; a description for speeddial
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>avp<span style=color:#e6db74>&#39; - manage AVPs
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> avp list [-T table] [-u &lt;sip-id|uuid&gt;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     [-a attribute] [-v value] [-t type] ... list AVPs
</span></span></span><span style=display:flex><span><span style=color:#e6db74> avp add [-T table] &lt;sip-id|uuid&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     &lt;attribute&gt; &lt;type&gt; &lt;value&gt; ............ add AVP (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> avp rm [-T table]  [-u &lt;sip-id|uuid&gt;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     [-a attribute] [-v value] [-t type] ... remove AVP (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> avp help .................................. help message
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - -T - table name
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - -u - SIP id or unique id
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - -a - AVP name
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - -v - AVP value
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - -t - AVP name and type (0 (str:str), 1 (str:int),
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                              2 (int:str), 3 (int:int))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;sip-id&gt; must be an AoR (username@domain)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;uuid&gt; must be a string but not AoR
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>alias_db<span style=color:#e6db74>&#39; - manage database aliases
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> alias_db show &lt;alias&gt; .............. show alias details
</span></span></span><span style=display:flex><span><span style=color:#e6db74> alias_db list &lt;sip-id&gt; ............. list aliases for uri
</span></span></span><span style=display:flex><span><span style=color:#e6db74> alias_db add &lt;alias&gt; &lt;sip-id&gt; ...... add an alias (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> alias_db rm &lt;alias&gt; ................ remove an alias (*)
</span></span></span><span style=display:flex><span><span style=color:#e6db74> alias_db help ...................... help message
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;alias&gt; must be an AoR (username@domain)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - &lt;sip-id&gt; must be an AoR (username@domain)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>domain<span style=color:#e6db74>&#39; - manage local domains
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> domain reload ....................... reload domains from disk
</span></span></span><span style=display:flex><span><span style=color:#e6db74> domain show ......................... show current domains in memory
</span></span></span><span style=display:flex><span><span style=color:#e6db74> domain showdb ....................... show domains in the database
</span></span></span><span style=display:flex><span><span style=color:#e6db74> domain add &lt;domain&gt; ................. add the domain to the database
</span></span></span><span style=display:flex><span><span style=color:#e6db74> domain rm &lt;domain&gt; .................. delete the domain from the database
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>cisco_restart<span style=color:#e6db74>&#39; - restart CISCO phone (NOTIFY)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> cisco_restart &lt;uri&gt; ................ restart phone configured for &lt;uri&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>online<span style=color:#e6db74>&#39; - dump online users from memory
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> online ............................. display online users
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>monitor<span style=color:#e6db74>&#39; - show internal status
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> monitor ............................ show server&#39;</span>s internal status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;ping&#39;</span> - ping a SIP URI <span style=color:#f92672>(</span>OPTIONS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> ping &lt;uri&gt; ......................... ping &lt;uri&gt; with SIP OPTIONS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> -- command <span style=color:#e6db74>&#39;ul&#39;</span> - manage user location records
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> ul show <span style=color:#f92672>[</span>&lt;username&gt;<span style=color:#f92672>]</span>................ show in-RAM online users
</span></span><span style=display:flex><span> ul show --brief..................... show in-RAM online users in short format
</span></span><span style=display:flex><span> ul rm &lt;username&gt; <span style=color:#f92672>[</span>&lt;contact URI&gt;<span style=color:#f92672>]</span>.... delete user<span style=color:#e6db74>&#39;s usrloc entries
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ul add &lt;username&gt; &lt;uri&gt; ............ introduce a permanent usrloc entry
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ul add &lt;username&gt; &lt;uri&gt; &lt;expires&gt; .. introduce a temporary usrloc entry
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>fifo<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> fifo ............................... send raw FIFO command
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>➜  ~ opopensipsctl ul
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ERROR: usrloc - too few parameters
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> -- command &#39;</span>ul<span style=color:#e6db74>&#39; - manage user location records
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ul show [&lt;username&gt;]................ show in-RAM online users
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ul show --brief..................... show in-RAM online users in short format
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ul rm &lt;username&gt; [&lt;contact URI&gt;].... delete user&#39;</span>s usrloc entries
</span></span><span style=display:flex><span> ul add &lt;username&gt; &lt;uri&gt; ............ introduce a permanent usrloc entry
</span></span><span style=display:flex><span> ul add &lt;username&gt; &lt;uri&gt; &lt;expires&gt; .. introduce a temporary usrloc entry
</span></span></code></pre></div><h1 id=opensips命令>opensips命令<a hidden class=anchor aria-hidden=true href=#opensips命令>#</a></h1><p>opensips -h</p><p>有时候，你用opensipsctl start 启动opensips时，你可能会想，opensips是从哪个目录读取opensips.cfg文件的，那你可以输入opensips -h。输出的结果，第一行就包括了默认的配置文件的位置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> -f file      Configuration file <span style=color:#f92672>(</span>default /usr/local//etc/opensips/opensips.cfg<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    -c           Check configuration file <span style=color:#66d9ef>for</span> errors
</span></span><span style=display:flex><span>    -C           Similar to <span style=color:#e6db74>&#39;-c&#39;</span> but in addition checks the flags of exported
</span></span><span style=display:flex><span>                  functions from included route blocks
</span></span><span style=display:flex><span>    -l address   Listen on the specified address/interface <span style=color:#f92672>(</span>multiple -l
</span></span><span style=display:flex><span>                  mean listening on more addresses<span style=color:#f92672>)</span>.  The address format is
</span></span><span style=display:flex><span>                  <span style=color:#f92672>[</span>proto:<span style=color:#f92672>]</span>addr<span style=color:#f92672>[</span>:port<span style=color:#f92672>]</span>, where proto<span style=color:#f92672>=</span>udp|tcp and
</span></span><span style=display:flex><span>                  addr<span style=color:#f92672>=</span> host|ip_address|interface_name. E.g: -l locahost,
</span></span><span style=display:flex><span>                  -l udp:127.0.0.1:5080, -l eth0:5062 The default behavior
</span></span><span style=display:flex><span>                  is to listen on all the interfaces.
</span></span><span style=display:flex><span>    -n processes Number of worker processes to fork per UDP interface
</span></span><span style=display:flex><span>                  <span style=color:#f92672>(</span>default: 8<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    -r           Use dns to check <span style=color:#66d9ef>if</span> is necessary to add a <span style=color:#e6db74>&#34;received=&#34;</span>
</span></span><span style=display:flex><span>                  field to a via
</span></span><span style=display:flex><span>    -R           Same as <span style=color:#e6db74>`</span>-r<span style=color:#e6db74>`</span> but use reverse dns;
</span></span><span style=display:flex><span>                  <span style=color:#f92672>(</span>to use both use <span style=color:#e6db74>`</span>-rR<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    -v           Turn on <span style=color:#e6db74>&#34;via:&#34;</span> host checking when forwarding replies
</span></span><span style=display:flex><span>    -d           Debugging mode <span style=color:#f92672>(</span>multiple -d increase the level<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    -D           Run in debug mode
</span></span><span style=display:flex><span>    -F           Daemon mode, but leave main process foreground
</span></span><span style=display:flex><span>    -E           Log to stderr
</span></span><span style=display:flex><span>    -N processes Number of TCP worker processes <span style=color:#f92672>(</span>default: equal to <span style=color:#e6db74>`</span>-n<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    -W method    poll method
</span></span><span style=display:flex><span>    -V           Version number
</span></span><span style=display:flex><span>    -h           This help message
</span></span><span style=display:flex><span>    -b nr        Maximum receive buffer size which will not be exceeded by
</span></span><span style=display:flex><span>                  auto-probing procedure even <span style=color:#66d9ef>if</span>  OS allows
</span></span><span style=display:flex><span>    -m nr        Size of shared memory allocated in Megabytes 默认32MB
</span></span><span style=display:flex><span>    -M nr        Size of pkg memory allocated in Megabytes    默认2MB
</span></span><span style=display:flex><span>    -w dir       Change the working directory to <span style=color:#e6db74>&#34;dir&#34;</span> <span style=color:#f92672>(</span>default <span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    -t dir       Chroot to <span style=color:#e6db74>&#34;dir&#34;</span>
</span></span><span style=display:flex><span>    -u uid       Change uid
</span></span><span style=display:flex><span>    -g gid       Change gid
</span></span><span style=display:flex><span>    -P file      Create a pid file
</span></span><span style=display:flex><span>    -G file      Create a pgid file
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer><script src=https://giscus.app/client.js data-repo=wangduanduan/wangduanduan.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkxMTkyMjMyNjA=" data-category=Announcements data-category-id=DIC_kwDOBxsz3M4CAjBq data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://wdd.js.org>洞香春</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>