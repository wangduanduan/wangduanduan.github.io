<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>sipsak | 洞香春</title><meta name=keywords content><meta name=description content="sipsak is a command line tool which can send simple requests to a SIP server. It can run additional tests on a SIP server which are usefull for admins and developers of SIP enviroments.
https://github.com/nils-ohlmeier/sipsak
安装 apt-get install sipsak 发送options sipsak -vv -p 192.168.2.63:5060 -s sip:8001@test.cc man SIPSAK(1) User Manuals SIPSAK(1) NAME sipsak - a utility for various tests on sip servers and user agents SYNOPSIS sipsak [-dFGhiILnNMRSTUVvwz] [-a PASSWORD ] [-b NUMBER ] [-c SIPURI ] [-C SIPURI ] [-D NUMBER ] [-e NUMBER ] [-E STRING ] [-f FILE ] [-g STRING ] [-H HOSTNAME ] [-j STRING ] [-J STRING ] [-l PORT ] [-m NUMBER ] [-o NUMBER ] [-p HOSTNAME ] [-P NUMBER ] [-q REGEXP ] [-r PORT ] [-t NUMBER ] [-u STRING ] [-W NUMBER ] [-x NUMBER ] -s SIPURI DESCRIPTION sipsak is a SIP stress and diagnostics utility."><meta name=author content="Eddie Wang"><link rel=canonical href=https://wdd.js.org/opensips/tools/sipsak/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ceab085cbbf58c0ec96f6d415d51b3b44e204edfd71a45b4fa2d4aac13f119d0.css integrity="sha256-zqsIXLv1jA7Jb21BXVGztE4gTt/XGkW0+i1KrBPxGdA=" rel="preload stylesheet" as=style><link crossorigin=anonymous herf=/font-awesome/css/font-awesome.min.css rel=stylesheet type=text/css><link rel=preload href=/cowboy.ico as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wdd.js.org/cowboy.ico><link rel=icon type=image/png sizes=16x16 href=https://wdd.js.org/cowboy.ico><link rel=icon type=image/png sizes=32x32 href=https://wdd.js.org/cowboy.ico><link rel=apple-touch-icon href=https://wdd.js.org/cowboy.ico><link rel=mask-icon href=https://wdd.js.org/cowboy.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.117.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="sipsak"><meta property="og:description" content="sipsak is a command line tool which can send simple requests to a SIP server. It can run additional tests on a SIP server which are usefull for admins and developers of SIP enviroments.
https://github.com/nils-ohlmeier/sipsak
安装 apt-get install sipsak 发送options sipsak -vv -p 192.168.2.63:5060 -s sip:8001@test.cc man SIPSAK(1) User Manuals SIPSAK(1) NAME sipsak - a utility for various tests on sip servers and user agents SYNOPSIS sipsak [-dFGhiILnNMRSTUVvwz] [-a PASSWORD ] [-b NUMBER ] [-c SIPURI ] [-C SIPURI ] [-D NUMBER ] [-e NUMBER ] [-E STRING ] [-f FILE ] [-g STRING ] [-H HOSTNAME ] [-j STRING ] [-J STRING ] [-l PORT ] [-m NUMBER ] [-o NUMBER ] [-p HOSTNAME ] [-P NUMBER ] [-q REGEXP ] [-r PORT ] [-t NUMBER ] [-u STRING ] [-W NUMBER ] [-x NUMBER ] -s SIPURI DESCRIPTION sipsak is a SIP stress and diagnostics utility."><meta property="og:type" content="article"><meta property="og:url" content="https://wdd.js.org/opensips/tools/sipsak/"><meta property="og:image" content="https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="opensips"><meta property="article:published_time" content="2020-07-31T19:16:36+08:00"><meta property="article:modified_time" content="2020-07-31T19:16:36+08:00"><meta property="og:site_name" content="洞香春"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="sipsak"><meta name=twitter:description content="sipsak is a command line tool which can send simple requests to a SIP server. It can run additional tests on a SIP server which are usefull for admins and developers of SIP enviroments.
https://github.com/nils-ohlmeier/sipsak
安装 apt-get install sipsak 发送options sipsak -vv -p 192.168.2.63:5060 -s sip:8001@test.cc man SIPSAK(1) User Manuals SIPSAK(1) NAME sipsak - a utility for various tests on sip servers and user agents SYNOPSIS sipsak [-dFGhiILnNMRSTUVvwz] [-a PASSWORD ] [-b NUMBER ] [-c SIPURI ] [-C SIPURI ] [-D NUMBER ] [-e NUMBER ] [-E STRING ] [-f FILE ] [-g STRING ] [-H HOSTNAME ] [-j STRING ] [-J STRING ] [-l PORT ] [-m NUMBER ] [-o NUMBER ] [-p HOSTNAME ] [-P NUMBER ] [-q REGEXP ] [-r PORT ] [-t NUMBER ] [-u STRING ] [-W NUMBER ] [-x NUMBER ] -s SIPURI DESCRIPTION sipsak is a SIP stress and diagnostics utility."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"OpenSIPS2.4.X 中文实战系列","item":"https://wdd.js.org/opensips/"},{"@type":"ListItem","position":3,"name":"sipsak","item":"https://wdd.js.org/opensips/tools/sipsak/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"sipsak","name":"sipsak","description":"sipsak is a command line tool which can send simple requests to a SIP server. It can run additional tests on a SIP server which are usefull for admins and developers of SIP enviroments.\nhttps://github.com/nils-ohlmeier/sipsak\n安装 apt-get install sipsak 发送options sipsak -vv -p 192.168.2.63:5060 -s sip:8001@test.cc man SIPSAK(1) User Manuals SIPSAK(1) NAME sipsak - a utility for various tests on sip servers and user agents SYNOPSIS sipsak [-dFGhiILnNMRSTUVvwz] [-a PASSWORD ] [-b NUMBER ] [-c SIPURI ] [-C SIPURI ] [-D NUMBER ] [-e NUMBER ] [-E STRING ] [-f FILE ] [-g STRING ] [-H HOSTNAME ] [-j STRING ] [-J STRING ] [-l PORT ] [-m NUMBER ] [-o NUMBER ] [-p HOSTNAME ] [-P NUMBER ] [-q REGEXP ] [-r PORT ] [-t NUMBER ] [-u STRING ] [-W NUMBER ] [-x NUMBER ] -s SIPURI DESCRIPTION sipsak is a SIP stress and diagnostics utility.","keywords":[],"articleBody":"sipsak is a command line tool which can send simple requests to a SIP server. It can run additional tests on a SIP server which are usefull for admins and developers of SIP enviroments.\nhttps://github.com/nils-ohlmeier/sipsak\n安装 apt-get install sipsak 发送options sipsak -vv -p 192.168.2.63:5060 -s sip:8001@test.cc man SIPSAK(1) User Manuals SIPSAK(1) NAME sipsak - a utility for various tests on sip servers and user agents SYNOPSIS sipsak [-dFGhiILnNMRSTUVvwz] [-a PASSWORD ] [-b NUMBER ] [-c SIPURI ] [-C SIPURI ] [-D NUMBER ] [-e NUMBER ] [-E STRING ] [-f FILE ] [-g STRING ] [-H HOSTNAME ] [-j STRING ] [-J STRING ] [-l PORT ] [-m NUMBER ] [-o NUMBER ] [-p HOSTNAME ] [-P NUMBER ] [-q REGEXP ] [-r PORT ] [-t NUMBER ] [-u STRING ] [-W NUMBER ] [-x NUMBER ] -s SIPURI DESCRIPTION sipsak is a SIP stress and diagnostics utility. It sends SIP requests to the server within the sip-uri and examines received responses. It runs in one of the following modes: - default mode A SIP message is sent to destination in sip-uri and reply status is displayed. The request is either taken from filename or generated as a new OPTIONS message. - traceroute mode (-T) This mode is useful for learning request's path. It operates similarly to IP-layer utility traceroute(8). - message mode (-M) Sends a short message (similar to SMS from the mobile phones) to a given target. With the option -B the content of the MESSAGE can be set. Useful might be the options -c and -O in this mode. - usrloc mode (-U) Stress mode for SIP registrar. sipsak keeps registering to a SIP server at high pace. Additionally the registrar can be stressed with the -I or the -M option. If -I and -M are omitted sipsak can be used to register any given contact (with the -C option) for an account at a registrar and to query the current bindings for an account at a registrar. - randtrash mode (-R) Parser torture mode. sipsak keeps sending randomly corrupted messages to torture a SIP server's parser. - flood mode (-F) Stress mode for SIP servers. sipsak keeps sending requests to a SIP server at high pace. If libruli (http://www.nongnu.org/ruli/) or c-ares (http://daniel.haxx.se/projects/c-ares/) support is compiled into the sipsak binary, then first a SRV lookup for _sip._tcp.hostname is made. If that fails a SRV lookup for _sip._udp.hostname is made. And if this lookup fails a normal A lookup is made. If a port was given in the target URI the SRV lookup is omitted. Failover, load distribution and other transports are not supported yet. OPTIONS -a, --password PASSWORD With the given PASSWORD an authentication will be tryed on received '401 Unauthorized'. Authorization will be tryed on time. If this option is omitted an authorization with an empty password (\"\") will be tryed. If the password is equal to - the password will be read from the standard input (e.g. the keyboard). This prevents other users on the same host from seeing the password the password in the process list. NOTE: the password still can be read from the memory if other users have access to it. -A, --timing prints only the timing values of the test run if verbosity is zero because no -v was given. If one or more -v were given this option will be ignored. -b, --apendix-begin NUMBER The starting number which is appended to the user name in the usrloc mode. This NUMBER is increased until it reaches the value given by the -e parameter. If omitted the starting number will be one. -B, --message-body STRING The given STRING will be used as the body for outgoing MESSAGE requests. -c, --from SIPURI The given SIPURI will be used in the From header if sipsak runs in the message mode (initiated with the -M option). This is helpful to present the receiver of a MESSAGE a meaningfull and usable address to where maybe even responses can be send. -C, --contact SIPURI This is the content of the Contact header in the usrloc mode. This allows to insert forwards like for mail. For example you can insert the uri of your first SIP account at a second account, thus all calls to the second account will be for‐ warded to the first account. As the argument to this option will not be enclosed in brackets you can give also multiple contacts in the raw format as comma separated list. The special words empty or none will result in no contact header in the REGISTER request and thus the server should answer with the current bindings for the account at the registrar. The special words * or star will result in Contact header containing just a star, e.g. to remove all bindings by using expires value 0 together with this Contact. -d, --ignore-redirects If this option is set all redirects will be ignored. By default without this option received redirects will be respected. This option is automatically activated in the randtrash mode and in the flood mode. -D, --timeout-factor NUMBER The SIP_T1 timer is getting multiplied with the given NUMBER. After receiving a provisional response for an INVITE request, or when a reliable transport like TCP or TLS is used sipsak waits for the resulting amount of time for a final response until it gives up. -e, --appendix-end NUMBER The ending number which is appended to the user name in the usrloc mode. This number is increased until it reaches this ending number. In the flood mode this is the maximum number of messages which will be send. If omitted the default value is 2^31 (2147483647) in the flood mode. -E, --transport STRING The value of STRING will be used as IP transport for sending and receiving requests and responses. This option over‐ writes any result from the URI evaluation and SRV lookup. Currently only 'udp' and 'tcp' are accepted as value for STRING. -f, --filename FILE The content of FILE will be read in in binary mode and will be used as replacement for the alternatively created sip mes‐ sage. This can used in the default mode to make other requests than OPTIONS requests (e.g. INVITE). By default missing carriage returns in front of line feeds will be inserted (use -L to de-activate this function). If the filename is equal to - the file is read from standard input, e.g. from the keyboard or a pipe. Please note that the manipulation functions (e.g. inserting Via header) are only tested with RFC conform requests. Additionally special strings within the file can be replaced with some local or given values (see -g and -G for details). -F, --flood-mode This options activates the flood mode. In this mode OPTIONS requests with increasing CSeq numbers are sent to the server. Replies are ignored -- source port 9 (discard) of localhost is advertised in topmost Via. -h, --help Prints out a simple usage help message. If the long option --help is available it will print out a help message with the available long options. -g, --replace-string STRING Activates the replacement of $replace$ within the request (usually read in from a file) with the STRING. Alternatively you can also specify a list of attribute and values. This list has to start and end with a non alpha-numeric character. The same character has to be used also as separator between the attribute and the value and between new further attribute value pairs. The string \"$attribute$\" will be replaced with the value string in the message. -G, --replace Activates the automatic replacement of the following variables in the request (usually read in from a file): $dsthost$ will be replaced by with the host or domainname which is given by the -s parameter. $srchost$ will be replaced by the hostname of the local machine. $port$ will be replaced by the local listening port of sipsak. $user$ will be replaced by the username which is given by the -s parameter. -H, --hostname HOSTNAME Overwrites the automatic detection of the hostname with the given parameter. Warning: use this with caution (preferable only if the automatic detection fails). -i, --no-via Deactivates the insertion of the Via line of the localhost. Warning: this probably disables the receiving of the responses from the server. -I, --invite-mode Activates the Invites cycles within the usrloc mode. It should be combined with -U. In this combination sipsak first registeres a user, and then simulates an invitation to this user. First an Invite is sent, this is replied with 200 OK and finally an ACK is sent. This option can also be used without -U , but you should be sure to NOT invite real UAs with this option. In the case of a missing -U the -l PORT is required because only if you made a -U run with a fixed local port before, a run with -I and the same fixed local port can be successful. Warning: sipsak is no real UA and invita‐ tions to real UAs can result in unexpected behaivior. -j, --headers STRING The string will be added as one or more additional headers to the request. The string \"\\n\" (note: two characters) will be replaced with CRLF and thus result in two separate headers. That way more then one header can be added. -J, --autohash STRING The string will be used as the H(A1) input to the digest authentication response calculation. Thus no password from the -a option is required if this option is provided. The given string is expected to be a hex string with the length of the used hash function. -k, --local-ip STRING The local ip address to be used -l, --local-port PORT The receiving UDP socket will use the local network port. Useful if a file is given by -f which contains a correct Via line. Check the -S option for details how sipsak sends and receives messages. -L, --no-crlf De-activates the insertion of carriage returns (\\r) before all line feeds (\\n) (which is not already proceeded by car‐ raige return) if the input is coming from a file ( -f ). Without this option also an empty line will be appended to the request if required. -m, --max-forwards NUMBER This sets the value of the Max-Forward header field. If omitted no Max-Forward field will be inserted. If omitted in the traceroute mode number will be 255. -M, --message-mode This activates the Messages cycles within the usrloc mode (known from sipsak versions pre 0.8.0 within the normal usrloc test). This option should be combined with -U so that a successful registration will be tested with a test message to the user and replied with 200 OK. But this option can also be used without the -U option. Warning: using without -U can cause unexpected behaivor. -n, --numeric Instead of the full qualified domain name in the Via line the IP of the local host will be used. This option is now on by default. -N, --nagios-code Use Nagios comliant return codes instead of the normal sipsak ones. This means sipsak will return 0 if everything was ok and 2 in case of any error (local or remote). -o, --sleep NUMBER sipsak will sleep for NUMBER ms before it starts the next cycle in the usrloc mode. This will slow down the whole test process to be more realistic. Each cycle will be still completed as fast as possible, but the whole test will be slowed down. -O, --disposition STRING The given STRING will be used as the content for the Content-Disposition header. Without this option there will be no Content-Disposition header in the request. -p, --outbound-proxy HOSTNAME[:PORT] the address of the hostname is the target where the request will be sent to (outgoing proxy). Use this if the destination host is different then the host part of the request uri. The hostname is resolved via DNS SRV if supported (see descrip‐ tion for SRV resolving) and no port is given. -P, --processes NUMBER Start NUMBER of processes in parallel to do the send and reply checking. Only makes sense if a higher number for -e is given in the usrloc, message or invite mode. -q, --search REGEXP match replies against REGEXP and return false if no match occurred. Useful for example to detect server name in Server header field. -r, --remote-port PORT Instead of the default sip port 5060 the PORT will be used. Alternatively the remote port can be given within the sip uri of the -s parameter. -R, --random-mode This activates the randtrash mode. In this mode OPTIONS requests will be send to server with increasing numbers of ran‐ domly crashed characters within this request. The position within the request and the replacing character are randomly chosen. Any other response than Bad request (4xx) will stop this mode. Also three unresponded sends will stop this mode. With the -t parameter the maximum of trashed characters can be given. -s, --sip-uri SIPURI This mandatory option sets the destination of the request. It depends on the mode if only the server name or also an user name is mandatory. Example for a full SIPURI : sip:test@foo.bar:123 See the note in the description part about SRV lookups for details how the hostname of this URI is converted into an IP and port. -S, --symmetric With this option sipsak will use only one port for sending and receiving messages. With this option the local port for sending will be the value from the -l option. In the default mode sipsak sends from a random port and listens on the given port from the -l option. Note: With this option sipsak will not be able to receive replies from servers with asym‐ metric signaling (and broken rport implementation) like the Cisco proxy. If you run sipsak as root and with raw socket support (check the output from the -V option) then this option is not required because in this case sipsak already uses only one port for sending and receiving messages. -t, --trash-chars NUMBER This parameter specifies the maximum of trashed characters in the randtrash mode. If omitted NUMBER will be set to the length of the request. -T, --traceroute-mode This activates the traceroute mode. This mode works like the well known traceroute(8) command expect that not the number of network hops are counted rather the number of server on the way to the destination user. Also the round trip time of each request is printed out, but due to a limitation within the sip protocol the identity (IP or name) can only deter‐ mined and printed out if the response from the server contains a warning header field. In this mode on each outgoing request the value of the Max-Forwards header field is increased, starting with one. The maximum of the Max-Forwards header will 255 if no other value is given by the -m parameter. Any other response than 483 or 1xx are treated as a final response and will terminate this mode. -u, --auth-username STRING Use the given STRING as username value for the authentication (different account and authentication username). -U, --usrloc-mode This activates the usrloc mode. Without the -I or the -M option, this only registers users at a registrar. With one of the above options the previous registered user will also be probed ether with a simulated call flow (invite, 200, ack) or with an instant message (message, 200). One password for all users accounts within the usrloc test can be given with the -a option. An user name is mandatory for this mode in the -s parameter. The number starting from the -b parameter to the -e parameter is appended the user name. If the -b and the -e parameter are omitted, only one runs with the given user‐ name, but without append number to the usernames is done. -v, --verbose This parameter increases the output verbosity. No -v means nearly no output except in traceroute and error messages. The maximum of three v's prints out the content of all packets received and sent. -V, --version Prints out the name and version number of sipsak and the options which were compiled into the binary. -w, --extract-ip Activates the extraction of the IP or hostname from the Warning header field. -W, --nagios-warn NUMBER Return Nagios warn exit code (1) if the number of retransmissions before success was above the given number. -x, --expires NUMBER Sets the value of the Expires header to the given number. -z, --remove-bindings Activates the randomly removing of old bindings in the usrloc mode. How many per cent of the bindings will be removed, is determined by the USRLOC_REMOVE_PERCENT define within the code (set it before compilation). Multiple removing of bind‐ ings is possible, and cannot be prevented. -Z, --timer-t1 Sets the amount of milliseconds for the SIP timer T1. It determines the length of the gaps between two retransmissions of a request on a unreliable transport. Default value is 500 if not changed via the configure option --enable-timeout. RETURN VALUES The return value 0 means that a 200 was received. 1 means something else then 1xx or 2xx was received. 2 will be returned on local errors like non resolvable names or wrong options combination. 3 will be returned on remote errors like socket errors (e.g. icmp error), redirects without a contact header or simply no answer (timeout). If the -N option was given the return code will be 2 in case of any (local or remote) error. 1 in case there have been retrans‐ missions from sipsak to the server. And 0 if there was no error at all. CAUTION Use sipsak responsibly. Running it in any of the stress modes puts substantial burden on network and server under test. EXAMPLES sipsak -vv -s sip:nobody@foo.bar displays received replies. sipsak -T -s sip:nobody@foo.bar traces SIP path to nobody. sipsak -U -C sip:me@home -x 3600 -a password -s sip:myself@company inserts forwarding from work to home for one hour. sipsak -f bye.sip -g '!FTAG!345.af23!TTAG!1208.12!' -s sip:myproxy reads the file bye.sip, replaces $FTAG$ with 345.af23 and $TTAG$ with 1208.12 and finally send this message to myproxy LIMITATIONS / NOT IMPLEMENTED Many servers may decide NOT to include SIP \"Warning\" header fields. Unfortunately, this makes displaying IP addresses of SIP servers in traceroute mode impossible. IPv6 is not supported. Missing support for the Record-Route and Route header. BUGS sipsak is only tested against the SIP Express Router (ser) though their could be various bugs. Please feel free to mail them to the author. AUTHOR Nils Ohlmeier SEE ALSO traceroute(8) ","wordCount":"3083","inLanguage":"en","datePublished":"2020-07-31T19:16:36+08:00","dateModified":"2020-07-31T19:16:36+08:00","author":{"@type":"Person","name":"Eddie Wang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wdd.js.org/opensips/tools/sipsak/"},"publisher":{"@type":"Organization","name":"洞香春","logo":{"@type":"ImageObject","url":"https://wdd.js.org/cowboy.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wdd.js.org accesskey=h title="洞香春 (Alt + H)"><img src=/cowboy.ico alt=logo aria-label=logo height=35>洞香春</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://wdd.js.org/freeswitch/ title=FreeSWITCH><span>FreeSWITCH</span></a></li><li><a href=https://wdd.js.org/fe/ title=Frontend><span>Frontend</span></a></li><li><a href=https://wdd.js.org/golang/ title=Golang><span>Golang</span></a></li><li><a href=https://wdd.js.org/container/ title=k8s/docker><span>k8s/docker</span></a></li><li><a href=https://wdd.js.org/network/ title=Network><span>Network</span></a></li><li><a href=https://wdd.js.org/opensips/ title=OpenSIPS><span>OpenSIPS</span></a></li><li><a href=https://wdd.js.org/shell/ title=Shell><span>Shell</span></a></li><li><a href=https://wdd.js.org/vim/ title=VIM><span>VIM</span></a></li><li><a href=https://wdd.js.org/categories/ title=分类><span>分类</span></a></li><li><a href=https://wdd.js.org/search/ title=搜索><span>搜索</span></a></li><li><a href=https://wdd.js.org/tags/ title=标签><span>标签</span></a></li><li><a href=https://wdd.js.org/archives/ title=归档><span>归档</span></a></li><li><a href=https://wdd.js.org/about/ title=我><span>我</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wdd.js.org>Home</a>&nbsp;»&nbsp;<a href=https://wdd.js.org/opensips/>OpenSIPS2.4.X 中文实战系列</a></div><h1 class=post-title>sipsak</h1><div class=post-meta><span title='2020-07-31 19:16:36 +0800 CST'>2020-07-31 19:16:36</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;Eddie Wang</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%ae%89%e8%a3%85 aria-label=安装>安装</a></li><li><a href=#%e5%8f%91%e9%80%81options aria-label=发送options>发送options</a></li><li><a href=#man aria-label=man>man</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>sipsak is a command line tool which can send simple requests to a SIP server. It can run additional tests on a SIP server which are usefull for admins and developers of SIP enviroments.</p><p><a href=https://github.com/nils-ohlmeier/sipsak>https://github.com/nils-ohlmeier/sipsak</a></p><h1 id=安装>安装<a hidden class=anchor aria-hidden=true href=#安装>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install sipsak
</span></span></code></pre></div><h1 id=发送options>发送options<a hidden class=anchor aria-hidden=true href=#发送options>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sipsak -vv -p 192.168.2.63:5060 -s sip:8001@test.cc
</span></span></code></pre></div><h1 id=man>man<a hidden class=anchor aria-hidden=true href=#man>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>SIPSAK<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>                                                     User Manuals                                                    SIPSAK<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME
</span></span><span style=display:flex><span>       sipsak - a utility <span style=color:#66d9ef>for</span> various tests on sip servers and user agents
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SYNOPSIS
</span></span><span style=display:flex><span>       sipsak  <span style=color:#f92672>[</span>-dFGhiILnNMRSTUVvwz<span style=color:#f92672>]</span>  <span style=color:#f92672>[</span>-a  PASSWORD <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-b NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-c SIPURI <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-C SIPURI <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-D NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-e NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-E STRING <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-f
</span></span><span style=display:flex><span>       FILE <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-g STRING <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-H HOSTNAME <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-j STRING <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-J STRING <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-l PORT <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-m NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-o NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-p HOSTNAME <span style=color:#f92672>]</span>  <span style=color:#f92672>[</span>-P  NUMBER  <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>[</span>-q REGEXP <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-r PORT <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-t NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-u STRING <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-W NUMBER <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-x NUMBER <span style=color:#f92672>]</span> -s SIPURI
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DESCRIPTION
</span></span><span style=display:flex><span>       sipsak  is  a  SIP stress and diagnostics utility.  It sends SIP requests to the server within the sip-uri and examines received
</span></span><span style=display:flex><span>       responses.  It runs in one of the following modes:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       - default mode
</span></span><span style=display:flex><span>              A SIP message is sent to destination in sip-uri and reply status is displayed.  The request is either taken from filename
</span></span><span style=display:flex><span>              or generated as a new OPTIONS message.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       - traceroute mode <span style=color:#f92672>(</span>-T<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>              This mode is useful <span style=color:#66d9ef>for</span> learning request<span style=color:#e6db74>&#39;s path. It operates similarly to IP-layer utility traceroute(8).
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       - message mode (-M)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Sends  a  short  message (similar to SMS from the mobile phones) to a given target. With the option -B the content of the
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              MESSAGE can be set. Useful might be the options -c and -O in this mode.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       - usrloc mode (-U)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Stress mode for SIP registrar.  sipsak keeps registering to a SIP server at high pace. Additionally the registrar can  be
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              stressed  with  the -I or the -M option.  If -I and -M are omitted sipsak can be used to register any given contact (with
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              the -C option) for an account at a registrar and to query the current bindings for an account at a registrar.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       - randtrash mode (-R)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Parser torture mode.  sipsak keeps sending randomly corrupted messages to torture a SIP server&#39;</span>s parser.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       - flood mode <span style=color:#f92672>(</span>-F<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>              Stress mode <span style=color:#66d9ef>for</span> SIP servers.  sipsak keeps sending requests to a SIP server at high pace.
</span></span><span style=display:flex><span>      If libruli <span style=color:#f92672>(</span>http://www.nongnu.org/ruli/<span style=color:#f92672>)</span> or c-ares <span style=color:#f92672>(</span>http://daniel.haxx.se/projects/c-ares/<span style=color:#f92672>)</span> support is compiled into the  sipsak
</span></span><span style=display:flex><span>       binary,  <span style=color:#66d9ef>then</span>  first a SRV lookup <span style=color:#66d9ef>for</span> _sip._tcp.hostname is made. If that fails a SRV lookup <span style=color:#66d9ef>for</span> _sip._udp.hostname is made. And
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>if</span> this lookup fails a normal A lookup is made. If a port was given in the target URI the SRV lookup is omitted. Failover,  load
</span></span><span style=display:flex><span>       distribution and other transports are not supported yet.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OPTIONS
</span></span><span style=display:flex><span>       -a, --password PASSWORD
</span></span><span style=display:flex><span>              With  the  given  PASSWORD an authentication will be tryed on received <span style=color:#e6db74>&#39;401 Unauthorized&#39;</span>. Authorization will be tryed on
</span></span><span style=display:flex><span>              time. If this option is omitted an authorization with an empty password <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>)</span> will be tryed. If the password is equal to -
</span></span><span style=display:flex><span>              the  password  will  be read from the standard input <span style=color:#f92672>(</span>e.g. the keyboard<span style=color:#f92672>)</span>. This prevents other users on the same host from
</span></span><span style=display:flex><span>              seeing the password the password in the process list.  NOTE: the password still can be read  from  the  memory  <span style=color:#66d9ef>if</span>  other
</span></span><span style=display:flex><span>              users have access to it.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -A, --timing
</span></span><span style=display:flex><span>              prints  only the timing values of the test run <span style=color:#66d9ef>if</span> verbosity is zero because no -v was given. If one or more -v were given
</span></span><span style=display:flex><span>              this option will be ignored.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -b, --apendix-begin NUMBER
</span></span><span style=display:flex><span>              The starting number which is appended to the user name in the usrloc mode.  This NUMBER is increased <span style=color:#66d9ef>until</span> it reaches the
</span></span><span style=display:flex><span>              value given by the -e parameter. If omitted the starting number will be one.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -B, --message-body STRING
</span></span><span style=display:flex><span>              The given STRING will be used as the body <span style=color:#66d9ef>for</span> outgoing MESSAGE requests.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -c, --from SIPURI
</span></span><span style=display:flex><span>              The  given SIPURI will be used in the From header <span style=color:#66d9ef>if</span> sipsak runs in the message mode <span style=color:#f92672>(</span>initiated with the -M option<span style=color:#f92672>)</span>. This
</span></span><span style=display:flex><span>              is helpful to present the receiver of a MESSAGE a meaningfull and usable address to where maybe  even  responses  can  be
</span></span><span style=display:flex><span>              send.
</span></span><span style=display:flex><span>      -C, --contact SIPURI
</span></span><span style=display:flex><span>              This  is  the content of the Contact header in the usrloc mode. This allows to insert forwards like <span style=color:#66d9ef>for</span> mail. For example
</span></span><span style=display:flex><span>              you can insert the uri of your first SIP account at a second account, thus all calls to the second account will  be  <span style=color:#66d9ef>for</span>‐
</span></span><span style=display:flex><span>              warded  to the first account.  As the argument to this option will not be enclosed in brackets you can give also multiple
</span></span><span style=display:flex><span>              contacts in the raw format as comma separated list.  The special words empty or none will result in no contact header  in
</span></span><span style=display:flex><span>              the  REGISTER  request and thus the server should answer with the current bindings <span style=color:#66d9ef>for</span> the account at the registrar.  The
</span></span><span style=display:flex><span>              special words * or star will result in Contact header containing just a star,  e.g.  to  remove  all  bindings  by  using
</span></span><span style=display:flex><span>              expires value <span style=color:#ae81ff>0</span> together with this Contact.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -d, --ignore-redirects
</span></span><span style=display:flex><span>              If this option is set all redirects will be ignored. By default without this option received redirects will be respected.
</span></span><span style=display:flex><span>              This option is automatically activated in the randtrash mode and in the flood mode.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -D, --timeout-factor NUMBER
</span></span><span style=display:flex><span>              The SIP_T1 timer is getting multiplied with the given NUMBER. After  receiving  a  provisional  response  <span style=color:#66d9ef>for</span>  an  INVITE
</span></span><span style=display:flex><span>              request,  or  when a reliable transport like TCP or TLS is used sipsak waits <span style=color:#66d9ef>for</span> the resulting amount of time <span style=color:#66d9ef>for</span> a final
</span></span><span style=display:flex><span>              response <span style=color:#66d9ef>until</span> it gives up.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -e, --appendix-end NUMBER
</span></span><span style=display:flex><span>              The ending number which is appended to the user name in the usrloc mode.  This number is increased <span style=color:#66d9ef>until</span> it reaches  this
</span></span><span style=display:flex><span>              ending  number.   In  the  flood  mode this is the maximum number of messages which will be send.  If omitted the default
</span></span><span style=display:flex><span>              value is 2^31 <span style=color:#f92672>(</span>2147483647<span style=color:#f92672>)</span> in the flood mode.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -E, --transport STRING
</span></span><span style=display:flex><span>              The value of STRING will be used as IP transport <span style=color:#66d9ef>for</span> sending and receiving requests and  responses.   This  option  over‐
</span></span><span style=display:flex><span>              writes  any  result  from  the  URI  evaluation and SRV lookup.  Currently only <span style=color:#e6db74>&#39;udp&#39;</span> and <span style=color:#e6db74>&#39;tcp&#39;</span> are accepted as value <span style=color:#66d9ef>for</span>
</span></span><span style=display:flex><span>              STRING.
</span></span><span style=display:flex><span>      -f, --filename FILE
</span></span><span style=display:flex><span>              The content of FILE will be read in in binary mode and will be used as replacement <span style=color:#66d9ef>for</span> the alternatively created sip mes‐
</span></span><span style=display:flex><span>              sage.  This  can  used in the default mode to make other requests than OPTIONS requests <span style=color:#f92672>(</span>e.g. INVITE<span style=color:#f92672>)</span>. By default missing
</span></span><span style=display:flex><span>              carriage returns in front of line feeds will be inserted <span style=color:#f92672>(</span>use -L to de-activate this <span style=color:#66d9ef>function</span><span style=color:#f92672>)</span>. If the filename is  equal
</span></span><span style=display:flex><span>              to - the file is read from standard input, e.g. from the keyboard or a pipe.  Please note that the manipulation functions
</span></span><span style=display:flex><span>              <span style=color:#f92672>(</span>e.g. inserting Via header<span style=color:#f92672>)</span> are only tested with RFC conform requests. Additionally special strings within the  file  can
</span></span><span style=display:flex><span>              be replaced with some local or given values <span style=color:#f92672>(</span>see -g and -G <span style=color:#66d9ef>for</span> details<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -F, --flood-mode
</span></span><span style=display:flex><span>              This options activates the flood mode. In this mode OPTIONS requests with increasing CSeq numbers are sent to the server.
</span></span><span style=display:flex><span>              Replies are ignored -- source port <span style=color:#ae81ff>9</span> <span style=color:#f92672>(</span>discard<span style=color:#f92672>)</span> of localhost is advertised in topmost Via.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -h, --help
</span></span><span style=display:flex><span>              Prints out a simple usage help message. If the long option --help is available it will print out a help message with  the
</span></span><span style=display:flex><span>              available long options.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -g, --replace-string STRING
</span></span><span style=display:flex><span>              Activates  the  replacement of $replace$ within the request <span style=color:#f92672>(</span>usually read in from a file<span style=color:#f92672>)</span> with the STRING.  Alternatively
</span></span><span style=display:flex><span>              you can also specify a list of attribute and values.  This list has to start and end with a non alpha-numeric  character.
</span></span><span style=display:flex><span>              The same character has to be used also as separator between the attribute and the value and between new further attribute
</span></span><span style=display:flex><span>              value pairs. The string <span style=color:#e6db74>&#34;</span>$attribute$<span style=color:#e6db74>&#34;</span> will be replaced with the value string in the message.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -G, --replace
</span></span><span style=display:flex><span>              Activates the automatic replacement of the following variables in the request <span style=color:#f92672>(</span>usually read in from  a  file<span style=color:#f92672>)</span>:  $dsthost$
</span></span><span style=display:flex><span>              will  be  replaced  by with the host or domainname which is given by the -s parameter.  $srchost$ will be replaced by the
</span></span><span style=display:flex><span>              hostname of the local machine.  $port$ will be replaced by the local listening port of sipsak.  $user$ will  be  replaced
</span></span><span style=display:flex><span>              by the username which is given by the -s parameter.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -H, --hostname HOSTNAME
</span></span><span style=display:flex><span>              Overwrites  the automatic detection of the hostname with the given parameter.  Warning: use this with caution <span style=color:#f92672>(</span>preferable
</span></span><span style=display:flex><span>              only <span style=color:#66d9ef>if</span> the automatic detection fails<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>       -i, --no-via
</span></span><span style=display:flex><span>              Deactivates the insertion of the Via line of the localhost.   Warning:  this  probably  disables  the  receiving  of  the
</span></span><span style=display:flex><span>              responses from the server.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -I, --invite-mode
</span></span><span style=display:flex><span>              Activates  the  Invites  cycles  within the usrloc mode. It should be combined with -U.  In this combination sipsak first
</span></span><span style=display:flex><span>              registeres a user, and <span style=color:#66d9ef>then</span> simulates an invitation to this user. First an Invite is sent, this is replied  with  <span style=color:#ae81ff>200</span>  OK
</span></span><span style=display:flex><span>              and  finally an ACK is sent. This option can also be used without -U , but you should be sure to NOT invite real UAs with
</span></span><span style=display:flex><span>              this option. In the <span style=color:#66d9ef>case</span> of a missing -U the -l PORT is required because only <span style=color:#66d9ef>if</span> you made a -U run  with  a  fixed  local
</span></span><span style=display:flex><span>              port  before,  a  run with -I and the same fixed local port can be successful.  Warning: sipsak is no real UA and invita‐
</span></span><span style=display:flex><span>              tions to real UAs can result in unexpected behaivior.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -j, --headers STRING
</span></span><span style=display:flex><span>              The string will be added as one or more additional headers to the request. The string <span style=color:#e6db74>&#34;\n&#34;</span> <span style=color:#f92672>(</span>note: two characters<span style=color:#f92672>)</span> will be
</span></span><span style=display:flex><span>              replaced with CRLF and thus result in two separate headers. That way more <span style=color:#66d9ef>then</span> one header can be added.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -J, --autohash STRING
</span></span><span style=display:flex><span>              The  string  will be used as the H<span style=color:#f92672>(</span>A1<span style=color:#f92672>)</span> input to the digest authentication response calculation. Thus no password from the
</span></span><span style=display:flex><span>              -a option is required <span style=color:#66d9ef>if</span> this option is provided. The given string is expected to be a hex string with the length of  the
</span></span><span style=display:flex><span>              used hash <span style=color:#66d9ef>function</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -k, --local-ip STRING
</span></span><span style=display:flex><span>              The local ip address to be used
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -l, --local-port PORT
</span></span><span style=display:flex><span>              The  receiving  UDP socket will use the local network port.  Useful <span style=color:#66d9ef>if</span> a file is given by -f which contains a correct Via
</span></span><span style=display:flex><span>              line. Check the -S option <span style=color:#66d9ef>for</span> details how sipsak sends and receives messages.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -L, --no-crlf
</span></span><span style=display:flex><span>              De-activates the insertion of carriage returns <span style=color:#f92672>(</span><span style=color:#ae81ff>\r</span><span style=color:#f92672>)</span> before all line feeds <span style=color:#f92672>(</span><span style=color:#ae81ff>\n</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>which is not already  proceeded  by  car‐
</span></span><span style=display:flex><span>              raige  <span style=color:#66d9ef>return</span><span style=color:#f92672>)</span>  <span style=color:#66d9ef>if</span> the input is coming from a file <span style=color:#f92672>(</span> -f <span style=color:#f92672>)</span>. Without this option also an empty line will be appended to the
</span></span><span style=display:flex><span>              request <span style=color:#66d9ef>if</span> required.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      -m, --max-forwards NUMBER
</span></span><span style=display:flex><span>              This sets the value of the Max-Forward header field. If omitted no Max-Forward field will be inserted. If omitted in  the
</span></span><span style=display:flex><span>              traceroute mode number will be 255.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -M, --message-mode
</span></span><span style=display:flex><span>              This  activates the Messages cycles within the usrloc mode <span style=color:#f92672>(</span>known from sipsak versions pre 0.8.0 within the normal usrloc
</span></span><span style=display:flex><span>              test<span style=color:#f92672>)</span>. This option should be combined with -U so that a successful registration will be tested with a test message to the
</span></span><span style=display:flex><span>              user  and  replied  with  <span style=color:#ae81ff>200</span>  OK. But this option can also be used without the -U option.  Warning: using without -U can
</span></span><span style=display:flex><span>              cause unexpected behaivor.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -n, --numeric
</span></span><span style=display:flex><span>              Instead of the full qualified domain name in the Via line the IP of the local host will be used. This option is now on by
</span></span><span style=display:flex><span>              default.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -N, --nagios-code
</span></span><span style=display:flex><span>              Use  Nagios comliant <span style=color:#66d9ef>return</span> codes instead of the normal sipsak ones. This means sipsak will <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>if</span> everything was ok
</span></span><span style=display:flex><span>              and <span style=color:#ae81ff>2</span> in <span style=color:#66d9ef>case</span> of any error <span style=color:#f92672>(</span>local or remote<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -o, --sleep NUMBER
</span></span><span style=display:flex><span>              sipsak will sleep <span style=color:#66d9ef>for</span> NUMBER ms before it starts the next cycle in the usrloc mode. This will slow down  the  whole  test
</span></span><span style=display:flex><span>              process  to  be more realistic. Each cycle will be still completed as fast as possible, but the whole test will be slowed
</span></span><span style=display:flex><span>              down.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -O, --disposition STRING
</span></span><span style=display:flex><span>              The given STRING will be used as the content <span style=color:#66d9ef>for</span> the Content-Disposition header. Without this option  there  will  be  no
</span></span><span style=display:flex><span>              Content-Disposition header in the request.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -p, --outbound-proxy HOSTNAME<span style=color:#f92672>[</span>:PORT<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>              the address of the hostname is the target where the request will be sent to <span style=color:#f92672>(</span>outgoing proxy<span style=color:#f92672>)</span>. Use this <span style=color:#66d9ef>if</span> the destination
</span></span><span style=display:flex><span>              host is different <span style=color:#66d9ef>then</span> the host part of the request uri. The hostname is resolved via DNS SRV <span style=color:#66d9ef>if</span> supported <span style=color:#f92672>(</span>see  descrip‐
</span></span><span style=display:flex><span>              tion <span style=color:#66d9ef>for</span> SRV resolving<span style=color:#f92672>)</span> and no port is given.
</span></span><span style=display:flex><span>       -P, --processes NUMBER
</span></span><span style=display:flex><span>              Start  NUMBER  of  processes in parallel to <span style=color:#66d9ef>do</span> the send and reply checking. Only makes sense <span style=color:#66d9ef>if</span> a higher number <span style=color:#66d9ef>for</span> -e is
</span></span><span style=display:flex><span>              given in the usrloc, message or invite mode.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -q, --search REGEXP
</span></span><span style=display:flex><span>              match replies against REGEXP and <span style=color:#66d9ef>return</span> false <span style=color:#66d9ef>if</span> no match occurred. Useful <span style=color:#66d9ef>for</span> example to detect server  name  in  Server
</span></span><span style=display:flex><span>              header field.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -r, --remote-port PORT
</span></span><span style=display:flex><span>              Instead of the default sip port <span style=color:#ae81ff>5060</span> the PORT will be used. Alternatively the remote port can be given within the sip uri
</span></span><span style=display:flex><span>              of the -s parameter.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -R, --random-mode
</span></span><span style=display:flex><span>              This activates the randtrash mode. In this mode OPTIONS requests will be send to server with increasing numbers  of  ran‐
</span></span><span style=display:flex><span>              domly  crashed  characters  within this request. The position within the request and the replacing character are randomly
</span></span><span style=display:flex><span>              chosen. Any other response than Bad request <span style=color:#f92672>(</span>4xx<span style=color:#f92672>)</span> will stop this mode. Also three unresponded sends will stop this  mode.
</span></span><span style=display:flex><span>              With the -t parameter the maximum of trashed characters can be given.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -s, --sip-uri SIPURI
</span></span><span style=display:flex><span>              This mandatory option sets the destination of the request. It depends on the mode <span style=color:#66d9ef>if</span> only the server name or also an user
</span></span><span style=display:flex><span>              name is mandatory. Example <span style=color:#66d9ef>for</span> a full SIPURI : sip:test@foo.bar:123 See the  note  in  the  description  part  about  SRV
</span></span><span style=display:flex><span>              lookups <span style=color:#66d9ef>for</span> details how the hostname of this URI is converted into an IP and port.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -S, --symmetric
</span></span><span style=display:flex><span>              With  this  option  sipsak will use only one port <span style=color:#66d9ef>for</span> sending and receiving messages. With this option the local port <span style=color:#66d9ef>for</span>
</span></span><span style=display:flex><span>              sending will be the value from the -l option. In the default mode sipsak sends from a random  port  and  listens  on  the
</span></span><span style=display:flex><span>              given port from the -l option.  Note: With this option sipsak will not be able to receive replies from servers with asym‐
</span></span><span style=display:flex><span>              metric signaling <span style=color:#f92672>(</span>and broken rport implementation<span style=color:#f92672>)</span> like the Cisco proxy. If you run sipsak as root and  with  raw  socket
</span></span><span style=display:flex><span>              support  <span style=color:#f92672>(</span>check  the output from the -V option<span style=color:#f92672>)</span> <span style=color:#66d9ef>then</span> this option is not required because in this <span style=color:#66d9ef>case</span> sipsak already uses
</span></span><span style=display:flex><span>              only one port <span style=color:#66d9ef>for</span> sending and receiving messages.
</span></span><span style=display:flex><span>     -t, --trash-chars NUMBER
</span></span><span style=display:flex><span>              This parameter specifies the maximum of trashed characters in the randtrash mode. If omitted NUMBER will be  set  to  the
</span></span><span style=display:flex><span>              length of the request.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -T, --traceroute-mode
</span></span><span style=display:flex><span>              This  activates the traceroute mode. This mode works like the well known traceroute<span style=color:#f92672>(</span>8<span style=color:#f92672>)</span> command expect that not the number
</span></span><span style=display:flex><span>              of network hops are counted rather the number of server on the way to the destination user. Also the round trip  time  of
</span></span><span style=display:flex><span>              each  request  is  printed out, but due to a limitation within the sip protocol the identity <span style=color:#f92672>(</span>IP or name<span style=color:#f92672>)</span> can only deter‐
</span></span><span style=display:flex><span>              mined and printed out <span style=color:#66d9ef>if</span> the response from the server contains a warning header field. In  this  mode  on  each  outgoing
</span></span><span style=display:flex><span>              request  the  value  of  the  Max-Forwards  header field is increased, starting with one. The maximum of the Max-Forwards
</span></span><span style=display:flex><span>              header will <span style=color:#ae81ff>255</span> <span style=color:#66d9ef>if</span> no other value is given by the -m parameter. Any other response than <span style=color:#ae81ff>483</span> or 1xx are treated as a final
</span></span><span style=display:flex><span>              response and will terminate this mode.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -u, --auth-username STRING
</span></span><span style=display:flex><span>              Use the given STRING as username value <span style=color:#66d9ef>for</span> the authentication <span style=color:#f92672>(</span>different account and authentication username<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -U, --usrloc-mode
</span></span><span style=display:flex><span>              This  activates  the  usrloc mode. Without the -I or the -M option, this only registers users at a registrar. With one of
</span></span><span style=display:flex><span>              the above options the previous registered user will also be probed ether with a simulated call flow <span style=color:#f92672>(</span>invite, 200, ack<span style=color:#f92672>)</span> or
</span></span><span style=display:flex><span>              with  an instant message <span style=color:#f92672>(</span>message, 200<span style=color:#f92672>)</span>. One password <span style=color:#66d9ef>for</span> all users accounts within the usrloc test can be given with the
</span></span><span style=display:flex><span>              -a option. An user name is mandatory <span style=color:#66d9ef>for</span> this mode in the -s parameter. The number starting from the -b parameter to  the
</span></span><span style=display:flex><span>              -e  parameter  is  appended the user name. If the -b and the -e parameter are omitted, only one runs with the given user‐
</span></span><span style=display:flex><span>              name, but without append number to the usernames is <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       -v, --verbose
</span></span><span style=display:flex><span>              This parameter increases the output verbosity. No -v means nearly no output except in traceroute and error messages.  The
</span></span><span style=display:flex><span>              maximum of three v<span style=color:#e6db74>&#39;s prints out the content of all packets received and sent.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       -V, --version
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Prints out the name and version number of sipsak and the options which were compiled into the binary.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       -w, --extract-ip
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Activates the extraction of the IP or hostname from the Warning header field.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       -W, --nagios-warn NUMBER
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Return Nagios warn exit code (1) if the number of retransmissions before success was above the given number.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       -x, --expires NUMBER
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Sets the value of the Expires header to the given number.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       -z, --remove-bindings
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Activates the randomly removing of old bindings in the usrloc mode. How many per cent of the bindings will be removed, is
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              determined by the USRLOC_REMOVE_PERCENT define within the code (set it before compilation).  Multiple removing  of  bind‐
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              ings is possible, and cannot be prevented.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       -Z, --timer-t1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              Sets the amount of milliseconds for the SIP timer T1. It determines the length of the gaps between two retransmissions of
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              a request on a unreliable transport. Default value is 500 if not changed via the configure option --enable-timeout.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>RETURN VALUES
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       The return value 0 means that a 200 was received. 1 means something else then 1xx or 2xx was received.  2 will  be  returned  on
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       local  errors  like  non  resolvable  names or wrong options combination. 3 will be returned on remote errors like socket errors
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       (e.g. icmp error), redirects without a contact header or simply no answer (timeout).
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       If the -N option was given the return code will be 2 in case of any (local or remote) error. 1 in case there have been  retrans‐
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       missions from sipsak to the server. And 0 if there was no error at all.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>CAUTION
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       Use sipsak responsibly. Running it in any of the stress modes puts substantial burden on network and server under test.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EXAMPLES
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       sipsak -vv -s sip:nobody@foo.bar
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              displays received replies.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       sipsak -T -s sip:nobody@foo.bar
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              traces SIP path to nobody.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       sipsak -U -C sip:me@home -x 3600 -a password -s sip:myself@company
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              inserts forwarding from work to home for one hour.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       sipsak -f bye.sip -g &#39;</span>!FTAG!345.af23!TTAG!1208.12!<span style=color:#960050;background-color:#1e0010>&#39;</span> -s sip:myproxy
</span></span><span style=display:flex><span>              reads the file bye.sip, replaces $FTAG$ with 345.af23 and $TTAG$ with 1208.12 and finally send this message to myproxy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LIMITATIONS / NOT IMPLEMENTED
</span></span><span style=display:flex><span>       Many  servers  may  decide NOT to include SIP <span style=color:#e6db74>&#34;Warning&#34;</span> header fields.  Unfortunately, this makes displaying IP addresses of SIP
</span></span><span style=display:flex><span>       servers in traceroute mode impossible.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       IPv6 is not supported.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       Missing support <span style=color:#66d9ef>for</span> the Record-Route and Route header.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BUGS
</span></span><span style=display:flex><span>       sipsak is only tested against the SIP Express Router <span style=color:#f92672>(</span>ser<span style=color:#f92672>)</span> though their could be various bugs. Please feel free to mail them  to
</span></span><span style=display:flex><span>       the author.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AUTHOR
</span></span><span style=display:flex><span>       Nils Ohlmeier &lt;nils at sipsak dot org&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SEE ALSO
</span></span><span style=display:flex><span>       traceroute<span style=color:#f92672>(</span>8<span style=color:#f92672>)</span>
</span></span></code></pre></div></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://wdd.js.org>洞香春</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>