<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | 洞香春</title><meta name=keywords content><meta name=description content="Posts - 洞香春"><meta name=author content="王端端"><link rel=canonical href=https://wdd.js.org/posts/><meta name=google-site-verification content="G-SGW660ZWKM"><link crossorigin=anonymous href=/assets/css/stylesheet.min.6aef73bcd11b501f30d40511dda695ff4635a6911499b91e84cfbca3c398c0e8.css integrity="sha256-au9zvNEbUB8w1AUR3aaV/0Y1ppEUmbkehM+8o8OYwOg=" rel="preload stylesheet" as=style><link crossorigin=anonymous herf=/font-awesome/css/font-awesome.min.css rel=stylesheet type=text/css><link rel=preload href=/logo.ico as=image><link rel=icon href=https://wdd.js.org/logo.ico><link rel=icon type=image/png sizes=16x16 href=https://wdd.js.org/logo.ico><link rel=icon type=image/png sizes=32x32 href=https://wdd.js.org/logo.ico><link rel=apple-touch-icon href=https://wdd.js.org/logo.ico><link rel=mask-icon href=https://wdd.js.org/logo.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><link rel=alternate type=application/rss+xml href=https://wdd.js.org/posts/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-SGW660ZWKM"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SGW660ZWKM",{anonymize_ip:!1})}</script><meta property="og:title" content="Posts"><meta property="og:description" content="端端的个人博客"><meta property="og:type" content="website"><meta property="og:url" content="https://wdd.js.org/posts/"><meta property="og:image" content="https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="洞香春"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Posts"><meta name=twitter:description content="端端的个人博客"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://wdd.js.org/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wdd.js.org accesskey=h title="洞香春 (Alt + H)"><img src=/logo.ico alt=logo aria-label=logo height=35>洞香春</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://wdd.js.org/freeswitch/ title=FreeSWITCH><span>FreeSWITCH</span></a></li><li><a href=https://wdd.js.org/golang/ title=Golang><span>Golang</span></a></li><li><a href=https://wdd.js.org/network/ title=Network><span>Network</span></a></li><li><a href=https://wdd.js.org/opensips/ title=OpenSIPS><span>OpenSIPS</span></a></li><li><a href=https://wdd.js.org/shell/ title=Shell><span>Shell</span></a></li><li><a href=https://wdd.js.org/vim/ title=VIM><span>VIM</span></a></li><li><a href=https://wdd.js.org/categories/ title=分类><span>分类</span></a></li><li><a href=https://wdd.js.org/search/ title=搜索><span>搜索</span></a></li><li><a href=https://wdd.js.org/tags/ title=标签><span>标签</span></a></li><li><a href=https://wdd.js.org/archives/ title=归档><span>归档</span></a></li><li><a href=https://wdd.js.org/about/ title=我><span>我</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://wdd.js.org>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2>15行代码为segmentfault增加头条文章排序功能</h2></header><section class=entry-content><p>有个需求，想看点赞最多的头条，但是页面没有这种按钮。怎么办？自己写吧。
先看效果 再看代码
var rows = $('.news__item').each(function(){ var key = +$(this).find('.news__item-zan-number').text(); $(this).data('key', key); }).get(); rows.sort(function(a,b){ var keyA = $(a).data('key'); var keyB = $(b).data('key'); if(keyA&lt;keyB){return -1;} else{return 1;} }); $.each(rows, function(index, row){ $('.news__list').prepend(row); });</p></section><footer class=entry-footer><span title='2018-02-07 14:00:46 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 15行代码为segmentfault增加头条文章排序功能" href=https://wdd.js.org/posts/2018/sort-for-sf/></a></article><article class=post-entry><header class=entry-header><h2>可视化交互阅读JS源代码</h2></header><section class=entry-content><p>1. 曾经，你可以能习惯这样阅读javascript 2. 现在，你可以用这个姿势阅读 3. 怎么做呢? 3.1. step1: npm install -g lambda-view 3.2. step2: // 阅读本地代码 lv targer.js // 阅读远程代码 lv https://code.jquery.com/jquery-3.1.1.js // 阅读多个代码 lv file1.js file2.js file3.js // 阅读所有 lv *.js 4. 项目地址：https://github.com/Jianru-Lin/lambda-view 5. 欢迎试玩！</p></section><footer class=entry-footer><span title='2018-02-07 13:57:25 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 可视化交互阅读JS源代码" href=https://wdd.js.org/posts/2018/visual-reading-js-code/></a></article><article class=post-entry><header class=entry-header><h2>谷歌浏览器： Snippets小程序哪家强？</h2></header><section class=entry-content><p>Snippets是可以在Chrome DevTools的“源”面板中创建和执行的小脚本。 您可以从任何页面访问和运行它们。 当您运行代码段时，它会从当前打开的页面的上下文执行。
1. 显示所有元素的边框，看页面布局非常方便 [].forEach.call($$("*"),function(a){ a.style.outline="1px solid #"+(~~(Math.random()*(1&lt;&lt;24))).toString(16) }); 2. allcolors.js 从页面上的元素中使用的计算样式打印所有颜色。 使用样式化的console.log调用来可视化每种颜色。
// allcolors.js // https://github.com/bgrins/devtools-snippets // Print out CSS colors used in elements on the page. (function () { // Should include colors from elements that have a border color but have a zero width? var includeBorderColorsWithZeroWidth = false; var allColors = {}; var props = ["background-color", "color", "border-top-color", "border-right-color", "border-bottom-color", "border-left-color"]; var skipColors = { "rgb(0, 0, 0)": 1, "rgba(0, 0, 0, 0)": 1, "rgb(255, 255, 255)": 1 }; []....</p></section><footer class=entry-footer><span title='2018-02-07 13:48:55 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 谷歌浏览器： Snippets小程序哪家强？" href=https://wdd.js.org/posts/2018/chrome-snippets-collect/></a></article><article class=post-entry><header class=entry-header><h2>nodejs 日志插件比较 VS 自定义日志插件</h2></header><section class=entry-content><p>1. morgan 【优点】morgan配置非常简单 【优点】支持自定义日志格式 【优点】支持日志分机 【优点】支持日志压缩：使用rotating-file-stream 【缺点】无法同时往console和文件中写日志 2. log4js-node 【优点】配置简单 【优点】支持同时往控制台和文件中写数据 【优点】支持按照时间或文件大小分割文件 【优点】支持文件压缩 "use strict"; var path = require('path') , log4js = require('../lib/log4js'); log4js.configure( { appenders: [ { type: "file", filename: "important-things.log", maxLogSize: 10*1024*1024, // = 10Mb numBackups: 5, // keep five backup files compress: true, // compress the backups encoding: 'utf-8', mode: parseInt('0640', 8), flags: 'w+' }, { type: "dateFile", filename: "more-important-things.log", pattern: "yyyy-MM-dd-hh", compress: true }, { type: "stdout" } ] } ); var logger = log4js....</p></section><footer class=entry-footer><span title='2018-02-07 13:46:51 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to nodejs 日志插件比较 VS 自定义日志插件" href=https://wdd.js.org/posts/2018/nodejs-log-packages/></a></article><article class=post-entry><header class=entry-header><h2>JavaScript 高级技巧</h2></header><section class=entry-content><p>0.1. 安全类型检测 javascript内置类型检测并不可靠 safari某些版本（&lt;4）typeof正则表达式返回为function 建议使用Object.prototype.toString.call()方法检测数据类型
function isArray(value){ return Object.prototype.toString.call(value) === "[object Array]"; } function isFunction(value){ return Object.prototype.toString.call(value) === "[object Function]"; } function isRegExp(value){ return Object.prototype.toString.call(value) === "[object RegExp]"; } function isNativeJSON(){ return window.JSON && Object.prototype.toString.call(JSON) === "[object JSON]"; } 对于ie中一COM对象形式实现的任何函数，isFunction都返回false，因为他们并非原生的javascript函数。
在web开发中，能够区分原生与非原生的对象非常重要。只有这样才能确切知道某个对象是否有哪些功能
以上所有的正确性的前提是：Object.prototype.toString没有被修改过
0.2. 作用域安全的构造函数 function Person(name){ this.name = name; } //使用new来创建一个对象 var one = new Person('wdd'); //直接调用构造函数 Person(); 由于this是运行时分配的，如果你使用new来操作，this指向的就是one。如果直接调用构造函数，那么this会指向全局对象window,然后你的代码就会覆盖window的原生name。如果有其他地方使用过window.name, 那么你的函数将会埋下一个深藏的bug。
==那么，如何才能创建一个作用域安全的构造函数？== 方法1
function Person(name){ if(this instanceof Person){ this.name = name; } else{ return new Person(name); } } 1....</p></section><footer class=entry-footer><span title='2018-02-07 10:14:56 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to JavaScript 高级技巧" href=https://wdd.js.org/posts/2018/js-high-skills/></a></article><article class=post-entry><header class=entry-header><h2>从一个小场景学会使用 apply方法</h2></header><section class=entry-content><p>1. 需求 需要自定义一个log方法，这个方法可以像原生的console.log一样 在开发环境我希望调用这个log会输出日志信息，生产环境我希望即使调用了这个方法，也不会输出日志信息。 2. 实现这个log 可能要使用apply或者call方法 log的参数个数和类型都是不固定的 call的参数个数是固定的，要排除它 apply的参数是需要一个数组，这个合适，可以使用arguments来当做数组传递 3. 代码 var MyLog = { silent: false, log: function(){ if(!this.silent){ console.log.apply(this, arguments); } } }; 4. 试用 > MyLog.log(1,2,3, '4545'); 1 2 3 "4545" undefined > MyLog.silent = true true > MyLog.log(1,2,3, '4545'); undefined 5. 后记 不要随处使用console.log，因为这样当你不需要日志输出的时候，你就要到处填坑了 不要使用alert，这个很烦人</p></section><footer class=entry-footer><span title='2018-02-07 10:12:36 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 从一个小场景学会使用 apply方法" href=https://wdd.js.org/posts/2018/how-to-use-apply/></a></article><article class=post-entry><header class=entry-header><h2>突然觉得自己好像没学过JS</h2></header><section class=entry-content><p>0.1. 先看题：mean的值是什么？ var scores = [10,11,12]; var total = 0; for(var score in scores){ total += score; } var mean = total/scores.length; console.log(mean); 0.2. 是11？ 恭喜你：答错了！
0.3. 是1？ 恭喜你：答错了！
0.4. 正确答案： 4 解释： for in 循环循环的值永远是key, key是一个字符串。所以total的值是：‘0012’。它是一个字符串，字符串'0012’/3,0012会被转换成12，然后除以3，结果是4。
0.5. 后记 这个示例是来自《编写高质量JavaScript的68个方法》的第49条：数组迭代要优先使用for循环而不是for in循环。 既然已经发布，就可能有好事者拿出去当面试题。这个题目很有可能坑一堆人。其中包括我。
这里涉及到许多js的基础知识.
for in 循环是循环对象的索引属性，key是一个字符串。 数值类型和字符串相加，会自动转换为字符串 字符串除以数值类型，会先把字符串转为数值，最终结果为数值 正确方法
var scores = [10,11,12]; var total = 0; for(var i=0, n=scores.length; i &lt; n; i++){ total += scores[i]; } var mean = total/scores....</p></section><footer class=entry-footer><span title='2018-02-07 10:09:42 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 突然觉得自己好像没学过JS" href=https://wdd.js.org/posts/2018/i-realy-dont-know-js/></a></article><article class=post-entry><header class=entry-header><h2>Vue+websocket+stompjs 实时监控坐席状态demo</h2></header><section class=entry-content><p>由于是前后端分离的demo, 程序的后端我不管，我只负责把前端做好，这只是个demo， 还有很多不完善的地方。
2018-01-09新增： 后端的MQ事件结构现在也改了，该demo只能看看了。
html
&lt;!DOCTYPE html> &lt;html lang="zh-cn"> &lt;head> &lt;meta charset="utf-8"> &lt;link href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet"> &lt;/head> &lt;body> &lt;table class="table" id="event-queue"> &lt;thead> &lt;tr> &lt;th>当前状态&lt;/th> &lt;th>状态改变时间&lt;/th> &lt;th>姓名&lt;/th> &lt;th>工号&lt;/th> &lt;th>分机号&lt;/th> &lt;th>对方号码&lt;/th> &lt;th>呼入数&lt;/th> &lt;th>呼出数&lt;/th> &lt;/tr> &lt;/thead> &lt;tbody> &lt;tr v-for="item in eventQueue"> &lt;td>{{item.agentStatus | transAgentStatus}}&lt;/td> &lt;td>{{item.agentStatusTime}}&lt;/td> &lt;td>{{item.userName}}&lt;/td> &lt;td>{{item.loginName}}&lt;/td> &lt;td>{{item.deviceId}}&lt;/td> &lt;td>&lt;/td> &lt;td>&lt;/td> &lt;td>&lt;/td> &lt;/tr> &lt;/tbody> &lt;/table> &lt;script src="http://cdn.bootcss.com/vue/1.0.26/vue.js">&lt;/script> &lt;script src="js/websocket-suport.min.js">&lt;/script> &lt;script src="js/main.js">&lt;/script> &lt;/body> &lt;/html> js
var tm = (function(){ var App = function(){}; var app = App....</p></section><footer class=entry-footer><span title='2018-02-07 09:36:49 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to Vue+websocket+stompjs 实时监控坐席状态demo" href=https://wdd.js.org/posts/2018/vue-ws-monitor-agent-status/></a></article><article class=post-entry><header class=entry-header><h2>自从装了windows神器，再也不用羡慕mac了</h2></header><section class=entry-content><p>1. 命令行神器 1.1. GOW Gow（Gnu On Windows）是Cygwin的轻量级替代品。 它使用一个方便的NSIS安装程序，安装超过100个非常有用的开源UNIX应用程序，编译为本机win32二进制文件。 它被设计为尽可能小，大约18 MB，而不是Cygwin，它可以运行超过100 MB根据选项。
1.2. 强烈推荐 ConEmu 非常强大，可以在里面愉快的ctrl+v,ctrl+c 用过你才知道好用 https://conemu.github.io/
2. 搜索神器 2.1. Wox Windows下一款最接近 Alfred 的软件启动/文件搜索利器
2.2. Everything 快速批量查找文件的利器
3. 包管理神器 4. Chocolatey 安装软件再也不用烦恼 教程
5. 健康管理神器 6. f.lux 有没有注意到人们在夜间发短信的怪异蓝色发光？或者醒来准备写下一个伟大的想法，并被你的电脑屏幕蒙蔽？白天，电脑屏幕看起来很好，他们的设计看起来像太阳。但是，在晚上9点，晚上10点或凌晨3点，你可能不应该看太阳。f.lux修复这个：它使你的电脑显示器的颜色适应一天的时间，在夜间温暖和白天喜欢阳光。甚至有可能你因为你的电脑而停滞太晚。你可以使用f.lux因为它使你睡得更好，或者你可以只使用它，只是因为它使你的电脑看起来更好。
7. 谷歌浏览器插件神器 7.1. 强烈推荐vimium 速度起飞，只用键盘就可以完全操纵谷歌浏览器
7.2. shortKeys vimium的快捷键其实已经足够多了，但是如果你想有更多自定义的快捷键，例如：关闭右侧的标签页，这个快捷键。你可以试试shortKeys。唯一遗憾的是，这里面也没有关闭其他标签页的快捷键，如果你知道有哪些工具可以做到，麻烦请告诉我。
7.3. infinity新标签页 8. 参考 http://www.jeffjade.com/2016/01/13/2016-01-13-windows-software-cmder/ http://www.jeffjade.com/2015/10/19/2015-10-18-Efficacious-win-software/ https://www.zhihu.com/question/22919326 https://blogs.msdn.microsoft.com/scott_hanselman/2013/07/31/windows/</p></section><footer class=entry-footer><span title='2018-02-07 09:24:18 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 自从装了windows神器，再也不用羡慕mac了" href=https://wdd.js.org/posts/2018/windows-powerful-tools/></a></article><article class=post-entry><header class=entry-header><h2>发起Ajax请求当页面onunload</h2></header><section class=entry-content><p>0.1. 同步Ajax 这种需求主要用于当浏览器关闭，或者刷新时，向后端发起Ajax请求。
window.onunload = function(){ $.ajax({url:"http://localhost:8888/test.php?", async:false}); }; 使用async：false参数使请求同步（默认是异步的）。
同步请求锁定浏览器，直到完成。 如果请求是异步的，页面只是继续卸载。 它足够快，以至于该请求甚至没有时间触发。服务端很可能收不到请求。
0.2. navigator.sendBeacon 优点：简洁、异步、非阻塞 缺点：这是实验性的技术，并非所有浏览器都支持。其中IE和safari不支持该技术。
示例：
window.addEventListener('unload', logData, false); function logData() { navigator.sendBeacon("/log", analyticsData); } 参考：http://stackoverflow.com/questions/1821625/ajax-request-with-jquery-on-page-unload 参考：https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon</p></section><footer class=entry-footer><span title='2018-02-07 09:18:54 +0000 UTC'>2018-02-07</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;王端端</footer><a class=entry-link aria-label="post link to 发起Ajax请求当页面onunload" href=https://wdd.js.org/posts/2018/send-ajax-when-page-unload/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://wdd.js.org/posts/page/11/>« Prev Page</a>
<a class=next href=https://wdd.js.org/posts/page/13/>Next Page »</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href=https://wdd.js.org>洞香春</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>