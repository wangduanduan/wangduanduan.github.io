<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>1.1 脚本结构 - 全局参数、模块配置、路由 | 洞香春</title><meta name=keywords content="all"><meta name=description content="1. Structure
The structure of the kamailio.cfg can be seen as three parts:

global parameters
modules settings
routing blocks

For clarity and making it easy to maintain, it is recommended to keep
them in this order, although some of them can be mixed.

✅ 这三个部分可以混合，但为了清晰和维护的方便，建议按照这个顺序排列。
2. Global Parameters Section
This is the first part of the configuration file, containing the
parameters for the core of kamailio and custom global parameters."><meta name=author content="Eddie Wang"><link rel=canonical href=https://wdd.js.org/kamailio/56/structure/><link crossorigin=anonymous href=/assets/css/stylesheet.a2acda249b8eac62938bb2d2f1c562c5f74d5728640d2a1a7d6aeaec5c50ef24.css integrity="sha256-oqzaJJuOrGKTi7LS8cVixfdNVyhkDSoafWrq7FxQ7yQ=" rel="preload stylesheet" as=style><link rel=icon href=https://wdd.js.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wdd.js.org/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://wdd.js.org/favicon.ico><link rel=apple-touch-icon href=https://wdd.js.org/favicon.ico><link rel=mask-icon href=https://wdd.js.org/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wdd.js.org/kamailio/56/structure/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css><style>body{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,noto sans,sans-serif,apple color emoji,segoe ui emoji;font-size:16px;line-height:1.6;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1,h2,h3,h4,h5,h6{font-weight:600;letter-spacing:-.02em}code,pre{font-family:fira code,jetbrains mono,Consolas,monospace;font-variant-ligatures:normal;font-size:.95em}</style><meta property="og:url" content="https://wdd.js.org/kamailio/56/structure/"><meta property="og:site_name" content="洞香春"><meta property="og:title" content="1.1 脚本结构 - 全局参数、模块配置、路由"><meta property="og:description" content="1. Structure The structure of the kamailio.cfg can be seen as three parts:
global parameters modules settings routing blocks For clarity and making it easy to maintain, it is recommended to keep them in this order, although some of them can be mixed.
✅ 这三个部分可以混合，但为了清晰和维护的方便，建议按照这个顺序排列。
2. Global Parameters Section This is the first part of the configuration file, containing the parameters for the core of kamailio and custom global parameters."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="kamailio"><meta property="article:tag" content="All"><meta name=twitter:card content="summary"><meta name=twitter:title content="1.1 脚本结构 - 全局参数、模块配置、路由"><meta name=twitter:description content="1. Structure
The structure of the kamailio.cfg can be seen as three parts:

global parameters
modules settings
routing blocks

For clarity and making it easy to maintain, it is recommended to keep
them in this order, although some of them can be mixed.

✅ 这三个部分可以混合，但为了清晰和维护的方便，建议按照这个顺序排列。
2. Global Parameters Section
This is the first part of the configuration file, containing the
parameters for the core of kamailio and custom global parameters."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"新朋友 - kamailio学习笔记","item":"https://wdd.js.org/kamailio/"},{"@type":"ListItem","position":2,"name":"Kamailio 5.6 Wiki","item":"https://wdd.js.org/kamailio/56/"},{"@type":"ListItem","position":3,"name":"1.1 脚本结构 - 全局参数、模块配置、路由","item":"https://wdd.js.org/kamailio/56/structure/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"1.1 脚本结构 - 全局参数、模块配置、路由","name":"1.1 脚本结构 - 全局参数、模块配置、路由","description":"1. Structure The structure of the kamailio.cfg can be seen as three parts:\nglobal parameters modules settings routing blocks For clarity and making it easy to maintain, it is recommended to keep them in this order, although some of them can be mixed.\n✅ 这三个部分可以混合，但为了清晰和维护的方便，建议按照这个顺序排列。\n2. Global Parameters Section This is the first part of the configuration file, containing the parameters for the core of kamailio and custom global parameters.\n","keywords":["all"],"articleBody":"1. Structure The structure of the kamailio.cfg can be seen as three parts:\nglobal parameters modules settings routing blocks For clarity and making it easy to maintain, it is recommended to keep them in this order, although some of them can be mixed.\n✅ 这三个部分可以混合，但为了清晰和维护的方便，建议按照这个顺序排列。\n2. Global Parameters Section This is the first part of the configuration file, containing the parameters for the core of kamailio and custom global parameters.\nTypically this is formed by directives of the form:\nname=value The name corresponds to a core parameter as listed in one of the next sections of this document. If a name is not matching a core parameter, then Kamailio will not start, rising an error during startup.\n✅ 无法识别的全局参数，将会导致kamailio无法启动。\nThe value is typically an integer, boolean or a string.\nSeveral parameters can get a complex value which is formed from a group of integer, strings or identifiers. For example, such parameter is listen, which can be assigned a value like proto:ipaddress:port.\nExample of content:\nlog_facility=LOG_LOCAL0 children=4 disable_tcp=yes alias=\"sip.mydomain.com\" listen=udp:10.0.0.10:5060 Usually setting a parameter is ended by end of line, but it can be also ended with ; (semicolon). This should be used when the grammar of a parameter allows values on multiple lines (like listen or alias) and the next line creates a conflict by being swallowed as part of value for previous parameter.\nalias=\"sip.mydomain.com\"; If you want to use a reserved config keyword as part of a parameter, you need to enclose it in quotes. See the example below for the keyword “dns”.\n✅ 如果要使用保留的配置关键字作为参数的一部分，需要用引号括起来。\nlisten=tcp:127.0.0.1:5060 advertise \"sip.dns.example.com\":5060 3. Modules Settings Section This is the second section of the configuration file, containing the directives to load modules and set their parameters.\nIt contains the directives loadmodule and modparam. In the default configuration file starts with the line setting the path to modules (the assignment to mpath core parameter.\nExample of content:\nloadmodule \"debugger.so\" ... modparam(\"debugger\", \"cfgtrace\", 1) 4. Routing Blocks Section This is the last section of the configuration file, typically the biggest one, containing the routing blocks with the routing logic for SIP traffic handled by Kamailio.\nThe only mandatory routing block is request_route, which contains the actions for deciding the routing for SIP requests.\nSee the chapter Routing Blocks in this document for more details about what types of routing blocks can be used in the configuration file and their role in routing SIP traffic and Kamailio behaviour.\nExample of content:\nrequest_route { # per request initial checks route(REQINIT); ... } branch_route[MANAGE_BRANCH] { xdbg(\"new branch [$T_branch_idx] to $ru\\n\"); route(NATMANAGE); } ","wordCount":"423","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Eddie Wang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wdd.js.org/kamailio/56/structure/"},"publisher":{"@type":"Organization","name":"洞香春","logo":{"@type":"ImageObject","url":"https://wdd.js.org/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wdd.js.org/ accesskey=h title="洞香春 (Alt + H)"><img src=https://wdd.js.org/favicon.ico alt aria-label=logo height=35>洞香春</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wdd.js.org/opensips/ title=OpenSIPS><span>OpenSIPS</span></a></li><li><a href=https://wdd.js.org/kamailio/ title=Kamailio><span>Kamailio</span></a></li><li><a href=https://wdd.js.org/freeswitch/ title=FreeSWITCH><span>FreeSWITCH</span></a></li><li><a href=https://wdd.js.org/books/ title=读书><span>读书</span></a></li><li><a href=https://wdd.js.org/vim/ title=VIM><span>VIM</span></a></li><li><a href=https://wdd.js.org/fe/ title=前端><span>前端</span></a></li><li><a href=https://wdd.js.org/search/ title=搜索><span>搜索</span></a></li><li><a href=https://wdd.js.org/tags/ title=标签><span>标签</span></a></li><li><a href=https://wdd.js.org/archives/ title=归档><span>归档</span></a></li><li><a href=https://wdd.js.org/about/ title=我><span>我</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wdd.js.org/>Home</a>&nbsp;»&nbsp;<a href=https://wdd.js.org/kamailio/>新朋友 - kamailio学习笔记</a>&nbsp;»&nbsp;<a href=https://wdd.js.org/kamailio/56/>Kamailio 5.6 Wiki</a></div><h1 class="post-title entry-hint-parent">1.1 脚本结构 - 全局参数、模块配置、路由</h1><div class=post-meta><span>2 min</span>&nbsp;·&nbsp;<span>Eddie Wang</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/%3cpath_to_repo%3e/content/kamailio/56/structure/index.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-structure aria-label="1. Structure">1. Structure</a></li><li><a href=#2-global-parameters-section aria-label="2. Global Parameters Section">2. Global Parameters Section</a></li><li><a href=#3-modules-settings-section aria-label="3. Modules Settings Section">3. Modules Settings Section</a></li><li><a href=#4-routing-blocks-section aria-label="4. Routing Blocks Section">4. Routing Blocks Section</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=1-structure>1. Structure<a hidden class=anchor aria-hidden=true href=#1-structure>#</a></h1><p>The structure of the kamailio.cfg can be seen as three parts:</p><ul><li>global parameters</li><li>modules settings</li><li>routing blocks</li></ul><p>For clarity and making it easy to maintain, it is recommended to keep
them in this order, although some of them can be mixed.</p><blockquote><p>✅ 这三个部分可以混合，但为了清晰和维护的方便，建议按照这个顺序排列。</p></blockquote><h1 id=2-global-parameters-section>2. Global Parameters Section<a hidden class=anchor aria-hidden=true href=#2-global-parameters-section>#</a></h1><p>This is the first part of the configuration file, containing the
parameters for the core of kamailio and custom global parameters.</p><p>Typically this is formed by directives of the form:</p><pre><code>name=value
</code></pre><p>The name corresponds to a core parameter as listed in one of the next
sections of this document. If a name is not matching a core parameter,
then Kamailio will not start, rising an error during startup.</p><blockquote><p>✅ 无法识别的全局参数，将会导致kamailio无法启动。</p></blockquote><p>The value is typically an integer, boolean or a string.</p><p>Several parameters can get a complex value which is formed from a group
of integer, strings or identifiers. For example, such parameter is
<strong>listen</strong>, which can be assigned a value like <strong>proto:ipaddress:port</strong>.</p><p>Example of content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>log_facility<span style=color:#f92672>=</span>LOG_LOCAL0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>children<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>disable_tcp<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alias<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sip.mydomain.com&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>listen<span style=color:#f92672>=</span>udp:<span style=color:#ae81ff>10.0.0.10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5060</span>
</span></span></code></pre></div><p>Usually setting a parameter is ended by end of line, but it can be also
ended with <strong>;</strong> (semicolon). This should be used when the grammar of a
parameter allows values on multiple lines (like <strong>listen</strong> or <strong>alias</strong>)
and the next line creates a conflict by being swallowed as part of value
for previous parameter.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>alias<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sip.mydomain.com&#34;</span>;
</span></span></code></pre></div><p>If you want to use a reserved config keyword as part of a parameter, you
need to enclose it in quotes. See the example below for the keyword
&ldquo;dns&rdquo;.</p><blockquote><p>✅ 如果要使用保留的配置关键字作为参数的一部分，需要用引号括起来。</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>listen<span style=color:#f92672>=</span>tcp:<span style=color:#ae81ff>127.0.0.1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5060</span> advertise <span style=color:#e6db74>&#34;sip.dns.example.com&#34;</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5060</span>
</span></span></code></pre></div><h1 id=3-modules-settings-section>3. Modules Settings Section<a hidden class=anchor aria-hidden=true href=#3-modules-settings-section>#</a></h1><p>This is the second section of the configuration file, containing the
directives to load modules and set their parameters.</p><p>It contains the directives <strong>loadmodule</strong> and <strong>modparam</strong>. In the
default configuration file starts with the line setting the path to
modules (the assignment to <strong>mpath</strong> core parameter.</p><p>Example of content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>loadmodule <span style=color:#e6db74>&#34;debugger.so&#34;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#a6e22e>modparam</span>(<span style=color:#e6db74>&#34;debugger&#34;</span>, <span style=color:#e6db74>&#34;cfgtrace&#34;</span>, <span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><h1 id=4-routing-blocks-section>4. Routing Blocks Section<a hidden class=anchor aria-hidden=true href=#4-routing-blocks-section>#</a></h1><p>This is the last section of the configuration file, typically the
biggest one, containing the routing blocks with the routing logic for
SIP traffic handled by Kamailio.</p><p>The only mandatory routing block is <strong>request_route</strong>, which contains
the actions for deciding the routing for SIP requests.</p><p>See the chapter <strong>Routing Blocks</strong> in this document for more details
about what types of routing blocks can be used in the configuration file
and their role in routing SIP traffic and Kamailio behaviour.</p><p>Example of content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>request_route {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># per request initial checks
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>route</span>(REQINIT);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>branch_route[MANAGE_BRANCH] {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xdbg</span>(<span style=color:#e6db74>&#34;new branch [$T_branch_idx] to $ru</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>route</span>(NATMANAGE);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://wdd.js.org/tags/all/>All</a></li></ul></footer><script src=https://giscus.app/client.js data-repo=wangduanduan/wangduanduan.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkxMTkyMjMyNjA=" data-category=Announcements data-category-id=DIC_kwDOBxsz3M4CAjBq data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://wdd.js.org/>洞香春</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>