<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Networks on 洞香春</title>
    <link>https://wdd.js.org/network/</link>
    <description>Recent content in Networks on 洞香春</description>
    <image>
      <title>洞香春</title>
      <url>https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://wdd.js.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- 0.143.1</generator>
    <language>en</language>
    <lastBuildDate>Wed, 01 Jan 2025 20:23:41 +0800</lastBuildDate>
    <atom:link href="https://wdd.js.org/network/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>RFC768 UDP包学习笔记</title>
      <link>https://wdd.js.org/network/rfc768-udp/</link>
      <pubDate>Wed, 01 Jan 2025 20:23:41 +0800</pubDate>
      <guid>https://wdd.js.org/network/rfc768-udp/</guid>
      <description>&lt;h1 id=&#34;包格式&#34;&gt;包格式&lt;/h1&gt;
&lt;p&gt;UDP包头工占用8个字节,  其中源端口和目标端口各占2个字节，长度占2个字节，校验和占2个字节。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;    0      7 8     15 16    23 24    31
   +--------+--------+--------+--------+
   |     Source      |   Destination   |
   |      Port       |      Port       |
   +--------+--------+--------+--------+
   |                 |                 |
   |     Length      |    Checksum     |
   +--------+--------+--------+--------+
   |
   |          data octets ...
   +---------------- ...

        User Datagram Header Format
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;字段&#34;&gt;字段&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;源端口&lt;/strong&gt;，可选字段，默认为0，如果是有意义的其他端口，表示后续响应可以送回到该端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目标端口&lt;/strong&gt;，必须字段，用来关联目标主机上进程监听的端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;长度&lt;/strong&gt;，长度是整个UDP包的长度，也就是包头 + 包的数据，包头固定8字节，那么length的最小长度就是8&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;校验和&lt;/strong&gt;，用来验证传输过程中是否发生了错误。校验和的计算结果与源IP、目标IP、UDP的包长有关。 如果校验和失败，那么消息会被丢弃。 有些校验和计算的工作会被放置在网卡上，从而减少CPU的负载。当然如果在网卡上因为校验和的问题被网卡丢弃，上层应用是收不到不到UDP包的。但是用tcpdump可以抓到这种校验和有问题的包。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;思考1： 为什么源端口可以设置为0？&lt;/p&gt;
&lt;p&gt;答：有些UDP包，是不需要响应的，只需要发送出消息。&lt;/p&gt;&lt;/blockquote&gt;
&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc768&#34;&gt;https://datatracker.ietf.org/doc/html/rfc768&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://wdd.js.org/opensips/ch7/big-udp-msg/&#34;&gt;https://wdd.js.org/opensips/ch7/big-udp-msg/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://wdd.js.org/network/udp-checksum-offload/&#34;&gt;https://wdd.js.org/network/udp-checksum-offload/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    <item>
      <title>Wireshark抓包教程</title>
      <link>https://wdd.js.org/network/wireshark/</link>
      <pubDate>Tue, 25 Oct 2022 09:12:00 +0800</pubDate>
      <guid>https://wdd.js.org/network/wireshark/</guid>
      <description>&lt;h1 id=&#34;1-http抓包例子&#34;&gt;1. HTTP抓包例子&lt;/h1&gt;
&lt;p&gt;案例：本地向 http://192.168.40.134:31204/some-api，如何过滤？&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;http and ip.addr &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; 192.168.40.134 and tcp.port &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;31204&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;语句分析：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http 表示我只需要http的包&lt;/li&gt;
&lt;li&gt;ip.addr 表示只要源ip或者目标ip地址中包含192.168.40.134&lt;/li&gt;
&lt;li&gt;tcp.port 表示只要源端口或者目标端口中包含31204&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-14-12.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;2-为什么我写的表达式总是不对呢&#34;&gt;2. 为什么我写的表达式总是不对呢？😂&lt;/h1&gt;
&lt;p&gt;很多时候，你写的表达式背景色变成红色，说明表达式错误了，例如下图：&lt;code&gt;http and ip.port == 31204&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-14-37.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;写出&lt;strong&gt;ip.port这个语句，往往是对传输协议理解不清晰。😅&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ip是网络层的协议，port是传输层tcp或者udp中使用的。例如你写tcp.port == 80，udp.port ==3000这样是没问题的。但是port不能跟在ip的后面，如果你不清楚怎么写，你可以选择wireshark的智能提示。&lt;/p&gt;
&lt;p&gt;智能提示会提示所有可用的表达式。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-14-56.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;3-常用过滤表达式&#34;&gt;3. 常用过滤表达式&lt;/h1&gt;
&lt;p&gt;一般我们的过滤都是基于协议，ip地址或者端口号进行过滤的，&lt;/p&gt;
&lt;h2 id=&#34;31-基于协议的过滤&#34;&gt;3.1. 基于协议的过滤&lt;/h2&gt;
&lt;p&gt;直接输入协议名进行过滤&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-15-10.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;32-基于ip地址的过滤&#34;&gt;3.2. 基于IP地址的过滤&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-15-28.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;33-基于端口的过滤&#34;&gt;3.3. 基于端口的过滤&lt;/h2&gt;
&lt;p&gt;基于端口的过滤一般就两种&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;tcp.port == xxx&lt;/li&gt;
&lt;li&gt;udp.port == xxx&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-15-41.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;34-基于host的过滤&#34;&gt;3.4. 基于host的过滤&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/wireshark/2022-10-25-09-15-53.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;4-比较运算符支持&#34;&gt;4. 比较运算符支持&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;== 等于
!= 不等于
&amp;gt; 大于
&amp;lt; 小于
&amp;gt;= 大于等于
&amp;lt;= 小于等于
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ip.addr &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; 192.168.2.4
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;5-逻辑运算符&#34;&gt;5. 逻辑运算符&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;and 条件与&lt;/li&gt;
&lt;li&gt;or 条件或&lt;/li&gt;
&lt;li&gt;xor 仅能有一个条件为真&lt;/li&gt;
&lt;li&gt;not 所有条件都不能为真&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ip.addr &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; 192.168.2.4 and tcp.port &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2145&lt;/span&gt; and !tcp.port &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3389&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;6-只关心某些特殊的tcp包&#34;&gt;6. 只关心某些特殊的tcp包&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcp.flags.fin&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  只过滤关闭连接的包
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcp.flags.syn&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;1	只过滤建立连接的包
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcp.flags.reset&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; 只过滤出tcp连接重置的包
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;7-统计模块&#34;&gt;7. 统计模块&lt;/h1&gt;
&lt;h2 id=&#34;71-查看有哪些ip&#34;&gt;7.1. 查看有哪些IP&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Statistics -&amp;gt; endpoints&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Tcpdump抓包教程</title>
      <link>https://wdd.js.org/network/tcpdump/</link>
      <pubDate>Tue, 25 Oct 2022 09:09:05 +0800</pubDate>
      <guid>https://wdd.js.org/network/tcpdump/</guid>
      <description>&lt;h1 id=&#34;查看帮助文档&#34;&gt;查看帮助文档&lt;/h1&gt;
&lt;p&gt;从帮助文档可以看出，包过滤的表达式一定要放在最后一个参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       tcpdump &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -AbdDefhHIJKlLnNOpqStuUvxX# &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -B buffer_size &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -c count &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --count &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -C file_size &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -E spi@ipaddr algo:secret,...  &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -F file &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -G rotate_seconds &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -i interface &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --immediate-mode &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -j tstamp_type &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -m module &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -M secret &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --number &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --print &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -Q in|out|inout &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -r file &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -s snaplen &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -T type &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --version &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -V file &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -w file &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -W filecount &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -y datalinktype &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -z postrotate-command &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -Z user &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --time-stamp-precision&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tstamp_precision &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --micro &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; --nano &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; expression &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;列出所有网卡&#34;&gt;列出所有网卡&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -D
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1.enp89s0 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Up, Running, Connected&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2.docker0 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Up, Running, Connected&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3.vetha051ecc &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Up, Running, Connected&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4.vethe67e03a &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Up, Running, Connected&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;5.vethc58c174 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Up, Running, Connected&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;指定网卡--i&#34;&gt;指定网卡 -i&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -i eth0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;所有网卡&#34;&gt;所有网卡&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -i any
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;不要域名解析&#34;&gt;不要域名解析&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -n -i any
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;指定主机&#34;&gt;指定主机&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdoump host 192.168.0.1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;指定源ip或者目标ip&#34;&gt;指定源IP或者目标IP&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# 根据源IP过滤
tcpdump src 192.168.3.2

# 根据目标IP过滤
tcpdump dst 192.168.3.2
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;指定协议过滤&#34;&gt;指定协议过滤&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump tcp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;指定端口&#34;&gt;指定端口&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 根据某个端口过滤&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdomp port &lt;span style=&#34;color:#ae81ff&#34;&gt;33&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 根据源端口或者目标端口过滤&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump dst port &lt;span style=&#34;color:#ae81ff&#34;&gt;33&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump src port &lt;span style=&#34;color:#ae81ff&#34;&gt;33&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 根据端口范围过滤&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump portrange 30-90
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;根据ip和地址&#34;&gt;根据IP和地址&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -i ens33 tcp and host 192.168.40.30
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;抓包结果写文件&#34;&gt;抓包结果写文件&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -i ens33 tcp and host 192.168.40.30 -w log.pcap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;每隔30秒写一个文件&#34;&gt;每隔30秒写一个文件&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-G 30&lt;/code&gt; 表示每隔30秒写一个文件&lt;/li&gt;
&lt;li&gt;文件名中的%实际上是时间格式&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -i ens33 -G &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt; tcp and host 192.168.40.30 -w %Y_%m%d_%H%M_%S.log.pcap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;每达到30mb产生一个文件&#34;&gt;每达到30MB产生一个文件&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-C 30&lt;/code&gt; 每达到30MB产生一个文件&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump -i ens33 -C &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt; tcp and host 192.168.40.30 -w log.pcap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;指定抓包的个数&#34;&gt;指定抓包的个数&lt;/h1&gt;
&lt;p&gt;在流量很大的网络上抓包，如果写文件的话，很可能将磁盘写满。所以最好指定一个最大的抓包个数，在达到包的个数后，自动退出。&lt;/p&gt;</description>
    </item>
    <item>
      <title>http抓包工具httpry使用</title>
      <link>https://wdd.js.org/network/httpry/</link>
      <pubDate>Tue, 25 Oct 2022 09:07:04 +0800</pubDate>
      <guid>https://wdd.js.org/network/httpry/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;git clone https://gitee.com/nuannuande/httpry.git
cd httpry
yum install libpcap-devel -y
make
make install
cp -f httpry /usr/sbin/
httpry -i eth0
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>Tshark入门到精通</title>
      <link>https://wdd.js.org/network/tshark/</link>
      <pubDate>Thu, 30 Jun 2022 00:00:00 +0800</pubDate>
      <guid>https://wdd.js.org/network/tshark/</guid>
      <description>&lt;h1 id=&#34;1-使用摘要&#34;&gt;1. 使用摘要&lt;/h1&gt;
&lt;p&gt;一个命令的使用摘要非常重要，摘要里包含了这个工具最常用的用法。&lt;/p&gt;
&lt;p&gt;要注意的是，如果要用过滤器，一定要放到最后。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tshark [ -i &amp;lt;capture interface&amp;gt;|- ] [ -f &amp;lt;capture filter&amp;gt; ] [ -2 ] [ -r &amp;lt;infile&amp;gt; ] [ -w &amp;lt;outfile&amp;gt;|- ] [ options ] [ &amp;lt;filter&amp;gt; ]

tshark -G [ &amp;lt;report type&amp;gt; ] [ --elastic-mapping-filter &amp;lt;protocols&amp;gt; ]
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;2-为什么要学习tshark&#34;&gt;2. 为什么要学习tshark?&lt;/h1&gt;
&lt;p&gt;一般情况下，我们可能会在服务端用tcpdump抓包，然后把包拿下来，用wireshark分析。那么我们为什么要学习tshark呢？&lt;/p&gt;
&lt;p&gt;相比于wireshark， tshark有以下的优点&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;速度飞快：wireshark在加载包的时候，tshark可能已经给出了结果。&lt;/li&gt;
&lt;li&gt;更稳定：wireshark在处理包的时候，常常容易崩溃&lt;/li&gt;
&lt;li&gt;更适合做文本处理：tshark的输出是文本，这个文本很容易被awk, sort, uniq等等命令处理&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;但是我不建议上来就学习，更建议在熟悉wireshark之后，再去进一步学习tshark&lt;/p&gt;
&lt;h1 id=&#34;3-使用场景&#34;&gt;3. 使用场景&lt;/h1&gt;
&lt;h2 id=&#34;31-基本场景&#34;&gt;3.1 基本场景&lt;/h2&gt;
&lt;p&gt;用wireshark最基本的场景的把pcap文件拖动到wireshark中，然后可能加入一些过滤条件。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tshark -r demo.pcap
tshark -r demo.pcap -c 1 # 只读一个包就停止
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;输出的列分别为：序号，相对时间，绝对时间，源ip, 源端口，目标ip, 目标端口&lt;/p&gt;
&lt;h2 id=&#34;32-按照表格输出&#34;&gt;3.2 按照表格输出&lt;/h2&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tshark -r demo.pcap -T tabs
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;33-按照指定的列输出&#34;&gt;3.3 按照指定的列输出&lt;/h2&gt;
&lt;p&gt;例如，抓的的sip的包，我们只想输出sip的user-agent字段。&lt;/p&gt;</description>
    </item>
    <item>
      <title>Udp Checksum Offload</title>
      <link>https://wdd.js.org/network/udp-checksum-offload/</link>
      <pubDate>Thu, 30 Jun 2022 00:00:00 +0800</pubDate>
      <guid>https://wdd.js.org/network/udp-checksum-offload/</guid>
      <description>&lt;p&gt;在服务端抓包，然后在wireshark上分析，发现wireshark提示：udp checksum字段有问题&lt;/p&gt;
&lt;p&gt;checksum 0x&amp;hellip; incrorect should be 0x.. (maybe caused by udp checksum offload)&lt;/p&gt;
&lt;p&gt;以前我从未遇到过udp checksum的问题。所以这次是第一次遇到，所以需要学习一下。
首先udp checksum是什么？&lt;/p&gt;
&lt;p&gt;我们看下udp的协议组成的字段，其中就有16位的校验和&lt;/p&gt;
&lt;p&gt;校验和一般都是为了检验数据包在传输过程中是否出现变动的。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果接受端收到的udp消息校验和错误，将会被悄悄的丢弃&lt;/li&gt;
&lt;li&gt;udp校验和是一个端到端的校验和。端到端意味它不会在中间网络设备上校验。&lt;/li&gt;
&lt;li&gt;校验和由发送方负责计算，接收端负责验证。目的是为了发现udp首部和和数据在发送端和接受端之间是否发生了变动&lt;/li&gt;
&lt;li&gt;udp校验和是可选的功能，但是总是应该被默认启用。&lt;/li&gt;
&lt;li&gt;如果发送方设置了udp校验和，则接受方必须验证&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;发送方负责计算？具体是谁负责计算&lt;/p&gt;
&lt;p&gt;计算一般都是CPU的工作，但是有些网卡也是支持checksum offload的。&lt;/p&gt;
&lt;p&gt;所谓offload, 是指本来可以由cpu计算的，改变由网卡硬件负责计算。
这样做有很多好处，&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;可以降低cpu的负载，提高系统的性能&lt;/li&gt;
&lt;li&gt;网卡的硬件checksum, 效率更高&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;为什么只有发送方出现udp-checksum-错误&#34;&gt;为什么只有发送方出现udp checksum 错误？&lt;/h1&gt;
&lt;p&gt;我在接受方和放松方都进行了抓包，一个比较特殊的特征是，只有发送方发现了udp checksum的错误，在接受方，同样的包，udp checksum的值却是正确的。&lt;/p&gt;
&lt;p&gt;一句话的解释：tcpdump在接收方抓到的包，本身checksum字段还没有被计算，在后续的步骤，这个包才会被交给NIC, NIC来负责计算。&lt;/p&gt;
&lt;h1 id=&#34;结论&#34;&gt;结论&lt;/h1&gt;
&lt;p&gt;maybe caused by udp checksum offload 这个报错并没有什么问题。&lt;/p&gt;
&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;
&lt;p&gt;● 《tcp/ip 详解》
● &lt;a href=&#34;https://www.kernel.org/doc/html/latest/networking/checksum-offloads.html&#34;&gt;https://www.kernel.org/doc/html/latest/networking/checksum-offloads.html&lt;/a&gt;
● &lt;a href=&#34;https://dominikrys.com/posts/disable-udp-checksum-validation/&#34;&gt;https://dominikrys.com/posts/disable-udp-checksum-validation/&lt;/a&gt;
● &lt;a href=&#34;https://sokratisg.net/2012/04/01/udp-tcp-checksum-errors-from-tcpdump-nic-hardware-offloading/&#34;&gt;https://sokratisg.net/2012/04/01/udp-tcp-checksum-errors-from-tcpdump-nic-hardware-offloading/&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Wireshark 附带的19命令行程序</title>
      <link>https://wdd.js.org/network/wireshark-extra-cli/</link>
      <pubDate>Thu, 30 Jun 2022 00:00:00 +0800</pubDate>
      <guid>https://wdd.js.org/network/wireshark-extra-cli/</guid>
      <description>&lt;p&gt;大多数时候我们都是图形界面的方式使用wireshak, 其实一般只要你安装了wireshark，同时也附带安装了一些命令行工具。
这些工具也可以极大的提高生产效率。
本文只是对工具的功能简介，可以使用命令 -h, 查看命令的具体使用文档。&lt;/p&gt;
&lt;h1 id=&#34;1-editcap-编辑抓包文件&#34;&gt;1. editcap 编辑抓包文件&lt;/h1&gt;
&lt;p&gt;Editcap (Wireshark) 3.6.1 (v3.6.1-0-ga0a473c7c1ba)
Edit and/or translate the format of capture files.
举例: 按照时间范围从input.pcap文件中拿出指定时间范围的包&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;editcap -A &amp;#39;2014-12-10 10:11:01&amp;#39; -B &amp;#39;2014-12-10 10:21:01&amp;#39; input.pcap output.pcap
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;2-androiddump&#34;&gt;2. androiddump&lt;/h1&gt;
&lt;p&gt;这个命令似乎可以用来对安卓系统进行抓包，没玩过安卓，不再多说。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Wireshark - androiddump v1.1.0
Usage:
 androiddump --extcap-interfaces [--adb-server-ip=&amp;lt;arg&amp;gt;] [--adb-server-tcp-port=&amp;lt;arg&amp;gt;]
 androiddump --extcap-interface=INTERFACE --extcap-dlts
 androiddump --extcap-interface=INTERFACE --extcap-config
 androiddump --extcap-interface=INTERFACE --fifo=PATH_FILENAME --capture
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;3-ciscodump&#34;&gt;3. ciscodump&lt;/h1&gt;
&lt;p&gt;似乎是对思科的网络进行抓包的，没用过
Wireshark - ciscodump v1.0.0
Usage:
ciscodump &amp;ndash;extcap-interfaces
ciscodump &amp;ndash;extcap-interface=ciscodump &amp;ndash;extcap-dlts
ciscodump &amp;ndash;extcap-interface=ciscodump &amp;ndash;extcap-config
ciscodump &amp;ndash;extcap-interface=ciscodump &amp;ndash;remote-host myhost &amp;ndash;remote-port 22222 &amp;ndash;remote-username myuser &amp;ndash;remote-interface gigabit0/0 &amp;ndash;fifo=FILENAME &amp;ndash;capture&lt;/p&gt;</description>
    </item>
    <item>
      <title>Linux内核参数rp_filter</title>
      <link>https://wdd.js.org/network/rp_filter/</link>
      <pubDate>Mon, 13 Jun 2022 00:00:00 +0800</pubDate>
      <guid>https://wdd.js.org/network/rp_filter/</guid>
      <description>&lt;h1 id=&#34;问题现象&#34;&gt;问题现象&lt;/h1&gt;
&lt;p&gt;主机上有两个网卡ens192和ens224。ens129网卡是对内网络的网卡，ens224是对网网络的网卡。&lt;/p&gt;
&lt;p&gt;SIP信令阶段都是正常的，但是发现，对于来自node3的RTP流， 并没有从ens192网卡转发给node1上。&lt;/p&gt;
&lt;pre class=&#34;mermaid&#34;&gt;sequenceDiagram
    title network
    autonumber
    node1-&amp;gt;&amp;gt;ens192: INVITE
    ens224-&amp;gt;&amp;gt;node2: INVITE
    node2-&amp;gt;&amp;gt;ens224: 200 ok
    ens192-&amp;gt;&amp;gt;node1: 200 ok
    node1-&amp;gt;&amp;gt;ens192: ACK
    ens224-&amp;gt;&amp;gt;node2: ACK
    node1--&amp;gt;&amp;gt;ens192: RTP out
    ens224--&amp;gt;&amp;gt;node3: RTP out
    node3--&amp;gt;&amp;gt;ens224: RTP in
&lt;/pre&gt;
&lt;p&gt;抓包程序抓到了node3发送到ens224上的包，但是排查应用服务器的日志发现，似乎应用服务器根本没有收到node3上过来的包, 所以也就无法转发。&lt;/p&gt;
&lt;p&gt;因而怀疑是不是在内核上被拦截了。 后来通过将rp_filter设置为0, 然后语音流的转发就正常了。&lt;/p&gt;
&lt;h1 id=&#34;事后复盘&#34;&gt;事后复盘&lt;/h1&gt;
&lt;p&gt;node3的这个IP直接往应用服务器上发包，可能会被拦截。因为在信令建立的阶段，应用服务器并没有主动发&lt;/p&gt;
&lt;h1 id=&#34;在kernel文档上&#34;&gt;在kernel文档上&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rp_filter - INTEGER
	0 - No source validation.
	1 - Strict mode as defined in RFC3704 Strict Reverse Path
	    Each incoming packet is tested against the FIB and if the interface
	    is not the best reverse path the packet check will fail.
	    By default failed packets are discarded.
	2 - Loose mode as defined in RFC3704 Loose Reverse Path
	    Each incoming packet&amp;#39;s source address is also tested against the FIB
	    and if the source address is not reachable via any interface
	    the packet check will fail.

	Current recommended practice in RFC3704 is to enable strict mode
	to prevent IP spoofing from DDos attacks. If using asymmetric routing
	or other complicated routing, then loose mode is recommended.

	The max value from conf/{all,interface}/rp_filter is used
	when doing source validation on the {interface}.

	Default value is 0. Note that some distributions enable it
	in startup scripts.
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.jianshu.com/p/717e6cd9d2bb&#34;&gt;https://www.jianshu.com/p/717e6cd9d2bb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.jianshu.com/p/16d5c130670b&#34;&gt;https://www.jianshu.com/p/16d5c130670b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt&#34;&gt;https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    <item>
      <title>websocket tcp keepalive 机制调研</title>
      <link>https://wdd.js.org/network/pz06t2/</link>
      <pubDate>Wed, 17 Mar 2021 19:17:46 +0800</pubDate>
      <guid>https://wdd.js.org/network/pz06t2/</guid>
      <description>&lt;p&gt;测试目标服务器 &lt;a href=&#34;http://www.websocket-test.com/&#34;&gt;http://www.websocket-test.com/&lt;/a&gt;， 该服务器使用的是未加密的ws协议。&lt;/p&gt;
&lt;p&gt;打开这个页面，可以看到这个页面发起了连接到ws://121.40.165.18:8800/ 的websocket连接。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/pz06t2/2022-10-29-18-35-36.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;然后看下里面的消息，都是服务端向客户端发送的消息。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/pz06t2/2022-10-29-18-35-51.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;通过wireshark分析&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/pz06t2/2022-10-29-18-36-01.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;单独的websocket也是能够看到服务端下发的消息的。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/pz06t2/2022-10-29-18-36-20.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;keepalive-要点关注&#34;&gt;keepalive 要点关注&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;每隔大约45秒，客户端会像服务端发送一个keep alive包。服务端也会非常快的回复一个心跳包&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/pz06t2/2022-10-29-18-36-43.png&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>tcpdump filters</title>
      <link>https://wdd.js.org/network/hhlfi1/</link>
      <pubDate>Fri, 04 Dec 2020 13:32:16 +0800</pubDate>
      <guid>https://wdd.js.org/network/hhlfi1/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.yuque.com/attachments/yuque/0/2020/pdf/280451/1607059951958-8fd98d7f-52b2-49e3-a69f-b4e0fc08a215.pdf&#34;&gt;ethereal-tcpdump.pdf&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>libpcap tutorial</title>
      <link>https://wdd.js.org/network/ivzphz/</link>
      <pubDate>Fri, 04 Dec 2020 13:31:32 +0800</pubDate>
      <guid>https://wdd.js.org/network/ivzphz/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.yuque.com/attachments/yuque/0/2020/pdf/280451/1607059907885-3aec5ac7-27c2-42f0-bbc3-4a993dc28b6b.pdf&#34;&gt;libpcap-tutorial.pdf&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>tcpdump zine</title>
      <link>https://wdd.js.org/network/yscigi/</link>
      <pubDate>Fri, 04 Dec 2020 13:29:53 +0800</pubDate>
      <guid>https://wdd.js.org/network/yscigi/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.yuque.com/attachments/yuque/0/2020/pdf/280451/1607059806872-996e8e81-0e4e-41e4-9d29-75b38eb33061.pdf&#34;&gt;tcpdump-zine.pdf&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>pcap抓包教程</title>
      <link>https://wdd.js.org/network/uq5cii/</link>
      <pubDate>Wed, 02 Dec 2020 13:27:13 +0800</pubDate>
      <guid>https://wdd.js.org/network/uq5cii/</guid>
      <description>&lt;h1 id=&#34;准备条件&#34;&gt;准备条件&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;有gcc编译器&lt;/li&gt;
&lt;li&gt;安装libpcap包&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;1c-试运行&#34;&gt;1.c 试运行&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;pcap.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dev &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; argv[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Device: %s&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, dev);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc ./1.c -o 1.exe -lpcap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;demo-libpcap git:&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;master&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; ✗ ./1.exe eth0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Device: eth0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;第一个栗子非常简单，仅仅是测试相关的库是否加载正确&lt;/p&gt;
&lt;h1 id=&#34;2c-获取默认网卡名称&#34;&gt;2.c 获取默认网卡名称&lt;/h1&gt;
&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.tcpdump.org/pcap.html&#34;&gt;http://www.tcpdump.org/pcap.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    <item>
      <title>wireshark从pcap中提取语音文件</title>
      <link>https://wdd.js.org/network/zgftde/</link>
      <pubDate>Wed, 25 Nov 2020 10:34:52 +0800</pubDate>
      <guid>https://wdd.js.org/network/zgftde/</guid>
      <description>&lt;p&gt;使用tcpdump在服务端抓包，将抓包后的文件在wireshark中打开。&lt;/p&gt;
&lt;p&gt;然后选择：Telephony - VoIP Calls，wireshark可以从抓包文件中提取出SIP呼叫列表。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/zgftde/2022-10-29-18-38-18.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;呼叫列表页面&#34;&gt;呼叫列表页面&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/zgftde/2022-10-29-18-38-41.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;在呼叫列表页面，选择一条呼叫记录，点击Flow Sequence， 可以查看该呼叫的SIP时序图。点击Play Stream， 可以播放该条呼叫的声音。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/zgftde/2022-10-29-18-38-53.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;RTPplay页面有播放按钮，点击播放可以听到通话声音。&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/zgftde/2022-10-29-18-39-02.png&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>wireshark合并和按时间截取pcap文件</title>
      <link>https://wdd.js.org/network/kgrco2/</link>
      <pubDate>Wed, 25 Nov 2020 10:11:22 +0800</pubDate>
      <guid>https://wdd.js.org/network/kgrco2/</guid>
      <description>&lt;p&gt;tcpdump可以在抓包时，按照指定时间间隔或者按照指定的包大小，产生新的pcap文件。用wireshark分析这些包时，往往需要将这些包做合并或者分离操作。&lt;/p&gt;
&lt;h1 id=&#34;mergecap&#34;&gt;mergecap&lt;/h1&gt;
&lt;p&gt;如果安装了Wireshark那么mergecap就会自动安装，可以使用它来合并多个pcap文件。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 按照数据包中的时间顺序合并文件
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mergecap -w output.pcap input1.pcap input2.pcap input3.pcap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 按照命令行中的输入数据包文件顺序合并文件
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 不加-a, 可能会导致SIP时序图重复的问题
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mergecap -a -w output.pcap input1.pcap input2.pcap input3.pcap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;editcap&#34;&gt;editcap&lt;/h1&gt;
&lt;p&gt;对于一个很大的pcap文件，按照时间范围分割出新的pcap包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;editcap -A &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;2014-12-10 10:11:01&amp;#39;&lt;/span&gt; -B &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;2014-12-10 10:21:01&amp;#39;&lt;/span&gt; input.pcap output.pcap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;参考 &lt;a href=&#34;https://blog.csdn.net/qq_19004627/article/details/82287172&#34;&gt;https://blog.csdn.net/qq_19004627/article/details/82287172&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    <item>
      <title>网络拆包笔记</title>
      <link>https://wdd.js.org/network/gzskun/</link>
      <pubDate>Sun, 03 May 2020 10:59:10 +0800</pubDate>
      <guid>https://wdd.js.org/network/gzskun/</guid>
      <description>&lt;h1 id=&#34;介绍&#34;&gt;介绍&lt;/h1&gt;
&lt;p&gt;之所以要写这篇文章，是因为我要从pcap格式的抓包文件中抽取出语音文件。之间虽然对tcp协议有不错的理解，但并没有写代码去真正的解包分析。&lt;/p&gt;
&lt;p&gt;最近用Node.js尝试去pacp文件中成功提取出了语音文件。再次做个总结。&lt;/p&gt;
&lt;h1 id=&#34;预备知识&#34;&gt;预备知识&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;字节序： 关于字节序，可以参考 &lt;a href=&#34;https://www.ruanyifeng.com/blog/2016/11/byte-order.html&#34;&gt;https://www.ruanyifeng.com/blog/2016/11/byte-order.html&lt;/a&gt;。读取的时候，如果字节序设置错了，就会读出来一堆无法解析的内容&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;pcap格式&#34;&gt;PCAP格式&lt;/h1&gt;
&lt;p&gt;下面是paap文件的格式。&lt;/p&gt;
&lt;p&gt;开局是一个全局的头文件。后续跟着一系列的包头和包体。&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/gzskun/2022-10-29-18-31-05.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;global-header格式&#34;&gt;Global Header格式&lt;/h2&gt;
&lt;p&gt;全局头由六个字段组成，加起来一共24个字节。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; pcap_hdr_s {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        guint32 magic_number;   &lt;span style=&#34;color:#75715e&#34;&gt;/* magic number */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        guint16 version_major;  &lt;span style=&#34;color:#75715e&#34;&gt;/* major version number */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        guint16 version_minor;  &lt;span style=&#34;color:#75715e&#34;&gt;/* minor version number */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        gint32  thiszone;       &lt;span style=&#34;color:#75715e&#34;&gt;/* GMT to local correction */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        guint32 sigfigs;        &lt;span style=&#34;color:#75715e&#34;&gt;/* accuracy of timestamps */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        guint32 snaplen;        &lt;span style=&#34;color:#75715e&#34;&gt;/* max length of captured packets, in octets */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        guint32 network;        &lt;span style=&#34;color:#75715e&#34;&gt;/* data link type */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} &lt;span style=&#34;color:#66d9ef&#34;&gt;pcap_hdr_t&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;magic_number 魔术字符，32位无符号整型，一般是0xa1b2c3d4或者0xd4c3b2a1，前者表示字段要按照大端字节序来读取，后者表示字段要按照小段字节序来读取。&lt;/li&gt;
&lt;li&gt;version_major 大版本号，16位无符号整形。一般是2&lt;/li&gt;
&lt;li&gt;version_minor 小版本号，16位无符号整形。一般是4&lt;/li&gt;
&lt;li&gt;thiszone 时区&lt;/li&gt;
&lt;li&gt;sigfigs 实际时间戳&lt;/li&gt;
&lt;li&gt;snaplen 捕获的最大的长度&lt;/li&gt;
&lt;li&gt;network 数据链路层的类型。参考&lt;a href=&#34;http://www.tcpdump.org/linktypes.html&#34;&gt;http://www.tcpdump.org/linktypes.html&lt;/a&gt;， 常见的1就是表示IEEE 802.3&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;packet-header&#34;&gt;Packet Header&lt;/h2&gt;
&lt;p&gt;当读取了pcap文件的前24个字节之后，紧接着需要读取16个字节。这16个字节中，incl_len表示packet数据部分的长度。当拿到了Packet Data部分数据的长度。我们同时也就知道了下一个packet header要从哪个位置开始读取。&lt;/p&gt;</description>
    </item>
    <item>
      <title>网络包的封装和分用</title>
      <link>https://wdd.js.org/network/mlepcg/</link>
      <pubDate>Wed, 11 Mar 2020 08:24:20 +0800</pubDate>
      <guid>https://wdd.js.org/network/mlepcg/</guid>
      <description>&lt;p&gt;图解包在TCP/IP各个协议栈的流动情况&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.processon.com/embed/5e682878e4b069aa4e5b845f&#34;&gt;点击查看【undefined】&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>IP协议 Protocol</title>
      <link>https://wdd.js.org/network/ip-protocol/</link>
      <pubDate>Thu, 05 Mar 2020 12:48:10 +0800</pubDate>
      <guid>https://wdd.js.org/network/ip-protocol/</guid>
      <description>&lt;h1 id=&#34;ip协议格式&#34;&gt;IP协议格式&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/ip-protocol/2022-10-29-15-26-15.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;字段说明&#34;&gt;字段说明 &lt;/h1&gt;
&lt;h2 id=&#34;protocol&#34;&gt;Protocol&lt;/h2&gt;
&lt;p&gt;表示上层协议，也就是传输层是什么协议。&lt;/p&gt;
&lt;p&gt;只需要看Decimal这列，常用的有&lt;strong&gt;6表示TCP, 17表示UDP, 50表示ESP&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/ip-protocol/2022-10-29-15-30-11.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;用wireshark抓包的时候，也可以看到Protocol: UDP(17)&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/ip-protocol/2022-10-29-15-30-26.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://tools.ietf.org/html/rfc791&#34;&gt;https://tools.ietf.org/html/rfc791&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://tools.ietf.org/html/rfc790&#34;&gt;https://tools.ietf.org/html/rfc790&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/List_of_IP_protocol_numbers&#34;&gt;https://en.wikipedia.org/wiki/List_of_IP_protocol_numbers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    <item>
      <title>从飞机航线讲解网络分层</title>
      <link>https://wdd.js.org/network/ibhy8a/</link>
      <pubDate>Tue, 03 Mar 2020 13:48:27 +0800</pubDate>
      <guid>https://wdd.js.org/network/ibhy8a/</guid>
      <description>&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/ibhy8a/2022-10-29-18-34-09.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/ibhy8a/2022-10-29-18-34-19.png&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>TIME_WAIT与持久连接</title>
      <link>https://wdd.js.org/network/sq4l53/</link>
      <pubDate>Wed, 15 Jan 2020 20:23:45 +0800</pubDate>
      <guid>https://wdd.js.org/network/sq4l53/</guid>
      <description>&lt;p&gt;在事务结束之后，仍然保持在打开状态的链接称为持久连接。非持久的链接会在每个事务结束之后就会关闭。&lt;/p&gt;
&lt;h1 id=&#34;持久连接的好处&#34;&gt;持久连接的好处 &lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;避免缓慢的链接建立阶段&lt;/li&gt;
&lt;li&gt;避免慢启动的拥塞适应阶段&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;keep-alive&#34;&gt;Keep-Alive&lt;/h1&gt;
&lt;p&gt;客户端发起请求，带有Connection: Keep-Alive头。客户端在响应头中回应Connection: Keep-Alive。则说明客户端同意持久连接。&lt;/p&gt;
&lt;p&gt;如果客户端不同意持久连接，就会在响应头中返回Connection: Close&lt;/p&gt;
&lt;p&gt;注意事项&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;即使服务端同意了持久连接，服务端也可以随时关闭连接&lt;/li&gt;
&lt;li&gt;HTTP 1.0 协议，必须显式传递Connection: Keep-Alive，服务端才会激活持久连接&lt;/li&gt;
&lt;li&gt;HTTP 1.1 协议，默认就是持久连接&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/sq4l53/2022-10-29-18-37-07.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;在通信双方中，主动关闭连接的一方会进入TIME_WIAT状态，而被动关闭的一方则不会进入该状态。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/sq4l53/2022-10-29-18-37-20.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;time_wait连接太多&#34;&gt;TIME_WAIT连接太多&lt;/h1&gt;
&lt;p&gt;服务端太多的TIME_WAIT连接，则说明连接是服务端主动去关闭的。查看了响应头，内容也是Connection: Close。&lt;/p&gt;
&lt;p&gt;我们知道，一般情况下TIME_WAIT状态的链接至少会持续60秒。也就是说该连接占用的内存至少在60秒内不会释放。&lt;/p&gt;
&lt;p&gt;当连接太多时，就有可能产生out of memory的问题，而操作系统就会很有可能把这个进程给kill掉，进而导致服务不可用。&lt;/p&gt;</description>
    </item>
    <item>
      <title>漫话TCP TIME-WAIT状态【ing】</title>
      <link>https://wdd.js.org/network/yoc1k0/</link>
      <pubDate>Tue, 07 Jan 2020 22:48:37 +0800</pubDate>
      <guid>https://wdd.js.org/network/yoc1k0/</guid>
      <description>&lt;p&gt;在《tcp/ip详解卷一》中，有幅图介绍了TCP的状态迁移，TCP的状态转移并不简单，我们本次重点关注TIME_WAIT状态。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/yoc1k0/2022-10-29-18-37-39.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;time-wait&#34;&gt;TIME-WAIT&lt;/h1&gt;
&lt;p&gt;主机1发起FIN关闭连接请求，主机2发送ACK确认，然后也发送FIN。主机1在收到FIN之后，想主机2发送了ACK。&lt;/p&gt;
&lt;p&gt;在主机1发送ACK时，主机1就进入了TIME-WAIT状态。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;主动发起关闭连接的一方会有TIME-WAIT状态&lt;/li&gt;
&lt;li&gt;如果两方同时发起关闭连接请求，那么两方都会进入TIME-WAIT状态&lt;/li&gt;
&lt;li&gt;TIME-WAIT的时长在 &lt;code&gt;/proc/sys/net/ipv4/tcp_fin_timeout&lt;/code&gt; 中配置，一般是60s&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/yoc1k0/2022-10-29-18-37-49.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;为什么要有time-wait状态&#34;&gt;为什么要有TIME-WAIT状态？&lt;/h1&gt;
&lt;h1 id=&#34;太多time-wait链接是否意味有故障&#34;&gt;太多TIME-WAIT链接是否意味有故障？&lt;/h1&gt;</description>
    </item>
    <item>
      <title>2 链路层</title>
      <link>https://wdd.js.org/network/xwuvyr/</link>
      <pubDate>Thu, 28 Nov 2019 13:35:34 +0800</pubDate>
      <guid>https://wdd.js.org/network/xwuvyr/</guid>
      <description>&lt;h1 id=&#34;最大传输单元mtu&#34;&gt;最大传输单元MTU&lt;/h1&gt;
&lt;p&gt;以太网和802.3对数据帧的长度有个限制，其最大长度分别是1500和1942。链路层的这个特性称作MTU,  最大传输单元。不同类型的网络大多数都有一个限制。&lt;/p&gt;
&lt;p&gt;如果IP层的数据报的长度比链路层的MTU大，那么IP层就需要分片，每一片的长度要小于MTU。&lt;/p&gt;
&lt;p&gt;使用netstat -in可以打印出网络接口的MTU&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-makefile&#34; data-lang=&#34;makefile&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;➜&lt;/span&gt;  &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;~&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;netstat&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;-in&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;Kernel&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;Interface&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;table&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;Iface&lt;/span&gt;       &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;MTU&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;Met&lt;/span&gt;    &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;RX-OK&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;RX-ERR&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;RX-DRP&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;RX-OVR&lt;/span&gt;    &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;TX-OK&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;TX-ERR&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;TX-DRP&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;TX-OVR&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;Flg&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;eth2&lt;/span&gt;       &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;1500&lt;/span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;1078767768&lt;/span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;2264&lt;/span&gt;    &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;689&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;1297577913&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;BMRU&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;lo&lt;/span&gt;        &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;16436&lt;/span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;734474&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;734474&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt;      &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;LRU&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;路径mtu&#34;&gt;路径MTU&lt;/h1&gt;
&lt;p&gt;信息经过多个网络时，不同网络可能会有不同的MTU，而其中最小的一个MTU, 称为路径MTU。&lt;/p&gt;</description>
    </item>
    <item>
      <title>1 概述</title>
      <link>https://wdd.js.org/network/ir1i82/</link>
      <pubDate>Wed, 27 Nov 2019 09:20:48 +0800</pubDate>
      <guid>https://wdd.js.org/network/ir1i82/</guid>
      <description>&lt;h1 id=&#34;分层&#34;&gt;分层&lt;/h1&gt;
&lt;p&gt;应用程序一般处理应用层的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;------------------------------------------------------------&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;应用层&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt; Telnet, FTP, Email, MySql			&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	  	&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;应用程序细节&lt;/span&gt;						  &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;用户进程&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;------------------------------------------------------------&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;运输层&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt; TCP, UDP                          &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;内核&lt;/span&gt;(&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;处理通信细节&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;端到端通信&lt;/span&gt;                          &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;------------------------------------------|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;网络层&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt; IP, ICMP, IGMP					&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;逐跳通信，处理分组相关的活动，例如分组选路&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;------------------------------------------|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;链路层&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;设备驱动程序&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;接口卡&lt;/span&gt;				   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;处理物理信号&lt;/span&gt;						  &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;------------------------------------------------------------&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;应用层和传输层使用&lt;strong&gt;端到端&lt;/strong&gt;的协议&lt;/li&gt;
&lt;li&gt;网络层提供&lt;strong&gt;逐跳&lt;/strong&gt;的协议&lt;/li&gt;
&lt;li&gt;网桥在&lt;strong&gt;链路层&lt;/strong&gt;来连接网络&lt;/li&gt;
&lt;li&gt;路由器在&lt;strong&gt;网络层&lt;/strong&gt;连接网络&lt;/li&gt;
&lt;li&gt;以太网数据帧的物理特性是长度必须在&lt;strong&gt;46-1500&lt;/strong&gt;字节之间&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;封装&#34;&gt;封装&lt;/h1&gt;
&lt;p&gt;以太网帧用来封装IP数据报。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;IP数据报 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; IP首部&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;20字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; + TCP首部&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;20字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; + 应用数据  &lt;span style=&#34;color:#75715e&#34;&gt;# 针对TCP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;IP数据报 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; IP首部&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;20字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; + UDP首部&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;8字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; + 应用数据 &lt;span style=&#34;color:#75715e&#34;&gt;# 针对UDP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;以太网帧 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 以太网首部&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;14字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; + IP数据报&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;46-1500字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; + 以太网尾部&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;4字节&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;IP数据报最大为1500字节，减去20字节IP首部，8字节UDP首部，留给UDP应用数据的只有1472字节。&lt;/p&gt;</description>
    </item>
    <item>
      <title>技巧1</title>
      <link>https://wdd.js.org/network/kttu4i/</link>
      <pubDate>Mon, 25 Nov 2019 20:24:24 +0800</pubDate>
      <guid>https://wdd.js.org/network/kttu4i/</guid>
      <description>&lt;h1 id=&#34;1-面向连接和面向非连接的区别&#34;&gt;1 面向连接和面向非连接的区别？&lt;/h1&gt;
&lt;p&gt;面向连接与面向非连接并不是指的物理介质，而是指的分组数据包。而实际上，连接只是一个虚拟的概念。&lt;/p&gt;
&lt;p&gt;数据在发送前，会被分组发送。对于面向连接的协议来说，每个分组之间都有顺序的，分组会存储自己的位置信息。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;可以理解在同一时间只维持一段关系。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/kttu4i/2022-10-29-18-34-49.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;面向非连接协议，分组直接并无任何关系，每个分组都是相互独立的。&lt;strong&gt;可以理解为脚踏多条船。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/kttu4i/2022-10-29-18-35-03.png&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>基本套接字API回顾</title>
      <link>https://wdd.js.org/network/base-socket/</link>
      <pubDate>Mon, 25 Nov 2019 20:06:16 +0800</pubDate>
      <guid>https://wdd.js.org/network/base-socket/</guid>
      <description>&lt;h1 id=&#34;套接字api&#34;&gt;套接字API&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;SOCKET &lt;span style=&#34;color:#a6e22e&#34;&gt;socket&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; domain, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; type, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; protocol)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Socket API和协议无关，即可以用来创建Socket，无论是TCP还是UDP，还是进程间的通信，都可以用这个接口创建。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;domain 表示通信域，最长见的有以下两个域
&lt;ul&gt;
&lt;li&gt;AF_INET 因特网通信&lt;/li&gt;
&lt;li&gt;AF_LOCAL 进程间通信&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;type 表示套接字的类型
&lt;ul&gt;
&lt;li&gt;SOCK_STREAM 可靠的、全双工、面向连接的，实际上就是我们熟悉的TCP&lt;/li&gt;
&lt;li&gt;SOCK_DGRAM 不可靠、尽力而为的，无连接的。实际上指的就是UDP&lt;/li&gt;
&lt;li&gt;SOCK_RAW 允许对IP层的数据进行访问。用于特殊目的，例如ICMP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;protocol 表示具体通信协议&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;TCP/IP 本自同根生！&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>可能被遗漏的https与http的知识点</title>
      <link>https://wdd.js.org/network/of5hny/</link>
      <pubDate>Tue, 15 Oct 2019 21:56:42 +0800</pubDate>
      <guid>https://wdd.js.org/network/of5hny/</guid>
      <description>&lt;h1 id=&#34;1-https域向http域发送请求会被浏览器直接拒绝http向https则不会&#34;&gt;1. HTTPS域向HTTP域发送请求会被浏览器直接拒绝，HTTP向HTTPS则不会&lt;/h1&gt;
&lt;p&gt;例如在github pages页面，这是一个https页面，如果在这个页面向http发送请求，那么会直接被浏览器拒绝，并在控制台输出下面的报错信息。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;jquery-1.11.3.min.js:5 Mixed Content: The page at &amp;#39;https://wangduanduan.github.io/ddddddd/&amp;#39; was loaded over HTTPS, but requested an insecure XMLHttpRequest endpoint &amp;#39;http://cccccc/&amp;#39;. This request has been blocked; the content must be served over HTTPS.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果你在做第三方集成的系统，如果他们是在浏览器中直接调用你提供的接口，&lt;code&gt;那么最好你使用https协议，这样无论对方是https还是http都可以访问&lt;/code&gt;。（相信我，这个很重要，我曾经经历过上线后遇到这个问题，然后连夜申请证书，把http升级到https的痛苦经历）&lt;/p&gt;
&lt;h1 id=&#34;2-https的默认端口是443而不是443&#34;&gt;2. HTTPS的默认端口是443，而不是443&lt;/h1&gt;
&lt;p&gt;如果443端口已经被其他服务占用了，那么使用其他任何没有被占用的端口都可以用作HTTPS服务，只不过在请求的时候需要加上端口号罢了。&lt;/p&gt;</description>
    </item>
    <item>
      <title>ngrep明文http抓包教程</title>
      <link>https://wdd.js.org/network/pxn896/</link>
      <pubDate>Fri, 16 Aug 2019 09:59:08 +0800</pubDate>
      <guid>https://wdd.js.org/network/pxn896/</guid>
      <description>&lt;p&gt;一般使用tcpdump抓包，然后将包文件下载到本机，用wireshark去解析过滤。&lt;/p&gt;
&lt;p&gt;但是这样会显得比较麻烦。&lt;/p&gt;
&lt;p&gt;ngrep可以直接在linux转包，明文查看http的请求和响应信息。&lt;/p&gt;
&lt;h1 id=&#34;安装&#34;&gt;安装&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;apt install ngrep &lt;span style=&#34;color:#75715e&#34;&gt;# debian&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;yum install ngrep &lt;span style=&#34;color:#75715e&#34;&gt;# centos7&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 如果centos报错没有ngrep, 那么执行下面的命令, 然后再安装&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rpm -ivh http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;http抓包&#34;&gt;HTTP抓包&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;-W byline 头信息会自动换行&lt;/li&gt;
&lt;li&gt;host 192.168.60.200  是过滤规则 源ip或者目的ip是192.168.60.200&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ngrep -W byline host 192.168.60.200
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;interface: eth0 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;192.168.1.0/255.255.255.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;filter: &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ip or ip6&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; and &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; host 192.168.60.200 &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;####&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;T 192.168.1.102:39510 -&amp;gt; 192.168.60.200:7775 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;AP&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;GET / HTTP/1.1.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host: 192.168.60.200:7775.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;User-Agent: curl/7.52.1.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Accept: */*.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;T 192.168.60.200:7775 -&amp;gt; 192.168.1.102:39510 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;AP&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;HTTP/1.1 &lt;span style=&#34;color:#ae81ff&#34;&gt;302&lt;/span&gt; Moved Temporarily.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Server: Apache-Coyote/1.1.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Set-Cookie: JSESSIONID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;211CA612EC681B9FDCE7726B03F42088; Path&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;/; HttpOnly.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Location: http://192.168.60.200:7775/homepage.action.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Content-Type: text/html.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Content-Length: 0.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Date: Fri, &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt; Aug &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; 02:16:51 GMT.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;过滤规则&#34;&gt;过滤规则&lt;/h1&gt;
&lt;h2 id=&#34;按ip地址过滤&#34;&gt;按IP地址过滤&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ngrep -W byline host 192.168.60.200 &lt;span style=&#34;color:#75715e&#34;&gt;# 源地址或者目的地址是 192.168.60.200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;按端口过滤&#34;&gt;按端口过滤&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ngrep -W byline port &lt;span style=&#34;color:#ae81ff&#34;&gt;80&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# 源端口或者目的端口是 80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;按照正则匹配&#34;&gt;按照正则匹配&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ngrep -W byline -q HTTP &lt;span style=&#34;color:#75715e&#34;&gt;# 匹配所有包中含有HTTP的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;指定网卡&#34;&gt;指定网卡&lt;/h1&gt;
&lt;p&gt;默认情况下，ngrep使用网卡列表中的一个网卡，当然你也可以使用-d选项来指定抓包某个网卡。&lt;/p&gt;</description>
    </item>
    <item>
      <title>图解通信网络 第二版</title>
      <link>https://wdd.js.org/network/graph-network/</link>
      <pubDate>Mon, 08 Jul 2019 21:32:50 +0800</pubDate>
      <guid>https://wdd.js.org/network/graph-network/</guid>
      <description>&lt;p&gt;图片来自 &lt;a href=&#34;https://microchipdeveloper.com/&#34;&gt;https://microchipdeveloper.com/&lt;/a&gt; 只不过这个网站访问速度很慢，但是里面的图片非常有意思，能够简洁明了的说明一个概念。&lt;/p&gt;
&lt;p&gt;上学的时候，数学老师喜欢在讲课前先讲一些概念，然后再做题。但是我觉得概念并没有那么重要，我更喜欢做题。&lt;/p&gt;
&lt;p&gt;但是，当你理解了概念后，再去实战，就有事半功倍的效果。&lt;/p&gt;
&lt;h1 id=&#34;1-路由器&#34;&gt;1. 路由器&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;路由器（英语：Router，又称路径器）是一种电讯网络设备，提供路由与转送两种重要机制，可以决定数据包从来源端到目的端所经过的路由路径（host到host之间的传输路径），这个过程称为路由；将路由器输入端的数据包移送至适当的路由器输出端（在路由器内部进行），这称为转送。路由工作在OSI模型的第三层——即网络层，例如网际协议（IP）。&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;路由器用来做网络之间的链接，所以路由器一般至少会链接到两个网络上。常见的就是一边连接外网，一边连接内网。&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-07-37.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;2-ip地址&#34;&gt;2. IP地址&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-08-01.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;3-交换机&#34;&gt;3. 交换机&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-08-16.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;4-五层网络模型&#34;&gt;4. 五层网络模型&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-09-08.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-09-19.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-09-29.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-09-38.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;5-tcp-vs-udp&#34;&gt;5. TCP vs UDP&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-09-56.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;6-tcp-和-udp-头&#34;&gt;6. TCP 和 UDP 头&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-10-04.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;7-常见的端口号&#34;&gt;7. 常见的端口号&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-10-13.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;8-客户端和服务端&#34;&gt;8. 客户端和服务端&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-10-26.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;9-socket&#34;&gt;9. Socket&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-10-40.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;10-socket建立&#34;&gt;10. Socket建立&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-10-49.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;11-一个web服务器的工作过程s&#34;&gt;11. 一个Web服务器的工作过程s&lt;/h1&gt;
&lt;h2 id=&#34;step1-服务器在80端口监听消息&#34;&gt;step1: 服务器在80端口监听消息&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-11-04.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;step2-客户端随机选择一个端口向服务端发起连接请求&#34;&gt;step2: 客户端随机选择一个端口，向服务端发起连接请求&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-11-22.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;step3-传输层将消息传输给服务器&#34;&gt;step3: 传输层将消息传输给服务器&lt;/h2&gt;
&lt;p&gt;服务端建立一个Socket用来和客户端建立通道&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-11-33.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;step4-服务器通过socket将html发给客户端&#34;&gt;step4: 服务器通过socket将html发给客户端&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-11-41.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;step5-消息接受完毕socket关闭&#34;&gt;step5: 消息接受完毕，Socket关闭&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-11-48.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;12-nat&#34;&gt;12 NAT&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://wdd.js.org/network/graph-network/2022-10-29-18-11-55.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E8%B7%AF%E7%94%B1%E5%99%A8&#34;&gt;https://zh.wikipedia.org/wiki/%E8%B7%AF%E7%94%B1%E5%99%A8&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
  </channel>
</rss>
