<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Networks | æ´é¦™æ˜¥</title><meta name=keywords content><meta name=description content="Networks - æ´é¦™æ˜¥"><meta name=author content="Eddie Wang"><link rel=canonical href=https://wdd.js.org/network/><link crossorigin=anonymous href=/assets/css/stylesheet.a2acda249b8eac62938bb2d2f1c562c5f74d5728640d2a1a7d6aeaec5c50ef24.css integrity="sha256-oqzaJJuOrGKTi7LS8cVixfdNVyhkDSoafWrq7FxQ7yQ=" rel="preload stylesheet" as=style><link rel=icon href=https://wdd.js.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wdd.js.org/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://wdd.js.org/favicon.ico><link rel=apple-touch-icon href=https://wdd.js.org/favicon.ico><link rel=mask-icon href=https://wdd.js.org/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://wdd.js.org/network/index.xml title=rss><link rel=alternate hreflang=en href=https://wdd.js.org/network/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css><style>body{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,noto sans,sans-serif,apple color emoji,segoe ui emoji;font-size:16px;line-height:1.6;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1,h2,h3,h4,h5,h6{font-weight:600;letter-spacing:-.02em}code,pre{font-family:fira code,jetbrains mono,Consolas,monospace;font-variant-ligatures:normal;font-size:.95em}</style><meta property="og:url" content="https://wdd.js.org/network/"><meta property="og:site_name" content="æ´é¦™æ˜¥"><meta property="og:title" content="Networks"><meta property="og:description" content="Eddie Wangçš„ä¸ªäººåšå®¢"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Networks"><meta name=twitter:description content="Eddie Wangçš„ä¸ªäººåšå®¢"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Networks","item":"https://wdd.js.org/network/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wdd.js.org/ accesskey=h title="æ´é¦™æ˜¥ (Alt + H)"><img src=https://wdd.js.org/favicon.ico alt aria-label=logo height=35>æ´é¦™æ˜¥</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wdd.js.org/opensips/ title=OpenSIPS><span>OpenSIPS</span></a></li><li><a href=https://wdd.js.org/kamailio/ title=Kamailio><span>Kamailio</span></a></li><li><a href=https://wdd.js.org/freeswitch/ title=FreeSWITCH><span>FreeSWITCH</span></a></li><li><a href=https://wdd.js.org/books/ title=è¯»ä¹¦><span>è¯»ä¹¦</span></a></li><li><a href=https://wdd.js.org/vim/ title=VIM><span>VIM</span></a></li><li><a href=https://wdd.js.org/fe/ title=å‰ç«¯><span>å‰ç«¯</span></a></li><li><a href=https://wdd.js.org/search/ title=æœç´¢><span>æœç´¢</span></a></li><li><a href=https://wdd.js.org/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://wdd.js.org/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://wdd.js.org/about/ title=æˆ‘><span>æˆ‘</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://wdd.js.org/>Home</a></div><h1>Networks</h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RFC768 UDPåŒ…å­¦ä¹ ç¬”è®°</h2></header><div class=entry-content><p>åŒ…æ ¼å¼ UDPåŒ…å¤´å·¥å ç”¨8ä¸ªå­—èŠ‚, å…¶ä¸­æºç«¯å£å’Œç›®æ ‡ç«¯å£å„å 2ä¸ªå­—èŠ‚ï¼Œé•¿åº¦å 2ä¸ªå­—èŠ‚ï¼Œæ ¡éªŒå’Œå 2ä¸ªå­—èŠ‚ã€‚
0 7 8 15 16 23 24 31 +--------+--------+--------+--------+ | Source | Destination | | Port | Port | +--------+--------+--------+--------+ | | | | Length | Checksum | +--------+--------+--------+--------+ | | data octets ... +---------------- ... User Datagram Header Format å­—æ®µ æºç«¯å£ï¼Œå¯é€‰å­—æ®µï¼Œé»˜è®¤ä¸º0ï¼Œå¦‚æœæ˜¯æœ‰æ„ä¹‰çš„å…¶ä»–ç«¯å£ï¼Œè¡¨ç¤ºåç»­å“åº”å¯ä»¥é€å›åˆ°è¯¥ç«¯å£ ç›®æ ‡ç«¯å£ï¼Œå¿…é¡»å­—æ®µï¼Œç”¨æ¥å…³è”ç›®æ ‡ä¸»æœºä¸Šè¿›ç¨‹ç›‘å¬çš„ç«¯å£ é•¿åº¦ï¼Œé•¿åº¦æ˜¯æ•´ä¸ªUDPåŒ…çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯åŒ…å¤´ + åŒ…çš„æ•°æ®ï¼ŒåŒ…å¤´å›ºå®š8å­—èŠ‚ï¼Œé‚£ä¹ˆlengthçš„æœ€å°é•¿åº¦å°±æ˜¯8 æ ¡éªŒå’Œï¼Œç”¨æ¥éªŒè¯ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†é”™è¯¯ã€‚æ ¡éªŒå’Œçš„è®¡ç®—ç»“æœä¸æºIPã€ç›®æ ‡IPã€UDPçš„åŒ…é•¿æœ‰å…³ã€‚ å¦‚æœæ ¡éªŒå’Œå¤±è´¥ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒã€‚ æœ‰äº›æ ¡éªŒå’Œè®¡ç®—çš„å·¥ä½œä¼šè¢«æ”¾ç½®åœ¨ç½‘å¡ä¸Šï¼Œä»è€Œå‡å°‘CPUçš„è´Ÿè½½ã€‚å½“ç„¶å¦‚æœåœ¨ç½‘å¡ä¸Šå› ä¸ºæ ¡éªŒå’Œçš„é—®é¢˜è¢«ç½‘å¡ä¸¢å¼ƒï¼Œä¸Šå±‚åº”ç”¨æ˜¯æ”¶ä¸åˆ°ä¸åˆ°UDPåŒ…çš„ã€‚ä½†æ˜¯ç”¨tcpdumpå¯ä»¥æŠ“åˆ°è¿™ç§æ ¡éªŒå’Œæœ‰é—®é¢˜çš„åŒ…ã€‚ æ€è€ƒ1ï¼š ä¸ºä»€ä¹ˆæºç«¯å£å¯ä»¥è®¾ç½®ä¸º0ï¼Ÿ
ç­”ï¼šæœ‰äº›UDPåŒ…ï¼Œæ˜¯ä¸éœ€è¦å“åº”çš„ï¼Œåªéœ€è¦å‘é€å‡ºæ¶ˆæ¯ã€‚
å‚è€ƒ https://datatracker.ietf.org/doc/html/rfc768 https://wdd.js.org/opensips/ch7/big-udp-msg/ https://wdd.js.org/network/udp-checksum-offload/</p></div><footer class=entry-footer><span title='2025-01-01 20:23:41 +0800 CST'>2025-01-01 20:23:41</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to RFC768 UDPåŒ…å­¦ä¹ ç¬”è®°" href=https://wdd.js.org/network/rfc768-udp/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>WiresharkæŠ“åŒ…æ•™ç¨‹</h2></header><div class=entry-content><p>1. HTTPæŠ“åŒ…ä¾‹å­ æ¡ˆä¾‹ï¼šæœ¬åœ°å‘ http://192.168.40.134:31204/some-apiï¼Œå¦‚ä½•è¿‡æ»¤ï¼Ÿ
http and ip.addr == 192.168.40.134 and tcp.port == 31204 è¯­å¥åˆ†æï¼š
http è¡¨ç¤ºæˆ‘åªéœ€è¦httpçš„åŒ… ip.addr è¡¨ç¤ºåªè¦æºipæˆ–è€…ç›®æ ‡ipåœ°å€ä¸­åŒ…å«192.168.40.134 tcp.port è¡¨ç¤ºåªè¦æºç«¯å£æˆ–è€…ç›®æ ‡ç«¯å£ä¸­åŒ…å«31204 2. ä¸ºä»€ä¹ˆæˆ‘å†™çš„è¡¨è¾¾å¼æ€»æ˜¯ä¸å¯¹å‘¢ï¼ŸğŸ˜‚ å¾ˆå¤šæ—¶å€™ï¼Œä½ å†™çš„è¡¨è¾¾å¼èƒŒæ™¯è‰²å˜æˆçº¢è‰²ï¼Œè¯´æ˜è¡¨è¾¾å¼é”™è¯¯äº†ï¼Œä¾‹å¦‚ä¸‹å›¾ï¼šhttp and ip.port == 31204
å†™å‡ºip.portè¿™ä¸ªè¯­å¥ï¼Œå¾€å¾€æ˜¯å¯¹ä¼ è¾“åè®®ç†è§£ä¸æ¸…æ™°ã€‚ğŸ˜…
ipæ˜¯ç½‘ç»œå±‚çš„åè®®ï¼Œportæ˜¯ä¼ è¾“å±‚tcpæˆ–è€…udpä¸­ä½¿ç”¨çš„ã€‚ä¾‹å¦‚ä½ å†™tcp.port == 80ï¼Œudp.port ==3000è¿™æ ·æ˜¯æ²¡é—®é¢˜çš„ã€‚ä½†æ˜¯portä¸èƒ½è·Ÿåœ¨ipçš„åé¢ï¼Œå¦‚æœä½ ä¸æ¸…æ¥šæ€ä¹ˆå†™ï¼Œä½ å¯ä»¥é€‰æ‹©wiresharkçš„æ™ºèƒ½æç¤ºã€‚
æ™ºèƒ½æç¤ºä¼šæç¤ºæ‰€æœ‰å¯ç”¨çš„è¡¨è¾¾å¼ã€‚
3. å¸¸ç”¨è¿‡æ»¤è¡¨è¾¾å¼ ä¸€èˆ¬æˆ‘ä»¬çš„è¿‡æ»¤éƒ½æ˜¯åŸºäºåè®®ï¼Œipåœ°å€æˆ–è€…ç«¯å£å·è¿›è¡Œè¿‡æ»¤çš„ï¼Œ
3.1. åŸºäºåè®®çš„è¿‡æ»¤ ç›´æ¥è¾“å…¥åè®®åè¿›è¡Œè¿‡æ»¤
3.2. åŸºäºIPåœ°å€çš„è¿‡æ»¤ 3.3. åŸºäºç«¯å£çš„è¿‡æ»¤ åŸºäºç«¯å£çš„è¿‡æ»¤ä¸€èˆ¬å°±ä¸¤ç§
tcp.port == xxx udp.port == xxx 3.4. åŸºäºhostçš„è¿‡æ»¤ 4. æ¯”è¾ƒè¿ç®—ç¬¦æ”¯æŒ == ç­‰äº != ä¸ç­‰äº > å¤§äº &lt; å°äº >= å¤§äºç­‰äº &lt;= å°äºç­‰äº ip.addr == 192.168.2.4 5. é€»è¾‘è¿ç®—ç¬¦ and æ¡ä»¶ä¸ or æ¡ä»¶æˆ– xor ä»…èƒ½æœ‰ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸ not æ‰€æœ‰æ¡ä»¶éƒ½ä¸èƒ½ä¸ºçœŸ ip.addr == 192.168.2.4 and tcp.port == 2145 and !tcp.port == 3389 6. åªå…³å¿ƒæŸäº›ç‰¹æ®Šçš„tcpåŒ… tcp.flags.fin==1 åªè¿‡æ»¤å…³é—­è¿æ¥çš„åŒ… tcp.flags.syn==1 åªè¿‡æ»¤å»ºç«‹è¿æ¥çš„åŒ… tcp.flags.reset==1 åªè¿‡æ»¤å‡ºtcpè¿æ¥é‡ç½®çš„åŒ… 7. ç»Ÿè®¡æ¨¡å— 7.1. æŸ¥çœ‹æœ‰å“ªäº›IP Statistics -> endpoints
...</p></div><footer class=entry-footer><span title='2022-10-25 09:12:00 +0800 CST'>2022-10-25 09:12:00</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to WiresharkæŠ“åŒ…æ•™ç¨‹" href=https://wdd.js.org/network/wireshark/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>TcpdumpæŠ“åŒ…æ•™ç¨‹</h2></header><div class=entry-content><p>æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ ä»å¸®åŠ©æ–‡æ¡£å¯ä»¥çœ‹å‡ºï¼ŒåŒ…è¿‡æ»¤çš„è¡¨è¾¾å¼ä¸€å®šè¦æ”¾åœ¨æœ€åä¸€ä¸ªå‚æ•°
tcpdump [ -AbdDefhHIJKlLnNOpqStuUvxX# ] [ -B buffer_size ] [ -c count ] [ --count ] [ -C file_size ] [ -E spi@ipaddr algo:secret,... ] [ -F file ] [ -G rotate_seconds ] [ -i interface ] [ --immediate-mode ] [ -j tstamp_type ] [ -m module ] [ -M secret ] [ --number ] [ --print ] [ -Q in|out|inout ] [ -r file ] [ -s snaplen ] [ -T type ] [ --version ] [ -V file ] [ -w file ] [ -W filecount ] [ -y datalinktype ] [ -z postrotate-command ] [ -Z user ] [ --time-stamp-precision=tstamp_precision ] [ --micro ] [ --nano ] [ expression ] åˆ—å‡ºæ‰€æœ‰ç½‘å¡ tcpdump -D 1.enp89s0 [Up, Running, Connected] 2.docker0 [Up, Running, Connected] 3.vetha051ecc [Up, Running, Connected] 4.vethe67e03a [Up, Running, Connected] 5.vethc58c174 [Up, Running, Connected] æŒ‡å®šç½‘å¡ -i tcpdump -i eth0 æ‰€æœ‰ç½‘å¡ tcpdump -i any ä¸è¦åŸŸåè§£æ tcpdump -n -i any æŒ‡å®šä¸»æœº tcpdoump host 192.168.0.1 æŒ‡å®šæºIPæˆ–è€…ç›®æ ‡IP # æ ¹æ®æºIPè¿‡æ»¤ tcpdump src 192.168.3.2 # æ ¹æ®ç›®æ ‡IPè¿‡æ»¤ tcpdump dst 192.168.3.2 æŒ‡å®šåè®®è¿‡æ»¤ tcpdump tcp æŒ‡å®šç«¯å£ # æ ¹æ®æŸä¸ªç«¯å£è¿‡æ»¤ tcpdomp port 33 # æ ¹æ®æºç«¯å£æˆ–è€…ç›®æ ‡ç«¯å£è¿‡æ»¤ tcpdump dst port 33 tcpdump src port 33 # æ ¹æ®ç«¯å£èŒƒå›´è¿‡æ»¤ tcpdump portrange 30-90 æ ¹æ®IPå’Œåœ°å€ tcpdump -i ens33 tcp and host 192.168.40.30 æŠ“åŒ…ç»“æœå†™æ–‡ä»¶ tcpdump -i ens33 tcp and host 192.168.40.30 -w log.pcap æ¯éš”30ç§’å†™ä¸€ä¸ªæ–‡ä»¶ -G 30Â è¡¨ç¤ºæ¯éš”30ç§’å†™ä¸€ä¸ªæ–‡ä»¶ æ–‡ä»¶åä¸­çš„%å®é™…ä¸Šæ˜¯æ—¶é—´æ ¼å¼ tcpdump -i ens33 -G 30 tcp and host 192.168.40.30 -w %Y_%m%d_%H%M_%S.log.pcap æ¯è¾¾åˆ°30MBäº§ç”Ÿä¸€ä¸ªæ–‡ä»¶ -C 30Â æ¯è¾¾åˆ°30MBäº§ç”Ÿä¸€ä¸ªæ–‡ä»¶ tcpdump -i ens33 -C 30 tcp and host 192.168.40.30 -w log.pcap æŒ‡å®šæŠ“åŒ…çš„ä¸ªæ•° åœ¨æµé‡å¾ˆå¤§çš„ç½‘ç»œä¸ŠæŠ“åŒ…ï¼Œå¦‚æœå†™æ–‡ä»¶çš„è¯ï¼Œå¾ˆå¯èƒ½å°†ç£ç›˜å†™æ»¡ã€‚æ‰€ä»¥æœ€å¥½æŒ‡å®šä¸€ä¸ªæœ€å¤§çš„æŠ“åŒ…ä¸ªæ•°ï¼Œåœ¨è¾¾åˆ°åŒ…çš„ä¸ªæ•°åï¼Œè‡ªåŠ¨é€€å‡ºã€‚
...</p></div><footer class=entry-footer><span title='2022-10-25 09:09:05 +0800 CST'>2022-10-25 09:09:05</span>&nbsp;Â·&nbsp;<span>2 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to TcpdumpæŠ“åŒ…æ•™ç¨‹" href=https://wdd.js.org/network/tcpdump/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>httpæŠ“åŒ…å·¥å…·httpryä½¿ç”¨</h2></header><div class=entry-content><p>git clone https://gitee.com/nuannuande/httpry.git cd httpry yum install libpcap-devel -y make make install cp -f httpry /usr/sbin/ httpry -i eth0</p></div><footer class=entry-footer><span title='2022-10-25 09:07:04 +0800 CST'>2022-10-25 09:07:04</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to httpæŠ“åŒ…å·¥å…·httpryä½¿ç”¨" href=https://wdd.js.org/network/httpry/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Tsharkå…¥é—¨åˆ°ç²¾é€š</h2></header><div class=entry-content><p>1. ä½¿ç”¨æ‘˜è¦ ä¸€ä¸ªå‘½ä»¤çš„ä½¿ç”¨æ‘˜è¦éå¸¸é‡è¦ï¼Œæ‘˜è¦é‡ŒåŒ…å«äº†è¿™ä¸ªå·¥å…·æœ€å¸¸ç”¨çš„ç”¨æ³•ã€‚
è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦ç”¨è¿‡æ»¤å™¨ï¼Œä¸€å®šè¦æ”¾åˆ°æœ€åã€‚
tshark [ -i &lt;capture interface>|- ] [ -f &lt;capture filter> ] [ -2 ] [ -r &lt;infile> ] [ -w &lt;outfile>|- ] [ options ] [ &lt;filter> ] tshark -G [ &lt;report type> ] [ --elastic-mapping-filter &lt;protocols> ] 2. ä¸ºä»€ä¹ˆè¦å­¦ä¹ tshark? ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨æœåŠ¡ç«¯ç”¨tcpdumpæŠ“åŒ…ï¼Œç„¶åæŠŠåŒ…æ‹¿ä¸‹æ¥ï¼Œç”¨wiresharkåˆ†æã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å­¦ä¹ tsharkå‘¢ï¼Ÿ
ç›¸æ¯”äºwiresharkï¼Œ tsharkæœ‰ä»¥ä¸‹çš„ä¼˜ç‚¹
é€Ÿåº¦é£å¿«ï¼šwiresharkåœ¨åŠ è½½åŒ…çš„æ—¶å€™ï¼Œtsharkå¯èƒ½å·²ç»ç»™å‡ºäº†ç»“æœã€‚ æ›´ç¨³å®šï¼šwiresharkåœ¨å¤„ç†åŒ…çš„æ—¶å€™ï¼Œå¸¸å¸¸å®¹æ˜“å´©æºƒ æ›´é€‚åˆåšæ–‡æœ¬å¤„ç†ï¼štsharkçš„è¾“å‡ºæ˜¯æ–‡æœ¬ï¼Œè¿™ä¸ªæ–‡æœ¬å¾ˆå®¹æ˜“è¢«awk, sort, uniqç­‰ç­‰å‘½ä»¤å¤„ç† ä½†æ˜¯æˆ‘ä¸å»ºè®®ä¸Šæ¥å°±å­¦ä¹ ï¼Œæ›´å»ºè®®åœ¨ç†Ÿæ‚‰wiresharkä¹‹åï¼Œå†å»è¿›ä¸€æ­¥å­¦ä¹ tshark
3. ä½¿ç”¨åœºæ™¯ 3.1 åŸºæœ¬åœºæ™¯ ç”¨wiresharkæœ€åŸºæœ¬çš„åœºæ™¯çš„æŠŠpcapæ–‡ä»¶æ‹–åŠ¨åˆ°wiresharkä¸­ï¼Œç„¶åå¯èƒ½åŠ å…¥ä¸€äº›è¿‡æ»¤æ¡ä»¶ã€‚
tshark -r demo.pcap tshark -r demo.pcap -c 1 # åªè¯»ä¸€ä¸ªåŒ…å°±åœæ­¢ è¾“å‡ºçš„åˆ—åˆ†åˆ«ä¸ºï¼šåºå·ï¼Œç›¸å¯¹æ—¶é—´ï¼Œç»å¯¹æ—¶é—´ï¼Œæºip, æºç«¯å£ï¼Œç›®æ ‡ip, ç›®æ ‡ç«¯å£
3.2 æŒ‰ç…§è¡¨æ ¼è¾“å‡º tshark -r demo.pcap -T tabs 3.3 æŒ‰ç…§æŒ‡å®šçš„åˆ—è¾“å‡º ä¾‹å¦‚ï¼ŒæŠ“çš„çš„sipçš„åŒ…ï¼Œæˆ‘ä»¬åªæƒ³è¾“å‡ºsipçš„user-agentå­—æ®µã€‚
...</p></div><footer class=entry-footer><span title='2022-06-30 00:00:00 +0800 CST'>2022-06-30 00:00:00</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to Tsharkå…¥é—¨åˆ°ç²¾é€š" href=https://wdd.js.org/network/tshark/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Udp Checksum Offload</h2></header><div class=entry-content><p>åœ¨æœåŠ¡ç«¯æŠ“åŒ…ï¼Œç„¶ååœ¨wiresharkä¸Šåˆ†æï¼Œå‘ç°wiresharkæç¤ºï¼šudp checksumå­—æ®µæœ‰é—®é¢˜
checksum 0xâ€¦ incrorect should be 0x.. (maybe caused by udp checksum offload)
ä»¥å‰æˆ‘ä»æœªé‡åˆ°è¿‡udp checksumçš„é—®é¢˜ã€‚æ‰€ä»¥è¿™æ¬¡æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œæ‰€ä»¥éœ€è¦å­¦ä¹ ä¸€ä¸‹ã€‚ é¦–å…ˆudp checksumæ˜¯ä»€ä¹ˆï¼Ÿ
æˆ‘ä»¬çœ‹ä¸‹udpçš„åè®®ç»„æˆçš„å­—æ®µï¼Œå…¶ä¸­å°±æœ‰16ä½çš„æ ¡éªŒå’Œ
æ ¡éªŒå’Œä¸€èˆ¬éƒ½æ˜¯ä¸ºäº†æ£€éªŒæ•°æ®åŒ…åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦å‡ºç°å˜åŠ¨çš„ã€‚
å¦‚æœæ¥å—ç«¯æ”¶åˆ°çš„udpæ¶ˆæ¯æ ¡éªŒå’Œé”™è¯¯ï¼Œå°†ä¼šè¢«æ‚„æ‚„çš„ä¸¢å¼ƒ udpæ ¡éªŒå’Œæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æ ¡éªŒå’Œã€‚ç«¯åˆ°ç«¯æ„å‘³å®ƒä¸ä¼šåœ¨ä¸­é—´ç½‘ç»œè®¾å¤‡ä¸Šæ ¡éªŒã€‚ æ ¡éªŒå’Œç”±å‘é€æ–¹è´Ÿè´£è®¡ç®—ï¼Œæ¥æ”¶ç«¯è´Ÿè´£éªŒè¯ã€‚ç›®çš„æ˜¯ä¸ºäº†å‘ç°udpé¦–éƒ¨å’Œå’Œæ•°æ®åœ¨å‘é€ç«¯å’Œæ¥å—ç«¯ä¹‹é—´æ˜¯å¦å‘ç”Ÿäº†å˜åŠ¨ udpæ ¡éªŒå’Œæ˜¯å¯é€‰çš„åŠŸèƒ½ï¼Œä½†æ˜¯æ€»æ˜¯åº”è¯¥è¢«é»˜è®¤å¯ç”¨ã€‚ å¦‚æœå‘é€æ–¹è®¾ç½®äº†udpæ ¡éªŒå’Œï¼Œåˆ™æ¥å—æ–¹å¿…é¡»éªŒè¯ å‘é€æ–¹è´Ÿè´£è®¡ç®—ï¼Ÿå…·ä½“æ˜¯è°è´Ÿè´£è®¡ç®—
è®¡ç®—ä¸€èˆ¬éƒ½æ˜¯CPUçš„å·¥ä½œï¼Œä½†æ˜¯æœ‰äº›ç½‘å¡ä¹Ÿæ˜¯æ”¯æŒchecksum offloadçš„ã€‚
æ‰€è°“offload, æ˜¯æŒ‡æœ¬æ¥å¯ä»¥ç”±cpuè®¡ç®—çš„ï¼Œæ”¹å˜ç”±ç½‘å¡ç¡¬ä»¶è´Ÿè´£è®¡ç®—ã€‚ è¿™æ ·åšæœ‰å¾ˆå¤šå¥½å¤„ï¼Œ
å¯ä»¥é™ä½cpuçš„è´Ÿè½½ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ ç½‘å¡çš„ç¡¬ä»¶checksum, æ•ˆç‡æ›´é«˜ ä¸ºä»€ä¹ˆåªæœ‰å‘é€æ–¹å‡ºç°udp checksum é”™è¯¯ï¼Ÿ æˆ‘åœ¨æ¥å—æ–¹å’Œæ”¾æ¾æ–¹éƒ½è¿›è¡Œäº†æŠ“åŒ…ï¼Œä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç‰¹å¾æ˜¯ï¼Œåªæœ‰å‘é€æ–¹å‘ç°äº†udp checksumçš„é”™è¯¯ï¼Œåœ¨æ¥å—æ–¹ï¼ŒåŒæ ·çš„åŒ…ï¼Œudp checksumçš„å€¼å´æ˜¯æ­£ç¡®çš„ã€‚
ä¸€å¥è¯çš„è§£é‡Šï¼štcpdumpåœ¨æ¥æ”¶æ–¹æŠ“åˆ°çš„åŒ…ï¼Œæœ¬èº«checksumå­—æ®µè¿˜æ²¡æœ‰è¢«è®¡ç®—ï¼Œåœ¨åç»­çš„æ­¥éª¤ï¼Œè¿™ä¸ªåŒ…æ‰ä¼šè¢«äº¤ç»™NIC, NICæ¥è´Ÿè´£è®¡ç®—ã€‚
ç»“è®º maybe caused by udp checksum offload è¿™ä¸ªæŠ¥é”™å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚
å‚è€ƒ â— ã€Štcp/ip è¯¦è§£ã€‹ â— https://www.kernel.org/doc/html/latest/networking/checksum-offloads.html â— https://dominikrys.com/posts/disable-udp-checksum-validation/ â— https://sokratisg.net/2012/04/01/udp-tcp-checksum-errors-from-tcpdump-nic-hardware-offloading/</p></div><footer class=entry-footer><span title='2022-06-30 00:00:00 +0800 CST'>2022-06-30 00:00:00</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to Udp Checksum Offload" href=https://wdd.js.org/network/udp-checksum-offload/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Wireshark é™„å¸¦çš„19å‘½ä»¤è¡Œç¨‹åº</h2></header><div class=entry-content><p>å¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬éƒ½æ˜¯å›¾å½¢ç•Œé¢çš„æ–¹å¼ä½¿ç”¨wireshak, å…¶å®ä¸€èˆ¬åªè¦ä½ å®‰è£…äº†wiresharkï¼ŒåŒæ—¶ä¹Ÿé™„å¸¦å®‰è£…äº†ä¸€äº›å‘½ä»¤è¡Œå·¥å…·ã€‚ è¿™äº›å·¥å…·ä¹Ÿå¯ä»¥æå¤§çš„æé«˜ç”Ÿäº§æ•ˆç‡ã€‚ æœ¬æ–‡åªæ˜¯å¯¹å·¥å…·çš„åŠŸèƒ½ç®€ä»‹ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ -h, æŸ¥çœ‹å‘½ä»¤çš„å…·ä½“ä½¿ç”¨æ–‡æ¡£ã€‚
1. editcap ç¼–è¾‘æŠ“åŒ…æ–‡ä»¶ Editcap (Wireshark) 3.6.1 (v3.6.1-0-ga0a473c7c1ba) Edit and/or translate the format of capture files. ä¸¾ä¾‹: æŒ‰ç…§æ—¶é—´èŒƒå›´ä»input.pcapæ–‡ä»¶ä¸­æ‹¿å‡ºæŒ‡å®šæ—¶é—´èŒƒå›´çš„åŒ…
editcap -A '2014-12-10 10:11:01' -B '2014-12-10 10:21:01' input.pcap output.pcap 2. androiddump è¿™ä¸ªå‘½ä»¤ä¼¼ä¹å¯ä»¥ç”¨æ¥å¯¹å®‰å“ç³»ç»Ÿè¿›è¡ŒæŠ“åŒ…ï¼Œæ²¡ç©è¿‡å®‰å“ï¼Œä¸å†å¤šè¯´ã€‚
Wireshark - androiddump v1.1.0 Usage: androiddump --extcap-interfaces [--adb-server-ip=&lt;arg>] [--adb-server-tcp-port=&lt;arg>] androiddump --extcap-interface=INTERFACE --extcap-dlts androiddump --extcap-interface=INTERFACE --extcap-config androiddump --extcap-interface=INTERFACE --fifo=PATH_FILENAME --capture 3. ciscodump ä¼¼ä¹æ˜¯å¯¹æ€ç§‘çš„ç½‘ç»œè¿›è¡ŒæŠ“åŒ…çš„ï¼Œæ²¡ç”¨è¿‡ Wireshark - ciscodump v1.0.0 Usage: ciscodump â€“extcap-interfaces ciscodump â€“extcap-interface=ciscodump â€“extcap-dlts ciscodump â€“extcap-interface=ciscodump â€“extcap-config ciscodump â€“extcap-interface=ciscodump â€“remote-host myhost â€“remote-port 22222 â€“remote-username myuser â€“remote-interface gigabit0/0 â€“fifo=FILENAME â€“capture
...</p></div><footer class=entry-footer><span title='2022-06-30 00:00:00 +0800 CST'>2022-06-30 00:00:00</span>&nbsp;Â·&nbsp;<span>3 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to Wireshark é™„å¸¦çš„19å‘½ä»¤è¡Œç¨‹åº" href=https://wdd.js.org/network/wireshark-extra-cli/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Linuxå†…æ ¸å‚æ•°rp_filter</h2></header><div class=entry-content><p>é—®é¢˜ç°è±¡ ä¸»æœºä¸Šæœ‰ä¸¤ä¸ªç½‘å¡ens192å’Œens224ã€‚ens129ç½‘å¡æ˜¯å¯¹å†…ç½‘ç»œçš„ç½‘å¡ï¼Œens224æ˜¯å¯¹ç½‘ç½‘ç»œçš„ç½‘å¡ã€‚
SIPä¿¡ä»¤é˜¶æ®µéƒ½æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å‘ç°ï¼Œå¯¹äºæ¥è‡ªnode3çš„RTPæµï¼Œ å¹¶æ²¡æœ‰ä»ens192ç½‘å¡è½¬å‘ç»™node1ä¸Šã€‚
sequenceDiagram title network autonumber node1->>ens192: INVITE ens224->>node2: INVITE node2->>ens224: 200 ok ens192->>node1: 200 ok node1->>ens192: ACK ens224->>node2: ACK node1-->>ens192: RTP out ens224-->>node3: RTP out node3-->>ens224: RTP in æŠ“åŒ…ç¨‹åºæŠ“åˆ°äº†node3å‘é€åˆ°ens224ä¸Šçš„åŒ…ï¼Œä½†æ˜¯æ’æŸ¥åº”ç”¨æœåŠ¡å™¨çš„æ—¥å¿—å‘ç°ï¼Œä¼¼ä¹åº”ç”¨æœåŠ¡å™¨æ ¹æœ¬æ²¡æœ‰æ”¶åˆ°node3ä¸Šè¿‡æ¥çš„åŒ…, æ‰€ä»¥ä¹Ÿå°±æ— æ³•è½¬å‘ã€‚
å› è€Œæ€€ç–‘æ˜¯ä¸æ˜¯åœ¨å†…æ ¸ä¸Šè¢«æ‹¦æˆªäº†ã€‚ åæ¥é€šè¿‡å°†rp_filterè®¾ç½®ä¸º0, ç„¶åè¯­éŸ³æµçš„è½¬å‘å°±æ­£å¸¸äº†ã€‚
äº‹åå¤ç›˜ node3çš„è¿™ä¸ªIPç›´æ¥å¾€åº”ç”¨æœåŠ¡å™¨ä¸Šå‘åŒ…ï¼Œå¯èƒ½ä¼šè¢«æ‹¦æˆªã€‚å› ä¸ºåœ¨ä¿¡ä»¤å»ºç«‹çš„é˜¶æ®µï¼Œåº”ç”¨æœåŠ¡å™¨å¹¶æ²¡æœ‰ä¸»åŠ¨å‘
åœ¨kernelæ–‡æ¡£ä¸Š rp_filter - INTEGER 0 - No source validation. 1 - Strict mode as defined in RFC3704 Strict Reverse Path Each incoming packet is tested against the FIB and if the interface is not the best reverse path the packet check will fail. By default failed packets are discarded. 2 - Loose mode as defined in RFC3704 Loose Reverse Path Each incoming packet's source address is also tested against the FIB and if the source address is not reachable via any interface the packet check will fail. Current recommended practice in RFC3704 is to enable strict mode to prevent IP spoofing from DDos attacks. If using asymmetric routing or other complicated routing, then loose mode is recommended. The max value from conf/{all,interface}/rp_filter is used when doing source validation on the {interface}. Default value is 0. Note that some distributions enable it in startup scripts. å‚è€ƒ https://www.jianshu.com/p/717e6cd9d2bb https://www.jianshu.com/p/16d5c130670b https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt</p></div><footer class=entry-footer><span title='2022-06-13 00:00:00 +0800 CST'>2022-06-13 00:00:00</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to Linuxå†…æ ¸å‚æ•°rp_filter" href=https://wdd.js.org/network/rp_filter/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>websocket tcp keepalive æœºåˆ¶è°ƒç ”</h2></header><div class=entry-content><p>æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨ http://www.websocket-test.com/ï¼Œ è¯¥æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯æœªåŠ å¯†çš„wsåè®®ã€‚
æ‰“å¼€è¿™ä¸ªé¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªé¡µé¢å‘èµ·äº†è¿æ¥åˆ°ws://121.40.165.18:8800/ çš„websocketè¿æ¥ã€‚
ç„¶åçœ‹ä¸‹é‡Œé¢çš„æ¶ˆæ¯ï¼Œéƒ½æ˜¯æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ã€‚
é€šè¿‡wiresharkåˆ†æ
å•ç‹¬çš„websocketä¹Ÿæ˜¯èƒ½å¤Ÿçœ‹åˆ°æœåŠ¡ç«¯ä¸‹å‘çš„æ¶ˆæ¯çš„ã€‚
keepalive è¦ç‚¹å…³æ³¨ æ¯éš”å¤§çº¦45ç§’ï¼Œå®¢æˆ·ç«¯ä¼šåƒæœåŠ¡ç«¯å‘é€ä¸€ä¸ªkeep aliveåŒ…ã€‚æœåŠ¡ç«¯ä¹Ÿä¼šéå¸¸å¿«çš„å›å¤ä¸€ä¸ªå¿ƒè·³åŒ…</p></div><footer class=entry-footer><span title='2021-03-17 19:17:46 +0800 CST'>2021-03-17 19:17:46</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to websocket tcp keepalive æœºåˆ¶è°ƒç ”" href=https://wdd.js.org/network/pz06t2/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>tcpdump filters</h2></header><div class=entry-content><p>ethereal-tcpdump.pdf</p></div><footer class=entry-footer><span title='2020-12-04 13:32:16 +0800 CST'>2020-12-04 13:32:16</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>Eddie Wang</span></footer><a class=entry-link aria-label="post link to tcpdump filters" href=https://wdd.js.org/network/hhlfi1/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://wdd.js.org/network/page/2/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2026 <a href=https://wdd.js.org/>æ´é¦™æ˜¥</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>