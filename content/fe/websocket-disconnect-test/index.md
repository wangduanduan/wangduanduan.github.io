---
title: "WebSocket断开码测试"
date: "2022-10-29 11:34:02"
draft: false
---

WebSocket断开码，一般是用到的是从1000-1015。

正常的断开码是1000。其他的都是异常断开。

| 场景 | 服务端断开码 | 备注 |
| --- | --- | --- |
| 刷新浏览器页面 | 1001 | 终端离开, 可能因为服务端错误, 也可能因为浏览器正从打开连接的页面跳转离开. |
| 关闭浏览器tab页面 | 1001 | 终端离开, 可能因为服务端错误, 也可能因为浏览器正从打开连接的页面跳转离开. |
| 关闭浏览器, 所有标签页都会关闭。 | 1001 | 可以发现。无论是刷新，关闭tab页面还是关闭浏览器，错误码都是1001 |
| ws.close() | 1005 | 主动调用close, 不传递错误码。对服务端来说，也是异常断开。1005表示没有收到预期的状态码. |
| ws.close(1000) | 1000 | 正常的关闭，客户端必需传递正确的错误原因码。原因码不是随便填入的。比如 ws.close(1009)a**Failed to execute 'close' on 'WebSocket': The code must be either 1000, or between 3000 and 4999. 1009 is neither.** |
| 客户端断网 |  |  |


